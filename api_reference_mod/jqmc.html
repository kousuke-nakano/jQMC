
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>jqmc package &#8212; jQMC v0.1.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=a1637f0b"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api_reference_mod/jqmc';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to cite jQMC" href="../citation.html" />
    <link rel="prev" title="API reference for modules" href="modules.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">jQMC v0.1.0</p>
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/kousuke-nakano/jQMC" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notes/technical_notes.html">Technical notes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../notes/ao.html">Atomic orbitals (AOs) and Basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/wavefunction.html">Wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/vmc.html">Variational Monte Carlo (VMC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/lrdmc.html">Lattice Regularized Diffusion Monte Carlo (LRDMC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/jax.html">JAX compatible modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes/trexio.html">Interfaces with TREX-IO</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference_cli.html">API reference for the command-line interface (jqmc)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference_cli_tool.html">API reference for the command-line tool (jqmc-tool)</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="modules.html">API reference for modules</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">jqmc package</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">How to cite jQMC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/api_reference_mod/jqmc.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>jqmc package</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.atomic_orbital">jqmc.atomic_orbital module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.angular_momentums"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.angular_momentums</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.coefficients"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.coefficients</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.exponents"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.exponents</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.nucleus_index"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.nucleus_index</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.num_ao"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.num_ao</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.num_ao_prim"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.num_ao_prim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.orbital_indices"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.orbital_indices</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_x"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.polynominal_order_x</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_y"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.polynominal_order_y</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_z"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.polynominal_order_z</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.replace"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.structure_data"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.structure_data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.angular_momentums"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.angular_momentums</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.coefficients"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.coefficients</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.exponents"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.exponents</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.magnetic_quantum_numbers"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.magnetic_quantum_numbers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.nucleus_index"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.nucleus_index</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.num_ao"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.num_ao</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.num_ao_prim"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.num_ao_prim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.orbital_indices"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.orbital_indices</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.replace"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.structure_data"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.structure_data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.compute_AOs"><code class="docutils literal notranslate"><span class="pre">compute_AOs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.compute_AOs_grad"><code class="docutils literal notranslate"><span class="pre">compute_AOs_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.compute_AOs_laplacian"><code class="docutils literal notranslate"><span class="pre">compute_AOs_laplacian()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.coulomb_potential">jqmc.coulomb_potential module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.ang_moms"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.ang_moms</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.coefficients"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.coefficients</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.ecp_flag"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.ecp_flag</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.exponents"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.exponents</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.max_ang_mom_plus_1"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.max_ang_mom_plus_1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.nucleus_index"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.nucleus_index</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.num_ecps"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.num_ecps</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.powers"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.powers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.replace"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.structure_data"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.structure_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.z_cores"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.z_cores</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_el"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential_el_el()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_ion"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential_el_ion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_ion_element_wise"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential_el_ion_element_wise()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_ion_ion"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential_ion_ion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_coulomb_potential"><code class="docutils literal notranslate"><span class="pre">compute_coulomb_potential()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_discretized_bare_coulomb_potential_el_ion_element_wise"><code class="docutils literal notranslate"><span class="pre">compute_discretized_bare_coulomb_potential_el_ion_element_wise()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_coulomb_potential"><code class="docutils literal notranslate"><span class="pre">compute_ecp_coulomb_potential()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_local_parts_all_pairs"><code class="docutils literal notranslate"><span class="pre">compute_ecp_local_parts_all_pairs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_non_local_part_all_pairs_jax_weights_grid_points"><code class="docutils literal notranslate"><span class="pre">compute_ecp_non_local_part_all_pairs_jax_weights_grid_points()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_all_pairs"><code class="docutils literal notranslate"><span class="pre">compute_ecp_non_local_parts_all_pairs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_nearest_neighbors"><code class="docutils literal notranslate"><span class="pre">compute_ecp_non_local_parts_nearest_neighbors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_nearest_neighbors_fast_update"><code class="docutils literal notranslate"><span class="pre">compute_ecp_non_local_parts_nearest_neighbors_fast_update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.determinant">jqmc.determinant module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data"><code class="docutils literal notranslate"><span class="pre">Geminal_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.accumulate_position_grad"><code class="docutils literal notranslate"><span class="pre">Geminal_data.accumulate_position_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.apply_block_update"><code class="docutils literal notranslate"><span class="pre">Geminal_data.apply_block_update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.collect_param_grads"><code class="docutils literal notranslate"><span class="pre">Geminal_data.collect_param_grads()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.compute_orb_api"><code class="docutils literal notranslate"><span class="pre">Geminal_data.compute_orb_api</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.compute_orb_grad_api"><code class="docutils literal notranslate"><span class="pre">Geminal_data.compute_orb_grad_api</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.compute_orb_laplacian_api"><code class="docutils literal notranslate"><span class="pre">Geminal_data.compute_orb_laplacian_api</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.convert_from_MOs_to_AOs"><code class="docutils literal notranslate"><span class="pre">Geminal_data.convert_from_MOs_to_AOs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.lambda_matrix"><code class="docutils literal notranslate"><span class="pre">Geminal_data.lambda_matrix</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.num_electron_dn"><code class="docutils literal notranslate"><span class="pre">Geminal_data.num_electron_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.num_electron_up"><code class="docutils literal notranslate"><span class="pre">Geminal_data.num_electron_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.orb_data_dn_spin"><code class="docutils literal notranslate"><span class="pre">Geminal_data.orb_data_dn_spin</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.orb_data_up_spin"><code class="docutils literal notranslate"><span class="pre">Geminal_data.orb_data_up_spin</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.orb_num_dn"><code class="docutils literal notranslate"><span class="pre">Geminal_data.orb_num_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.orb_num_up"><code class="docutils literal notranslate"><span class="pre">Geminal_data.orb_num_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.replace"><code class="docutils literal notranslate"><span class="pre">Geminal_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Geminal_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.to_cartesian"><code class="docutils literal notranslate"><span class="pre">Geminal_data.to_cartesian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.to_spherical"><code class="docutils literal notranslate"><span class="pre">Geminal_data.to_spherical()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_AS_regularization_factor"><code class="docutils literal notranslate"><span class="pre">compute_AS_regularization_factor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_AS_regularization_factor_fast_update"><code class="docutils literal notranslate"><span class="pre">compute_AS_regularization_factor_fast_update()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_det_geminal_all_elements"><code class="docutils literal notranslate"><span class="pre">compute_det_geminal_all_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_geminal_all_elements"><code class="docutils literal notranslate"><span class="pre">compute_geminal_all_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_geminal_dn_one_column_elements"><code class="docutils literal notranslate"><span class="pre">compute_geminal_dn_one_column_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_geminal_up_one_row_elements"><code class="docutils literal notranslate"><span class="pre">compute_geminal_up_one_row_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_grads_and_laplacian_ln_Det"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_ln_Det()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_grads_and_laplacian_ln_Det_fast"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_ln_Det_fast()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.diff_mask">jqmc.diff_mask module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.DiffMask"><code class="docutils literal notranslate"><span class="pre">DiffMask</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.DiffMask.coords"><code class="docutils literal notranslate"><span class="pre">DiffMask.coords</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.DiffMask.params"><code class="docutils literal notranslate"><span class="pre">DiffMask.params</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.DiffMask.update"><code class="docutils literal notranslate"><span class="pre">DiffMask.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.apply_diff_mask"><code class="docutils literal notranslate"><span class="pre">apply_diff_mask()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.function_collections">jqmc.function_collections module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.hamiltonians">jqmc.hamiltonians module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.accumulate_position_grad"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.accumulate_position_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.coulomb_potential_data"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.coulomb_potential_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.load_from_hdf5"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.load_from_hdf5()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.replace"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.save_to_hdf5"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.save_to_hdf5()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.structure_data"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.structure_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.wavefunction_data"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.wavefunction_data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.compute_local_energy"><code class="docutils literal notranslate"><span class="pre">compute_local_energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.header_footer">jqmc.header_footer module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jastrow_factor">jqmc.jastrow_factor module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.cutoff"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.cutoff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.flat_shape"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.flat_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.flatten_fn"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.flatten_fn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.hidden_dim"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.hidden_dim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.init_from_structure"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.init_from_structure()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.nn_def"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.nn_def</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_layers"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.num_layers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_params"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.num_params</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_rbf"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.num_rbf</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_species"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.num_species</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.params"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.params</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.shapes"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.species_lookup"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.species_lookup</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.species_values"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.species_values</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.structure_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.structure_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.treedef"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.treedef</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.unflatten_fn"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.unflatten_fn</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.accumulate_position_grad"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.accumulate_position_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.apply_block_update"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.apply_block_update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.collect_param_grads"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.collect_param_grads()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_nn_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.jastrow_nn_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_one_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.jastrow_one_body_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_three_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.jastrow_three_body_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_two_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.jastrow_two_body_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.to_cartesian"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.to_cartesian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.to_spherical"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.to_spherical()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.core_electrons"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.core_electrons</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.init_jastrow_one_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.init_jastrow_one_body_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.jastrow_1b_param"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.jastrow_1b_param</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.structure_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.structure_data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.compute_orb_api"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.compute_orb_api</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.init_jastrow_three_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.init_jastrow_three_body_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.j_matrix"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.j_matrix</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.orb_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.orb_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.orb_num"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.orb_num</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.to_cartesian"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.to_cartesian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.to_spherical"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.to_spherical()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data.init_jastrow_two_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data.init_jastrow_two_body_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data.jastrow_2b_param"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data.jastrow_2b_param</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data.sanity_check()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow"><code class="docutils literal notranslate"><span class="pre">NNJastrow</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.hidden_dim"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.hidden_dim</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.name"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.name</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.parent"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.parent</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.scope"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.scope</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.setup"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.setup()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.cutoff"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.cutoff</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.name"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.name</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.num_rbf"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.num_rbf</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.parent"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.parent</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.scope"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.scope</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.name"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.name</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.out_dim"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.out_dim</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.parent"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.parent</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.scope"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.scope</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.width"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.width</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.cutoff"><code class="docutils literal notranslate"><span class="pre">NNJastrow.cutoff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.hidden_dim"><code class="docutils literal notranslate"><span class="pre">NNJastrow.hidden_dim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.name"><code class="docutils literal notranslate"><span class="pre">NNJastrow.name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.num_layers"><code class="docutils literal notranslate"><span class="pre">NNJastrow.num_layers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.num_rbf"><code class="docutils literal notranslate"><span class="pre">NNJastrow.num_rbf</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.num_species"><code class="docutils literal notranslate"><span class="pre">NNJastrow.num_species</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.parent"><code class="docutils literal notranslate"><span class="pre">NNJastrow.parent</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.scope"><code class="docutils literal notranslate"><span class="pre">NNJastrow.scope</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.setup"><code class="docutils literal notranslate"><span class="pre">NNJastrow.setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.species_lookup"><code class="docutils literal notranslate"><span class="pre">NNJastrow.species_lookup</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_Jastrow_one_body"><code class="docutils literal notranslate"><span class="pre">compute_Jastrow_one_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_Jastrow_part"><code class="docutils literal notranslate"><span class="pre">compute_Jastrow_part()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_Jastrow_three_body"><code class="docutils literal notranslate"><span class="pre">compute_Jastrow_three_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_Jastrow_two_body"><code class="docutils literal notranslate"><span class="pre">compute_Jastrow_two_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_one_body"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_Jastrow_one_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_part"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_Jastrow_part()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_three_body"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_Jastrow_three_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_two_body"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_Jastrow_two_body()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_cli">jqmc.jqmc_cli module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_gfmc">jqmc.jqmc_gfmc module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n"><code class="docutils literal notranslate"><span class="pre">GFMC_n</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.alat"><code class="docutils literal notranslate"><span class="pre">GFMC_n.alat</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.bare_w_L"><code class="docutils literal notranslate"><span class="pre">GFMC_n.bare_w_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.comput_position_deriv"><code class="docutils literal notranslate"><span class="pre">GFMC_n.comput_position_deriv</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dR"><code class="docutils literal notranslate"><span class="pre">GFMC_n.de_L_dR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dr_dn"><code class="docutils literal notranslate"><span class="pre">GFMC_n.de_L_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dr_up"><code class="docutils literal notranslate"><span class="pre">GFMC_n.de_L_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dR"><code class="docutils literal notranslate"><span class="pre">GFMC_n.dln_Psi_dR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dr_dn"><code class="docutils literal notranslate"><span class="pre">GFMC_n.dln_Psi_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dr_up"><code class="docutils literal notranslate"><span class="pre">GFMC_n.dln_Psi_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.domega_dr_dn"><code class="docutils literal notranslate"><span class="pre">GFMC_n.domega_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.domega_dr_up"><code class="docutils literal notranslate"><span class="pre">GFMC_n.domega_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.e_L"><code class="docutils literal notranslate"><span class="pre">GFMC_n.e_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.e_L2"><code class="docutils literal notranslate"><span class="pre">GFMC_n.e_L2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.get_E"><code class="docutils literal notranslate"><span class="pre">GFMC_n.get_E()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.get_aF"><code class="docutils literal notranslate"><span class="pre">GFMC_n.get_aF()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.hamiltonian_data"><code class="docutils literal notranslate"><span class="pre">GFMC_n.hamiltonian_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.mcmc_counter"><code class="docutils literal notranslate"><span class="pre">GFMC_n.mcmc_counter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.num_gfmc_collect_steps"><code class="docutils literal notranslate"><span class="pre">GFMC_n.num_gfmc_collect_steps</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.num_walkers"><code class="docutils literal notranslate"><span class="pre">GFMC_n.num_walkers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.omega_dn"><code class="docutils literal notranslate"><span class="pre">GFMC_n.omega_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.omega_up"><code class="docutils literal notranslate"><span class="pre">GFMC_n.omega_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.run"><code class="docutils literal notranslate"><span class="pre">GFMC_n.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.w_L"><code class="docutils literal notranslate"><span class="pre">GFMC_n.w_L</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t"><code class="docutils literal notranslate"><span class="pre">GFMC_t</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.alat"><code class="docutils literal notranslate"><span class="pre">GFMC_t.alat</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.bare_w_L"><code class="docutils literal notranslate"><span class="pre">GFMC_t.bare_w_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.e_L"><code class="docutils literal notranslate"><span class="pre">GFMC_t.e_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.e_L2"><code class="docutils literal notranslate"><span class="pre">GFMC_t.e_L2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.get_E"><code class="docutils literal notranslate"><span class="pre">GFMC_t.get_E()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.hamiltonian_data"><code class="docutils literal notranslate"><span class="pre">GFMC_t.hamiltonian_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.mcmc_counter"><code class="docutils literal notranslate"><span class="pre">GFMC_t.mcmc_counter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.num_gfmc_collect_steps"><code class="docutils literal notranslate"><span class="pre">GFMC_t.num_gfmc_collect_steps</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.num_walkers"><code class="docutils literal notranslate"><span class="pre">GFMC_t.num_walkers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.run"><code class="docutils literal notranslate"><span class="pre">GFMC_t.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.w_L"><code class="docutils literal notranslate"><span class="pre">GFMC_t.w_L</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_mcmc">jqmc.jqmc_mcmc module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC"><code class="docutils literal notranslate"><span class="pre">MCMC</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.comput_param_deriv"><code class="docutils literal notranslate"><span class="pre">MCMC.comput_param_deriv</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.comput_position_deriv"><code class="docutils literal notranslate"><span class="pre">MCMC.comput_position_deriv</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.de_L_dR"><code class="docutils literal notranslate"><span class="pre">MCMC.de_L_dR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.de_L_dr_dn"><code class="docutils literal notranslate"><span class="pre">MCMC.de_L_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.de_L_dr_up"><code class="docutils literal notranslate"><span class="pre">MCMC.de_L_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dR"><code class="docutils literal notranslate"><span class="pre">MCMC.dln_Psi_dR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dc"><code class="docutils literal notranslate"><span class="pre">MCMC.dln_Psi_dc</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dr_dn"><code class="docutils literal notranslate"><span class="pre">MCMC.dln_Psi_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dr_up"><code class="docutils literal notranslate"><span class="pre">MCMC.dln_Psi_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.domega_dr_dn"><code class="docutils literal notranslate"><span class="pre">MCMC.domega_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.domega_dr_up"><code class="docutils literal notranslate"><span class="pre">MCMC.domega_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.e_L"><code class="docutils literal notranslate"><span class="pre">MCMC.e_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.e_L2"><code class="docutils literal notranslate"><span class="pre">MCMC.e_L2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.get_E"><code class="docutils literal notranslate"><span class="pre">MCMC.get_E()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.get_aF"><code class="docutils literal notranslate"><span class="pre">MCMC.get_aF()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.get_dln_WF"><code class="docutils literal notranslate"><span class="pre">MCMC.get_dln_WF()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.get_gF"><code class="docutils literal notranslate"><span class="pre">MCMC.get_gF()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.hamiltonian_data"><code class="docutils literal notranslate"><span class="pre">MCMC.hamiltonian_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.mcmc_counter"><code class="docutils literal notranslate"><span class="pre">MCMC.mcmc_counter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.num_walkers"><code class="docutils literal notranslate"><span class="pre">MCMC.num_walkers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.omega_dn"><code class="docutils literal notranslate"><span class="pre">MCMC.omega_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.omega_up"><code class="docutils literal notranslate"><span class="pre">MCMC.omega_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.run"><code class="docutils literal notranslate"><span class="pre">MCMC.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.run_optimize"><code class="docutils literal notranslate"><span class="pre">MCMC.run_optimize()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.w_L"><code class="docutils literal notranslate"><span class="pre">MCMC.w_L</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_miscs">jqmc.jqmc_miscs module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_tool">jqmc.jqmc_tool module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.ansatz_type"><code class="docutils literal notranslate"><span class="pre">ansatz_type</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.ansatz_type.jagp"><code class="docutils literal notranslate"><span class="pre">ansatz_type.jagp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.ansatz_type.jsd"><code class="docutils literal notranslate"><span class="pre">ansatz_type.jsd</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.hamiltonian_convert_wavefunction"><code class="docutils literal notranslate"><span class="pre">hamiltonian_convert_wavefunction()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.hamiltonian_show_info"><code class="docutils literal notranslate"><span class="pre">hamiltonian_show_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.hamiltonian_to_xyz"><code class="docutils literal notranslate"><span class="pre">hamiltonian_to_xyz()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.lrdmc_compute_energy"><code class="docutils literal notranslate"><span class="pre">lrdmc_compute_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.lrdmc_extrapolate_energy"><code class="docutils literal notranslate"><span class="pre">lrdmc_extrapolate_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.lrdmc_generate_input"><code class="docutils literal notranslate"><span class="pre">lrdmc_generate_input()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.mcmc_compute_energy"><code class="docutils literal notranslate"><span class="pre">mcmc_compute_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.mcmc_generate_input"><code class="docutils literal notranslate"><span class="pre">mcmc_generate_input()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type"><code class="docutils literal notranslate"><span class="pre">orbital_type</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao_full"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao_full</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao_large"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao_large</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao_medium"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao_medium</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao_small"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao_small</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.mo"><code class="docutils literal notranslate"><span class="pre">orbital_type.mo</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.none"><code class="docutils literal notranslate"><span class="pre">orbital_type.none</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.trexio_convert_to"><code class="docutils literal notranslate"><span class="pre">trexio_convert_to()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.trexio_show_detail"><code class="docutils literal notranslate"><span class="pre">trexio_show_detail()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.trexio_show_info"><code class="docutils literal notranslate"><span class="pre">trexio_show_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.vmc_analyze_output"><code class="docutils literal notranslate"><span class="pre">vmc_analyze_output()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.vmc_chk_fix"><code class="docutils literal notranslate"><span class="pre">vmc_chk_fix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.vmc_generate_input"><code class="docutils literal notranslate"><span class="pre">vmc_generate_input()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_utility">jqmc.jqmc_utility module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.molecular_orbital">jqmc.molecular_orbital module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data"><code class="docutils literal notranslate"><span class="pre">MOs_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.aos_data"><code class="docutils literal notranslate"><span class="pre">MOs_data.aos_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.mo_coefficients"><code class="docutils literal notranslate"><span class="pre">MOs_data.mo_coefficients</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.num_mo"><code class="docutils literal notranslate"><span class="pre">MOs_data.num_mo</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.replace"><code class="docutils literal notranslate"><span class="pre">MOs_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">MOs_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.structure_data"><code class="docutils literal notranslate"><span class="pre">MOs_data.structure_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.to_cartesian"><code class="docutils literal notranslate"><span class="pre">MOs_data.to_cartesian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.to_spherical"><code class="docutils literal notranslate"><span class="pre">MOs_data.to_spherical()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.compute_MOs"><code class="docutils literal notranslate"><span class="pre">compute_MOs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.compute_MOs_grad"><code class="docutils literal notranslate"><span class="pre">compute_MOs_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.compute_MOs_laplacian"><code class="docutils literal notranslate"><span class="pre">compute_MOs_laplacian()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.setting">jqmc.setting module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.structure">jqmc.structure module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data"><code class="docutils literal notranslate"><span class="pre">Structure_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.atomic_labels"><code class="docutils literal notranslate"><span class="pre">Structure_data.atomic_labels</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.atomic_numbers"><code class="docutils literal notranslate"><span class="pre">Structure_data.atomic_numbers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.cell"><code class="docutils literal notranslate"><span class="pre">Structure_data.cell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.element_symbols"><code class="docutils literal notranslate"><span class="pre">Structure_data.element_symbols</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.lattice_vec_a"><code class="docutils literal notranslate"><span class="pre">Structure_data.lattice_vec_a</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.lattice_vec_b"><code class="docutils literal notranslate"><span class="pre">Structure_data.lattice_vec_b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.lattice_vec_c"><code class="docutils literal notranslate"><span class="pre">Structure_data.lattice_vec_c</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.natom"><code class="docutils literal notranslate"><span class="pre">Structure_data.natom</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.norm_vec_a"><code class="docutils literal notranslate"><span class="pre">Structure_data.norm_vec_a</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.norm_vec_b"><code class="docutils literal notranslate"><span class="pre">Structure_data.norm_vec_b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.norm_vec_c"><code class="docutils literal notranslate"><span class="pre">Structure_data.norm_vec_c</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.ntyp"><code class="docutils literal notranslate"><span class="pre">Structure_data.ntyp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.pbc_flag"><code class="docutils literal notranslate"><span class="pre">Structure_data.pbc_flag</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.positions"><code class="docutils literal notranslate"><span class="pre">Structure_data.positions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.recip_cell"><code class="docutils literal notranslate"><span class="pre">Structure_data.recip_cell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.recip_vec_a"><code class="docutils literal notranslate"><span class="pre">Structure_data.recip_vec_a</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.recip_vec_b"><code class="docutils literal notranslate"><span class="pre">Structure_data.recip_vec_b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.recip_vec_c"><code class="docutils literal notranslate"><span class="pre">Structure_data.recip_vec_c</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.replace"><code class="docutils literal notranslate"><span class="pre">Structure_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Structure_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.vec_a"><code class="docutils literal notranslate"><span class="pre">Structure_data.vec_a</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.vec_b"><code class="docutils literal notranslate"><span class="pre">Structure_data.vec_b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.vec_c"><code class="docutils literal notranslate"><span class="pre">Structure_data.vec_c</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.swct">jqmc.swct module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.SWCT_data"><code class="docutils literal notranslate"><span class="pre">SWCT_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.SWCT_data.replace"><code class="docutils literal notranslate"><span class="pre">SWCT_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.SWCT_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">SWCT_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.SWCT_data.structure"><code class="docutils literal notranslate"><span class="pre">SWCT_data.structure</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.evaluate_swct_domega"><code class="docutils literal notranslate"><span class="pre">evaluate_swct_domega()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.evaluate_swct_omega"><code class="docutils literal notranslate"><span class="pre">evaluate_swct_omega()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.trexio_wrapper">jqmc.trexio_wrapper module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.trexio_wrapper.read_trexio_file"><code class="docutils literal notranslate"><span class="pre">read_trexio_file()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.wavefunction">jqmc.wavefunction module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.apply_update"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.apply_update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.name"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.replace"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.shape"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.size"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.values"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.values</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.accumulate_position_grad"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.accumulate_position_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.apply_block_updates"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.apply_block_updates()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.collect_param_grads"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.collect_param_grads()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.flatten_param_grads"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.flatten_param_grads()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.geminal_data"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.geminal_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.get_variational_blocks"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.get_variational_blocks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.jastrow_data"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.jastrow_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.replace"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.with_diff_mask"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.with_diff_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.with_param_grad_mask"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.with_param_grad_mask()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_discretized_kinetic_energy"><code class="docutils literal notranslate"><span class="pre">compute_discretized_kinetic_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_discretized_kinetic_energy_fast_update"><code class="docutils literal notranslate"><span class="pre">compute_discretized_kinetic_energy_fast_update()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_kinetic_energy"><code class="docutils literal notranslate"><span class="pre">compute_kinetic_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_kinetic_energy_all_elements"><code class="docutils literal notranslate"><span class="pre">compute_kinetic_energy_all_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_kinetic_energy_all_elements_fast_update"><code class="docutils literal notranslate"><span class="pre">compute_kinetic_energy_all_elements_fast_update()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_quantum_force"><code class="docutils literal notranslate"><span class="pre">compute_quantum_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.evaluate_determinant"><code class="docutils literal notranslate"><span class="pre">evaluate_determinant()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.evaluate_jastrow"><code class="docutils literal notranslate"><span class="pre">evaluate_jastrow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.evaluate_ln_wavefunction"><code class="docutils literal notranslate"><span class="pre">evaluate_ln_wavefunction()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.evaluate_wavefunction"><code class="docutils literal notranslate"><span class="pre">evaluate_wavefunction()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc">Module contents</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="jqmc-package">
<h1>jqmc package<a class="headerlink" href="#jqmc-package" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-jqmc.atomic_orbital">
<span id="jqmc-atomic-orbital-module"></span><h2>jqmc.atomic_orbital module<a class="headerlink" href="#module-jqmc.atomic_orbital" title="Link to this heading">#</a></h2>
<p>Atomic Orbitals module.</p>
<p>Module containing classes and methods related to Atomic Orbitals</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.atomic_orbital.</span></span><span class="sig-name descname"><span class="pre">AOs_cart_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nucleus_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ao_prim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angular_momentums</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polynominal_order_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polynominal_order_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polynominal_order_z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Atomic orbital definitions in Cartesian form.</p>
<p>Stores contracted Gaussian basis data used to evaluate atomic orbitals (AOs) on a grid.
The angular part is represented by Cartesian polynomials (<span class="math notranslate nohighlight">\(x^{n_x} y^{n_y} z^{n_z}\)</span>) with
<span class="math notranslate nohighlight">\(n_x + n_y + n_z = l\)</span> for each AO.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Structure_data</span></code>)  Molecular structure and atomic positions used to place AOs.</p></li>
<li><p><strong>nucleus_index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  AO -&gt; atom index mapping (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p></li>
<li><p><strong>num_ao</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of contracted AOs.</p></li>
<li><p><strong>num_ao_prim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of primitive Gaussians.</p></li>
<li><p><strong>orbital_indices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  For each primitive, the parent AO index (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p></li>
<li><p><strong>exponents</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Gaussian exponents for primitives (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p></li>
<li><p><strong>coefficients</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Contraction coefficients per primitive (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p></li>
<li><p><strong>angular_momentums</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Angular momentum quantum numbers <code class="docutils literal notranslate"><span class="pre">l</span></code> per AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p></li>
<li><p><strong>polynominal_order_x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Cartesian power <code class="docutils literal notranslate"><span class="pre">n_x</span></code> for each AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p></li>
<li><p><strong>polynominal_order_y</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Cartesian power <code class="docutils literal notranslate"><span class="pre">n_y</span></code> for each AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p></li>
<li><p><strong>polynominal_order_z</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Cartesian power <code class="docutils literal notranslate"><span class="pre">n_z</span></code> for each AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>structure_data</strong> (<a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><em>Structure_data</em></a>)</p></li>
<li><p><strong>nucleus_index</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>num_ao</strong> (<em>int</em>)</p></li>
<li><p><strong>num_ao_prim</strong> (<em>int</em>)</p></li>
<li><p><strong>orbital_indices</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>exponents</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>float</em><em>]</em>)</p></li>
<li><p><strong>coefficients</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>float</em><em>]</em>)</p></li>
<li><p><strong>angular_momentums</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>polynominal_order_x</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>polynominal_order_y</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>polynominal_order_z</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Minimal hydrogen dimer (bohr) with all-electron cc-pVTZ (Gaussian format) in Cartesian form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Structure_data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.atomic_orbital</span><span class="w"> </span><span class="kn">import</span> <span class="n">AOs_cart_data</span>

<span class="n">structure</span> <span class="o">=</span> <span class="n">Structure_data</span><span class="p">(</span>
    <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.70</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">]],</span>
    <span class="n">pbc_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">atomic_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">element_symbols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">],</span>
    <span class="n">atomic_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H1&quot;</span><span class="p">,</span> <span class="s2">&quot;H2&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># cc-pVTZ primitives duplicated per Cartesian component; counts:</span>
<span class="c1"># per atom -&gt; 15 AOs, 19 primitives; for two atoms</span>
<span class="n">num_ao</span><span class="o">=</span><span class="mi">30</span><span class="p">;</span> <span class="n">num_ao_prim</span><span class="o">=</span><span class="mi">38</span>

<span class="n">exponents</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.3258</span><span class="p">,</span>
    <span class="mf">33.87</span><span class="p">,</span> <span class="mf">5.095</span><span class="p">,</span> <span class="mf">1.159</span><span class="p">,</span> <span class="mf">0.3258</span><span class="p">,</span> <span class="mf">0.1027</span><span class="p">,</span>
    <span class="mf">0.1027</span><span class="p">,</span>
    <span class="mf">1.407</span><span class="p">,</span> <span class="mf">1.407</span><span class="p">,</span> <span class="mf">1.407</span><span class="p">,</span>
    <span class="mf">0.388</span><span class="p">,</span> <span class="mf">0.388</span><span class="p">,</span> <span class="mf">0.388</span><span class="p">,</span>
    <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span>
    <span class="mf">0.3258</span><span class="p">,</span>
    <span class="mf">33.87</span><span class="p">,</span> <span class="mf">5.095</span><span class="p">,</span> <span class="mf">1.159</span><span class="p">,</span> <span class="mf">0.3258</span><span class="p">,</span> <span class="mf">0.1027</span><span class="p">,</span>
    <span class="mf">0.1027</span><span class="p">,</span>
    <span class="mf">1.407</span><span class="p">,</span> <span class="mf">1.407</span><span class="p">,</span> <span class="mf">1.407</span><span class="p">,</span>
    <span class="mf">0.388</span><span class="p">,</span> <span class="mf">0.388</span><span class="p">,</span> <span class="mf">0.388</span><span class="p">,</span>
    <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">0.006068</span><span class="p">,</span> <span class="mf">0.045308</span><span class="p">,</span> <span class="mf">0.202822</span><span class="p">,</span> <span class="mf">0.503903</span><span class="p">,</span> <span class="mf">0.383421</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">0.006068</span><span class="p">,</span> <span class="mf">0.045308</span><span class="p">,</span> <span class="mf">0.202822</span><span class="p">,</span> <span class="mf">0.503903</span><span class="p">,</span> <span class="mf">0.383421</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">orbital_indices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span>                      <span class="c1"># S shell (uncontracted)</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>          <span class="c1"># S shell (contracted)</span>
    <span class="mi">2</span><span class="p">,</span>                      <span class="c1"># S shell (uncontracted)</span>
    <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>                <span class="c1"># P shell (uncontracted)</span>
    <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>                <span class="c1"># P shell (uncontracted)</span>
    <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>  <span class="c1"># D shell (uncontracted)</span>
    <span class="mi">15</span><span class="p">,</span>                     <span class="c1"># S shell (uncontracted)</span>
    <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>     <span class="c1"># S shell (contracted)</span>
    <span class="mi">17</span><span class="p">,</span>                     <span class="c1"># S shell (uncontracted)</span>
    <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>             <span class="c1"># P shell (uncontracted)</span>
    <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span>             <span class="c1"># P shell (uncontracted)</span>
    <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="c1"># D shell (uncontracted)</span>
<span class="p">]</span>

<span class="n">nucleus_index</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">*</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">15</span><span class="p">),</span>
    <span class="o">*</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">15</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">angular_momentums</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>                <span class="c1"># S shells (1 orbital each)</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>       <span class="c1"># two P shells (3 orbitals each)</span>
    <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>       <span class="c1"># one D shell (6 orbitals each)</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>                <span class="c1"># S shells (1 orbital each)</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>       <span class="c1"># two P shells (3 orbitals each)</span>
    <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>       <span class="c1"># one D shell (6 orbitals each)</span>
<span class="p">]</span>

<span class="n">polynominal_order_x</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">polynominal_order_y</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">polynominal_order_z</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">aos</span> <span class="o">=</span> <span class="n">AOs_cart_data</span><span class="p">(</span>
    <span class="n">structure_data</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span>
    <span class="n">nucleus_index</span><span class="o">=</span><span class="n">nucleus_index</span><span class="p">,</span>
    <span class="n">num_ao</span><span class="o">=</span><span class="n">num_ao</span><span class="p">,</span>
    <span class="n">num_ao_prim</span><span class="o">=</span><span class="n">num_ao_prim</span><span class="p">,</span>
    <span class="n">orbital_indices</span><span class="o">=</span><span class="n">orbital_indices</span><span class="p">,</span>
    <span class="n">exponents</span><span class="o">=</span><span class="n">exponents</span><span class="p">,</span>
    <span class="n">coefficients</span><span class="o">=</span><span class="n">coefficients</span><span class="p">,</span>
    <span class="n">angular_momentums</span><span class="o">=</span><span class="n">angular_momentums</span><span class="p">,</span>
    <span class="n">polynominal_order_x</span><span class="o">=</span><span class="n">polynominal_order_x</span><span class="p">,</span>
    <span class="n">polynominal_order_y</span><span class="o">=</span><span class="n">polynominal_order_y</span><span class="p">,</span>
    <span class="n">polynominal_order_z</span><span class="o">=</span><span class="n">polynominal_order_z</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">aos</span><span class="o">.</span><span class="n">sanity_check</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.angular_momentums">
<span class="sig-name descname"><span class="pre">angular_momentums</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.angular_momentums" title="Link to this definition">#</a></dt>
<dd><p>Angular momentum quantum numbers <code class="docutils literal notranslate"><span class="pre">l</span></code> per AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.coefficients">
<span class="sig-name descname"><span class="pre">coefficients</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.coefficients" title="Link to this definition">#</a></dt>
<dd><p>Contraction coefficients per primitive (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.exponents">
<span class="sig-name descname"><span class="pre">exponents</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.exponents" title="Link to this definition">#</a></dt>
<dd><p>Gaussian exponents for primitives (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.nucleus_index">
<span class="sig-name descname"><span class="pre">nucleus_index</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.nucleus_index" title="Link to this definition">#</a></dt>
<dd><p>AO -&gt; atom index mapping (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.num_ao">
<span class="sig-name descname"><span class="pre">num_ao</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.num_ao" title="Link to this definition">#</a></dt>
<dd><p>Number of contracted AOs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.num_ao_prim">
<span class="sig-name descname"><span class="pre">num_ao_prim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.num_ao_prim" title="Link to this definition">#</a></dt>
<dd><p>Number of primitive Gaussians.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.orbital_indices">
<span class="sig-name descname"><span class="pre">orbital_indices</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.orbital_indices" title="Link to this definition">#</a></dt>
<dd><p>For each primitive, the parent AO index (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.polynominal_order_x">
<span class="sig-name descname"><span class="pre">polynominal_order_x</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_x" title="Link to this definition">#</a></dt>
<dd><p>Cartesian power <code class="docutils literal notranslate"><span class="pre">n_x</span></code> for each AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.polynominal_order_y">
<span class="sig-name descname"><span class="pre">polynominal_order_y</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_y" title="Link to this definition">#</a></dt>
<dd><p>Cartesian power <code class="docutils literal notranslate"><span class="pre">n_y</span></code> for each AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.polynominal_order_z">
<span class="sig-name descname"><span class="pre">polynominal_order_z</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_z" title="Link to this definition">#</a></dt>
<dd><p>Cartesian power <code class="docutils literal notranslate"><span class="pre">n_z</span></code> for each AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Validate AO array shapes and basic types.</p>
<p>Ensures that array lengths match declared counts (<code class="docutils literal notranslate"><span class="pre">num_ao</span></code>, <code class="docutils literal notranslate"><span class="pre">num_ao_prim</span></code>) and
that inputs are provided as lists/tuples (ints for counts). Call this after constructing
<code class="docutils literal notranslate"><span class="pre">AOs_cart_data</span></code> and before AO evaluation routines.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  When any of the following holds:
    - <code class="docutils literal notranslate"><span class="pre">len(nucleus_index)</span> <span class="pre">!=</span> <span class="pre">num_ao</span></code>
    - <code class="docutils literal notranslate"><span class="pre">len(unique(orbital_indices))</span> <span class="pre">!=</span> <span class="pre">num_ao</span></code>
    - <code class="docutils literal notranslate"><span class="pre">len(exponents)</span> <span class="pre">!=</span> <span class="pre">num_ao_prim</span></code> or <code class="docutils literal notranslate"><span class="pre">len(coefficients)</span> <span class="pre">!=</span> <span class="pre">num_ao_prim</span></code>
    - <code class="docutils literal notranslate"><span class="pre">len(angular_momentums)</span> <span class="pre">!=</span> <span class="pre">num_ao</span></code>
    - <code class="docutils literal notranslate"><span class="pre">len(polynominal_order_{x,y,z})</span> <span class="pre">!=</span> <span class="pre">num_ao</span></code>
    - any attribute has an unexpected Python type (e.g., non-list/tuple arrays, non-int counts)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_cart_data.structure_data">
<span class="sig-name descname"><span class="pre">structure_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><span class="pre">Structure_data</span></a></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_cart_data.structure_data" title="Link to this definition">#</a></dt>
<dd><p>Molecular structure and atomic positions used to place AOs.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.atomic_orbital.</span></span><span class="sig-name descname"><span class="pre">AOs_sphe_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nucleus_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ao</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ao_prim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbital_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angular_momentums</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magnetic_quantum_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Atomic orbital definitions in real spherical-harmonic form.</p>
<p>Stores contracted Gaussian basis data for atomic orbitals (AOs) whose angular part is
a real spherical harmonic <span class="math notranslate nohighlight">\(Y_{l}^{m}\)</span> with <span class="math notranslate nohighlight">\(m \in \{-l,\dots,+l\}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Structure_data</span></code>)  Molecular structure and atomic positions used to place AOs.</p></li>
<li><p><strong>nucleus_index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  AO -&gt; atom index mapping (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p></li>
<li><p><strong>num_ao</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of contracted AOs.</p></li>
<li><p><strong>num_ao_prim</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of primitive Gaussians.</p></li>
<li><p><strong>orbital_indices</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  For each primitive, the parent AO index (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p></li>
<li><p><strong>exponents</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Gaussian exponents for primitives (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p></li>
<li><p><strong>coefficients</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Contraction coefficients per primitive (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p></li>
<li><p><strong>angular_momentums</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Angular momentum quantum numbers <code class="docutils literal notranslate"><span class="pre">l</span></code> per AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p></li>
<li><p><strong>magnetic_quantum_numbers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Magnetic quantum numbers <code class="docutils literal notranslate"><span class="pre">m</span></code> per AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>),
satisfying <code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">&lt;=</span> <span class="pre">m</span> <span class="pre">&lt;=</span> <span class="pre">l</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>structure_data</strong> (<a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><em>Structure_data</em></a>)</p></li>
<li><p><strong>nucleus_index</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>num_ao</strong> (<em>int</em>)</p></li>
<li><p><strong>num_ao_prim</strong> (<em>int</em>)</p></li>
<li><p><strong>orbital_indices</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>exponents</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>float</em><em>]</em>)</p></li>
<li><p><strong>coefficients</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>float</em><em>]</em>)</p></li>
<li><p><strong>angular_momentums</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>magnetic_quantum_numbers</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Hydrogen dimer (bohr) with all-electron cc-pVTZ (Gaussian format), real spherical harmonics:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Structure_data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.atomic_orbital</span><span class="w"> </span><span class="kn">import</span> <span class="n">AOs_sphe_data</span>

<span class="n">structure</span> <span class="o">=</span> <span class="n">Structure_data</span><span class="p">(</span>
    <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.70</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">]],</span>
    <span class="n">pbc_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">atomic_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">element_symbols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">],</span>
    <span class="n">atomic_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H1&quot;</span><span class="p">,</span> <span class="s2">&quot;H2&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Per atom: 14 AOs (3 S, 2P shells -&gt; 6, 1D shell -&gt; 5); 18 primitives.</span>
<span class="c1"># Two atoms -&gt; num_ao=28, num_ao_prim=36.</span>
<span class="n">exponents</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># atom 1</span>
    <span class="mf">0.3258</span><span class="p">,</span>
    <span class="mf">33.87</span><span class="p">,</span> <span class="mf">5.095</span><span class="p">,</span> <span class="mf">1.159</span><span class="p">,</span> <span class="mf">0.3258</span><span class="p">,</span> <span class="mf">0.1027</span><span class="p">,</span>
    <span class="mf">0.1027</span><span class="p">,</span>
    <span class="mf">1.407</span><span class="p">,</span> <span class="mf">1.407</span><span class="p">,</span> <span class="mf">1.407</span><span class="p">,</span>
    <span class="mf">0.388</span><span class="p">,</span> <span class="mf">0.388</span><span class="p">,</span> <span class="mf">0.388</span><span class="p">,</span>
    <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span>
    <span class="c1"># atom 2 (same order)</span>
    <span class="mf">0.3258</span><span class="p">,</span>
    <span class="mf">33.87</span><span class="p">,</span> <span class="mf">5.095</span><span class="p">,</span> <span class="mf">1.159</span><span class="p">,</span> <span class="mf">0.3258</span><span class="p">,</span> <span class="mf">0.1027</span><span class="p">,</span>
    <span class="mf">0.1027</span><span class="p">,</span>
    <span class="mf">1.407</span><span class="p">,</span> <span class="mf">1.407</span><span class="p">,</span> <span class="mf">1.407</span><span class="p">,</span>
    <span class="mf">0.388</span><span class="p">,</span> <span class="mf">0.388</span><span class="p">,</span> <span class="mf">0.388</span><span class="p">,</span>
    <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span> <span class="mf">1.057</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># atom 1</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">0.006068</span><span class="p">,</span> <span class="mf">0.045308</span><span class="p">,</span> <span class="mf">0.202822</span><span class="p">,</span> <span class="mf">0.503903</span><span class="p">,</span> <span class="mf">0.383421</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="c1"># atom 2 (same order)</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">0.006068</span><span class="p">,</span> <span class="mf">0.045308</span><span class="p">,</span> <span class="mf">0.202822</span><span class="p">,</span> <span class="mf">0.503903</span><span class="p">,</span> <span class="mf">0.383421</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">orbital_indices</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># atom 1 AOs 0-13</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
    <span class="c1"># atom 2 AOs 14-27</span>
    <span class="mi">14</span><span class="p">,</span>
    <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
    <span class="mi">16</span><span class="p">,</span>
    <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span>
    <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span>
    <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">nucleus_index</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">*</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">14</span><span class="p">),</span>
    <span class="o">*</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">14</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">angular_momentums</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># atom 1</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>                <span class="c1"># S shells</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>       <span class="c1"># two P shells (3 each)</span>
    <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>          <span class="c1"># one D shell (5)</span>
    <span class="c1"># atom 2</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">magnetic_quantum_numbers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># atom 1 (S: m=0; P: -1,0,1; D: -2..2)</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
    <span class="c1"># atom 2</span>
    <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
    <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">aos</span> <span class="o">=</span> <span class="n">AOs_sphe_data</span><span class="p">(</span>
    <span class="n">structure_data</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span>
    <span class="n">nucleus_index</span><span class="o">=</span><span class="n">nucleus_index</span><span class="p">,</span>
    <span class="n">num_ao</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">angular_momentums</span><span class="p">),</span>
    <span class="n">num_ao_prim</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">exponents</span><span class="p">),</span>
    <span class="n">orbital_indices</span><span class="o">=</span><span class="n">orbital_indices</span><span class="p">,</span>
    <span class="n">exponents</span><span class="o">=</span><span class="n">exponents</span><span class="p">,</span>
    <span class="n">coefficients</span><span class="o">=</span><span class="n">coefficients</span><span class="p">,</span>
    <span class="n">angular_momentums</span><span class="o">=</span><span class="n">angular_momentums</span><span class="p">,</span>
    <span class="n">magnetic_quantum_numbers</span><span class="o">=</span><span class="n">magnetic_quantum_numbers</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">aos</span><span class="o">.</span><span class="n">sanity_check</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.angular_momentums">
<span class="sig-name descname"><span class="pre">angular_momentums</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.angular_momentums" title="Link to this definition">#</a></dt>
<dd><p>Angular momentum quantum numbers <code class="docutils literal notranslate"><span class="pre">l</span></code> per AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.coefficients">
<span class="sig-name descname"><span class="pre">coefficients</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.coefficients" title="Link to this definition">#</a></dt>
<dd><p>Contraction coefficients per primitive (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.exponents">
<span class="sig-name descname"><span class="pre">exponents</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.exponents" title="Link to this definition">#</a></dt>
<dd><p>Gaussian exponents for primitives (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.magnetic_quantum_numbers">
<span class="sig-name descname"><span class="pre">magnetic_quantum_numbers</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.magnetic_quantum_numbers" title="Link to this definition">#</a></dt>
<dd><p>Magnetic quantum numbers <code class="docutils literal notranslate"><span class="pre">m</span></code> per AO (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>; <code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">&lt;=</span> <span class="pre">m</span> <span class="pre">&lt;=</span> <span class="pre">l</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.nucleus_index">
<span class="sig-name descname"><span class="pre">nucleus_index</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.nucleus_index" title="Link to this definition">#</a></dt>
<dd><p>AO -&gt; atom index mapping (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.num_ao">
<span class="sig-name descname"><span class="pre">num_ao</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.num_ao" title="Link to this definition">#</a></dt>
<dd><p>Number of contracted AOs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.num_ao_prim">
<span class="sig-name descname"><span class="pre">num_ao_prim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.num_ao_prim" title="Link to this definition">#</a></dt>
<dd><p>Number of primitive Gaussians.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.orbital_indices">
<span class="sig-name descname"><span class="pre">orbital_indices</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.orbital_indices" title="Link to this definition">#</a></dt>
<dd><p>For each primitive, the parent AO index (<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">==</span> <span class="pre">num_ao_prim</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Validate AO array shapes and basic types.</p>
<p>Ensures that array lengths match declared counts (<code class="docutils literal notranslate"><span class="pre">num_ao</span></code>, <code class="docutils literal notranslate"><span class="pre">num_ao_prim</span></code>) and that
inputs are provided as lists/tuples (ints for counts). Call this after constructing
<code class="docutils literal notranslate"><span class="pre">AOs_sphe_data</span></code> and before AO evaluation routines.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  When any of the following holds:
    - <code class="docutils literal notranslate"><span class="pre">len(nucleus_index)</span> <span class="pre">!=</span> <span class="pre">num_ao</span></code>
    - <code class="docutils literal notranslate"><span class="pre">len(unique(orbital_indices))</span> <span class="pre">!=</span> <span class="pre">num_ao</span></code>
    - <code class="docutils literal notranslate"><span class="pre">len(exponents)</span> <span class="pre">!=</span> <span class="pre">num_ao_prim</span></code> or <code class="docutils literal notranslate"><span class="pre">len(coefficients)</span> <span class="pre">!=</span> <span class="pre">num_ao_prim</span></code>
    - <code class="docutils literal notranslate"><span class="pre">len(angular_momentums)</span> <span class="pre">!=</span> <span class="pre">num_ao</span></code>
    - <code class="docutils literal notranslate"><span class="pre">len(magnetic_quantum_numbers)</span> <span class="pre">!=</span> <span class="pre">num_ao</span></code>
    - any attribute has an unexpected Python type (e.g., non-list/tuple arrays, non-int counts)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.AOs_sphe_data.structure_data">
<span class="sig-name descname"><span class="pre">structure_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><span class="pre">Structure_data</span></a></span><a class="headerlink" href="#jqmc.atomic_orbital.AOs_sphe_data.structure_data" title="Link to this definition">#</a></dt>
<dd><p>Molecular structure and atomic positions used to place AOs.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.compute_AOs">
<span class="sig-prename descclassname"><span class="pre">jqmc.atomic_orbital.</span></span><span class="sig-name descname"><span class="pre">compute_AOs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aos_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.compute_AOs" title="Link to this definition">#</a></dt>
<dd><p>Evaluate contracted atomic orbitals (AOs) at electron coordinates.</p>
<p>Dispatches to Cartesian or real-spherical backends and returns float64 JAX arrays
(ensure <code class="docutils literal notranslate"><span class="pre">jax_enable_x64=True</span></code>). Call <code class="docutils literal notranslate"><span class="pre">aos_data.sanity_check()</span></code> before use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aos_data</strong> (<a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><em>AOs_sphe_data</em></a><em> | </em><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><em>AOs_cart_data</em></a>)  <code class="docutils literal notranslate"><span class="pre">AOs_cart_data</span></code> or <code class="docutils literal notranslate"><span class="pre">AOs_sphe_data</span></code> describing centers, primitive parameters,
angular data, and contraction mapping.</p></li>
<li><p><strong>r_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Electron Cartesian coordinates, shape <code class="docutils literal notranslate"><span class="pre">(N_e,</span> <span class="pre">3)</span></code> in Bohr. Casts to
<code class="docutils literal notranslate"><span class="pre">float64</span></code> internally via <code class="docutils literal notranslate"><span class="pre">jnp.asarray</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>AO values, shape <code class="docutils literal notranslate"><span class="pre">(num_ao,</span> <span class="pre">N_e)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong>  If <code class="docutils literal notranslate"><span class="pre">aos_data</span></code> is neither Cartesian nor spherical.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.compute_AOs_grad">
<span class="sig-prename descclassname"><span class="pre">jqmc.atomic_orbital.</span></span><span class="sig-name descname"><span class="pre">compute_AOs_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aos_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.compute_AOs_grad" title="Link to this definition">#</a></dt>
<dd><p>Return analytic Cartesian gradients of contracted atomic orbitals.</p>
<p>Public gradient API used for drift vectors and kinetic terms. Dispatches to Cartesian or real-spherical
backends; returns float64 JAX arrays (ensure <code class="docutils literal notranslate"><span class="pre">jax_enable_x64=True</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aos_data</strong> (<a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><em>AOs_sphe_data</em></a><em> | </em><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><em>AOs_cart_data</em></a>)  <code class="docutils literal notranslate"><span class="pre">AOs_cart_data</span></code> or <code class="docutils literal notranslate"><span class="pre">AOs_sphe_data</span></code> describing primitive parameters, angular info,
contraction mapping, and centers (run <code class="docutils literal notranslate"><span class="pre">sanity_check()</span></code> beforehand).</p></li>
<li><p><strong>r_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Electron Cartesian coordinates, shape <code class="docutils literal notranslate"><span class="pre">(N_e,</span> <span class="pre">3)</span></code> (Bohr). Casts to <code class="docutils literal notranslate"><span class="pre">float64</span></code>
internally via <code class="docutils literal notranslate"><span class="pre">jnp.asarray</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradients w.r.t. x, y, z, each of shape <code class="docutils literal notranslate"><span class="pre">(num_ao,</span> <span class="pre">N_e)</span></code>.
Order is <code class="docutils literal notranslate"><span class="pre">(gx,</span> <span class="pre">gy,</span> <span class="pre">gz)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array, jax.Array]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong>  If <code class="docutils literal notranslate"><span class="pre">aos_data</span></code> is neither Cartesian nor spherical.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.atomic_orbital.compute_AOs_laplacian">
<span class="sig-prename descclassname"><span class="pre">jqmc.atomic_orbital.</span></span><span class="sig-name descname"><span class="pre">compute_AOs_laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aos_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.atomic_orbital.compute_AOs_laplacian" title="Link to this definition">#</a></dt>
<dd><p>Return analytic Laplacians of contracted atomic orbitals.</p>
<p>Dispatches to Cartesian or real-spherical implementations; returns float64 JAX arrays
(ensure <code class="docutils literal notranslate"><span class="pre">jax_enable_x64=True</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aos_data</strong> (<a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><em>AOs_sphe_data</em></a><em> | </em><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><em>AOs_cart_data</em></a>)  <code class="docutils literal notranslate"><span class="pre">AOs_cart_data</span></code> or <code class="docutils literal notranslate"><span class="pre">AOs_sphe_data</span></code> describing centers, primitive exponents/coefficients,
angular data, and contraction mapping (run <code class="docutils literal notranslate"><span class="pre">sanity_check()</span></code> beforehand).</p></li>
<li><p><strong>r_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Electron Cartesian coordinates, shape <code class="docutils literal notranslate"><span class="pre">(N_e,</span> <span class="pre">3)</span></code> (Bohr). Casts to <code class="docutils literal notranslate"><span class="pre">float64</span></code>
internally via <code class="docutils literal notranslate"><span class="pre">jnp.asarray</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Laplacians of all contracted AOs, shape <code class="docutils literal notranslate"><span class="pre">(num_ao,</span> <span class="pre">N_e)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong>  If <code class="docutils literal notranslate"><span class="pre">aos_data</span></code> is not Cartesian or spherical.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.coulomb_potential">
<span id="jqmc-coulomb-potential-module"></span><h2>jqmc.coulomb_potential module<a class="headerlink" href="#module-jqmc.coulomb_potential" title="Link to this heading">#</a></h2>
<p>Effective core potential module.</p>
<p>Module containing classes and methods related to Effective core potential
and bare Coulomb potentials</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">Coulomb_potential_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecp_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ang_mom_plus_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ecps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang_moms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nucleus_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponents</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for bare Coulomb and effective core potential (ECP) parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Structure_data</span></code>)  Underlying nuclear geometry and metadata.</p></li>
<li><p><strong>ecp_flag</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>)  Whether ECPs are present. When <code class="docutils literal notranslate"><span class="pre">True</span></code>, all ECP arrays must be populated.</p></li>
<li><p><strong>z_cores</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Core electrons removed per atom; length <code class="docutils literal notranslate"><span class="pre">natom</span></code>.</p></li>
<li><p><strong>max_ang_mom_plus_1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  <code class="docutils literal notranslate"><span class="pre">l_max</span> <span class="pre">+</span> <span class="pre">1</span></code> for each atom; length <code class="docutils literal notranslate"><span class="pre">natom</span></code>.</p></li>
<li><p><strong>num_ecps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Total number of ECP projector terms across all atoms and angular momenta.</p></li>
<li><p><strong>ang_moms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Angular momentum <code class="docutils literal notranslate"><span class="pre">l</span></code> per ECP term; length <code class="docutils literal notranslate"><span class="pre">num_ecps</span></code>.</p></li>
<li><p><strong>nucleus_index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Atom index per ECP term; length <code class="docutils literal notranslate"><span class="pre">num_ecps</span></code>.</p></li>
<li><p><strong>exponents</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Gaussian exponents per ECP term; length <code class="docutils literal notranslate"><span class="pre">num_ecps</span></code>.</p></li>
<li><p><strong>coefficients</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Prefactors per ECP term; length <code class="docutils literal notranslate"><span class="pre">num_ecps</span></code>.</p></li>
<li><p><strong>powers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Polynomial powers per ECP term; length <code class="docutils literal notranslate"><span class="pre">num_ecps</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">ecp_flag</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, all ECP-related sequences must be empty and <code class="docutils literal notranslate"><span class="pre">num_ecps</span></code> should be 0.</p></li>
<li><p>Arrays are stored as Python lists/tuples for pytrees; conversion to <code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> happens in the compute kernels.</p></li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.ang_moms">
<span class="sig-name descname"><span class="pre">ang_moms</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.ang_moms" title="Link to this definition">#</a></dt>
<dd><p>Angular momentum <code class="docutils literal notranslate"><span class="pre">l</span></code> per ECP term (len = num_ecps).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.coefficients">
<span class="sig-name descname"><span class="pre">coefficients</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.coefficients" title="Link to this definition">#</a></dt>
<dd><p>Prefactors per ECP term (len = num_ecps).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.ecp_flag">
<span class="sig-name descname"><span class="pre">ecp_flag</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.ecp_flag" title="Link to this definition">#</a></dt>
<dd><p>Whether ECP parameters are active.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.exponents">
<span class="sig-name descname"><span class="pre">exponents</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.exponents" title="Link to this definition">#</a></dt>
<dd><p>Gaussian exponents per ECP term (len = num_ecps).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.max_ang_mom_plus_1">
<span class="sig-name descname"><span class="pre">max_ang_mom_plus_1</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.max_ang_mom_plus_1" title="Link to this definition">#</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">l_max</span> <span class="pre">+</span> <span class="pre">1</span></code> per atom (len = natom).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.nucleus_index">
<span class="sig-name descname"><span class="pre">nucleus_index</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.nucleus_index" title="Link to this definition">#</a></dt>
<dd><p>Atom index per ECP term (len = num_ecps).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.num_ecps">
<span class="sig-name descname"><span class="pre">num_ecps</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.num_ecps" title="Link to this definition">#</a></dt>
<dd><p>Total ECP projector terms across all atoms.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.powers">
<span class="sig-name descname"><span class="pre">powers</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.powers" title="Link to this definition">#</a></dt>
<dd><p>Polynomial powers per ECP term (len = num_ecps).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.structure_data">
<span class="sig-name descname"><span class="pre">structure_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><span class="pre">Structure_data</span></a></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.structure_data" title="Link to this definition">#</a></dt>
<dd><p>Nuclear geometry and atom metadata.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.Coulomb_potential_data.z_cores">
<span class="sig-name descname"><span class="pre">z_cores</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.coulomb_potential.Coulomb_potential_data.z_cores" title="Link to this definition">#</a></dt>
<dd><p>Core electrons removed per atom (len = natom).</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_bare_coulomb_potential">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_bare_coulomb_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential" title="Link to this definition">#</a></dt>
<dd><p>Compute bare Coulomb interaction (ionion, electronion, electronelectron).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  Structure and charges (effective if ECPs present).</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total bare Coulomb energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_bare_coulomb_potential_el_el">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_bare_coulomb_potential_el_el</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_el" title="Link to this definition">#</a></dt>
<dd><p>Electronelectron Coulomb interaction energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Electronelectron Coulomb energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_bare_coulomb_potential_el_ion">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_bare_coulomb_potential_el_ion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_ion" title="Link to this definition">#</a></dt>
<dd><p>Total electronion Coulomb interaction energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  Structure and charges (effective if ECPs present).</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Electronion Coulomb energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_bare_coulomb_potential_el_ion_element_wise">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_bare_coulomb_potential_el_ion_element_wise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_ion_element_wise" title="Link to this definition">#</a></dt>
<dd><p>Element-wise electronion Coulomb interactions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  Structure and charges (effective if ECPs present).</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Element-wise ionelectron interactions for up spins and down spins (shape <code class="docutils literal notranslate"><span class="pre">(N_up,)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,)</span></code>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_bare_coulomb_potential_ion_ion">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_bare_coulomb_potential_ion_ion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_ion_ion" title="Link to this definition">#</a></dt>
<dd><p>Ionion Coulomb interaction energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  Structure and charges (effective if ECPs present).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ionion Coulomb energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_coulomb_potential">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_coulomb_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_coulomb_potential" title="Link to this definition">#</a></dt>
<dd><p>Compute total Coulomb energy including bare and ECP terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  Structure, charges, and ECP parameters.</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>RT</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Rotation matrix applied to quadrature grid points (shape <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code>) for non-local ECP.</p></li>
<li><p><strong>NN</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of nearest nuclei to include for each electron in the non-local term.</p></li>
<li><p><strong>Nv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of quadrature points on the sphere.</p></li>
<li><p><strong>wavefunction_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction_data</span></code>)  Wavefunction (geminal + Jastrow) used for ECP ratios; required when <code class="docutils literal notranslate"><span class="pre">ecp_flag</span></code> is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sum of bare Coulomb (ionion, electronion, electronelectron) and ECP (local + non-local) energies.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_discretized_bare_coulomb_potential_el_ion_element_wise">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_discretized_bare_coulomb_potential_el_ion_element_wise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_discretized_bare_coulomb_potential_el_ion_element_wise" title="Link to this definition">#</a></dt>
<dd><p>Element-wise electronion Coulomb interactions with distance floor <code class="docutils literal notranslate"><span class="pre">alat</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  Structure and charges (effective if ECPs present).</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>alat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)  Minimum allowed distance to avoid divergence.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Element-wise ionelectron interactions for up spins and down spins (shape <code class="docutils literal notranslate"><span class="pre">(N_up,)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,)</span></code>).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_ecp_coulomb_potential">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_ecp_coulomb_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_ecp_coulomb_potential" title="Link to this definition">#</a></dt>
<dd><p>Compute total ECP energy (local + non-local) for a configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  ECP parameters and structure data.</p></li>
<li><p><strong>wavefunction_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction_data</span></code>)  Wavefunction (geminal + Jastrow) used for ratios.</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>RT</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Rotation matrix applied to quadrature grid points (shape <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code>).</p></li>
<li><p><strong>NN</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of nearest nuclei to include for each electron in the non-local term.</p></li>
<li><p><strong>Nv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of quadrature points on the sphere.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sum of local and non-local ECP contributions for the given geometry.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_ecp_local_parts_all_pairs">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_ecp_local_parts_all_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_ecp_local_parts_all_pairs" title="Link to this definition">#</a></dt>
<dd><p>Compute local ECP contribution over all nucleuselectron pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  ECP parameters and structure data.</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total local ECP energy for the provided electron coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_ecp_non_local_part_all_pairs_jax_weights_grid_points">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_ecp_non_local_part_all_pairs_jax_weights_grid_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_points</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_determinant_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_ecp_non_local_part_all_pairs_jax_weights_grid_points" title="Link to this definition">#</a></dt>
<dd><p>Vectorized non-local ECP projection over all pairs with provided quadrature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  ECP parameters and structure data.</p></li>
<li><p><strong>wavefunction_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction_data</span></code>)  Wavefunction (geminal + Jastrow) used for ratios.</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span></code>)  Quadrature weights for angular integration.</p></li>
<li><p><strong>grid_points</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">npt.NDArray[np.float64]</span></code>)  Quadrature grid points with shape <code class="docutils literal notranslate"><span class="pre">(Nv,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>flag_determinant_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  If 1, skip Jastrow in the wavefunction ratio; if 0, include it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Mesh-displaced up-spin coordinates per configuration.</p></li>
<li><p>Mesh-displaced down-spin coordinates per configuration.</p></li>
<li><p>Non-local contributions for up-spin mesh points.</p></li>
<li><p>Non-local contributions for down-spin mesh points.</p></li>
<li><p>Scalar sum of all non-local contributions.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array, jax.Array, jax.Array, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_ecp_non_local_parts_all_pairs">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_ecp_non_local_parts_all_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_determinant_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_all_pairs" title="Link to this definition">#</a></dt>
<dd><p>Compute non-local ECP contribution considering all nucleuselectron pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  ECP parameters and structure data.</p></li>
<li><p><strong>wavefunction_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction_data</span></code>)  Wavefunction (geminal + Jastrow) used for ratios.</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>RT</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Rotation matrix applied to quadrature grid points (shape <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code>).</p></li>
<li><p><strong>Nv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of quadrature points on the sphere.</p></li>
<li><p><strong>flag_determinant_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>)  If True, ignore Jastrow in the wavefunction ratio.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Mesh-displaced <code class="docutils literal notranslate"><span class="pre">r_up_carts</span></code> per configuration.</p></li>
<li><p>Mesh-displaced <code class="docutils literal notranslate"><span class="pre">r_dn_carts</span></code> per configuration.</p></li>
<li><p>Non-local ECP contributions per configuration (flattened).</p></li>
<li><p>Scalar sum of all non-local contributions.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[list[jax.Array], list[jax.Array], jax.Array, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_ecp_non_local_parts_nearest_neighbors">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_ecp_non_local_parts_nearest_neighbors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_determinant_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_nearest_neighbors" title="Link to this definition">#</a></dt>
<dd><p>Compute non-local ECP contribution with a nearest-neighbor cutoff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  ECP parameters and structure data.</p></li>
<li><p><strong>wavefunction_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction_data</span></code>)  Wavefunction (geminal + Jastrow) used for ratios.</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>RT</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Rotation matrix applied to quadrature grid points (shape <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code>).</p></li>
<li><p><strong>NN</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of nearest nuclei to include for each electron.</p></li>
<li><p><strong>Nv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of quadrature points on the sphere.</p></li>
<li><p><strong>flag_determinant_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>)  If True, ignore Jastrow in the wavefunction ratio.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Mesh-displaced <code class="docutils literal notranslate"><span class="pre">r_up_carts</span></code> per configuration.</p></li>
<li><p>Mesh-displaced <code class="docutils literal notranslate"><span class="pre">r_dn_carts</span></code> per configuration.</p></li>
<li><p>Non-local ECP contributions per configuration (flattened).</p></li>
<li><p>Scalar sum of all non-local contributions.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[list[jax.Array], list[jax.Array], jax.Array, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.coulomb_potential.compute_ecp_non_local_parts_nearest_neighbors_fast_update">
<span class="sig-prename descclassname"><span class="pre">jqmc.coulomb_potential.</span></span><span class="sig-name descname"><span class="pre">compute_ecp_non_local_parts_nearest_neighbors_fast_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_old_inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flag_determinant_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_nearest_neighbors_fast_update" title="Link to this definition">#</a></dt>
<dd><p>Fast-update variant of non-local ECP contributions (nearest neighbors).</p>
<p>This variant reuses the inverse geminal matrix to compute determinant ratios
and uses Jastrow ratios, avoiding full recomputation for each mesh point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a>)  ECP parameters and structure data.</p></li>
<li><p><strong>wavefunction_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction_data</span></code>)  Wavefunction (geminal + Jastrow) used for ratios.</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Up-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Down-spin electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
<li><p><strong>RT</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Rotation matrix applied to quadrature grid points (shape <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code>).</p></li>
<li><p><strong>A_old_inv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Inverse geminal matrix evaluated at <code class="docutils literal notranslate"><span class="pre">(r_up_carts,</span> <span class="pre">r_dn_carts)</span></code>.</p></li>
<li><p><strong>NN</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of nearest nuclei to include for each electron.</p></li>
<li><p><strong>Nv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of quadrature points on the sphere.</p></li>
<li><p><strong>flag_determinant_only</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>)  If True, ignore Jastrow in the wavefunction ratio.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Mesh-displaced <code class="docutils literal notranslate"><span class="pre">r_up_carts</span></code> per configuration.</p></li>
<li><p>Mesh-displaced <code class="docutils literal notranslate"><span class="pre">r_dn_carts</span></code> per configuration.</p></li>
<li><p>Non-local ECP contributions per configuration (flattened).</p></li>
<li><p>Scalar sum of all non-local contributions.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[list[jax.Array], list[jax.Array], jax.Array, float]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.determinant">
<span id="jqmc-determinant-module"></span><h2>jqmc.determinant module<a class="headerlink" href="#module-jqmc.determinant" title="Link to this heading">#</a></h2>
<p>Determinant module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">Geminal_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_electron_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_electron_dn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_data_up_spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_data_dn_spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambda_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Geminal (AGP) parameters and orbital references.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_electron_up</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of spin-up electrons.</p></li>
<li><p><strong>num_electron_dn</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of spin-down electrons.</p></li>
<li><p><strong>orb_data_up_spin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AOs_data</span> <span class="pre">|</span> <span class="pre">MOs_data</span></code>)  Basis/orbitals for spin-up electrons.</p></li>
<li><p><strong>orb_data_dn_spin</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AOs_data</span> <span class="pre">|</span> <span class="pre">MOs_data</span></code>)  Basis/orbitals for spin-down electrons.</p></li>
<li><p><strong>lambda_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">npt.NDArray</span> <span class="pre">|</span> <span class="pre">jax.Array</span></code>)  Geminal pairing matrix with shape
<code class="docutils literal notranslate"><span class="pre">(orb_num_up,</span> <span class="pre">orb_num_dn</span> <span class="pre">+</span> <span class="pre">num_electron_up</span> <span class="pre">-</span> <span class="pre">num_electron_dn)</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For closed shells, <code class="docutils literal notranslate"><span class="pre">orb_num_up</span> <span class="pre">==</span> <span class="pre">orb_num_dn</span></code> and <code class="docutils literal notranslate"><span class="pre">lambda_matrix</span></code> is square.</p></li>
<li><p>For open shells, the right block encodes unpaired spin-up orbitals.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.accumulate_position_grad">
<span class="sig-name descname"><span class="pre">accumulate_position_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_geminal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data.accumulate_position_grad" title="Link to this definition">#</a></dt>
<dd><p>Aggregate position gradients from geminal-related structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grad_geminal</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.apply_block_update">
<span class="sig-name descname"><span class="pre">apply_block_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data.apply_block_update" title="Link to this definition">#</a></dt>
<dd><p>Apply a single variational-parameter block update to this Geminal object.</p>
<p>This method is the Geminal-specific counterpart of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Wavefunction_data.apply_block_updates()</span></code>.  It receives a generic
<code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalParameterBlock</span></code> whose <code class="docutils literal notranslate"><span class="pre">values</span></code> have already been
updated (typically by <code class="docutils literal notranslate"><span class="pre">block.apply_update</span></code> inside the SR/MCMC driver),
and interprets that block according to the structure of the geminal
(lambda) matrix.</p>
<p>Responsibilities of this method are:</p>
<ul class="simple">
<li><p>Map the block name (currently <code class="docutils literal notranslate"><span class="pre">&quot;lambda_matrix&quot;</span></code>) to the internal
geminal parameters.</p></li>
<li><p>Handle the splitting of a rectangular lambda matrix into paired and
unpaired parts when needed.</p></li>
<li><p>Enforce Geminal-specific structural constraints, especially the
symmetry conditions on the paired block of the lambda matrix.</p></li>
</ul>
<p>All details about how the lambda parameters are stored and constrained
live here (and in the surrounding <code class="docutils literal notranslate"><span class="pre">Geminal_data</span></code> class), not in
<code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalParameterBlock</span></code> or in the optimizer.  This keeps the
SR/MCMC machinery and the block abstraction structure-agnostic: adding
new Geminal parameters should only require updating the block
construction in <code class="docutils literal notranslate"><span class="pre">Wavefunction_data.get_variational_blocks</span></code> and adding
the corresponding handling in this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>block</strong> (<a class="reference internal" href="#jqmc.wavefunction.VariationalParameterBlock" title="jqmc.wavefunction.VariationalParameterBlock"><em>VariationalParameterBlock</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data">Geminal_data</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.collect_param_grads">
<span class="sig-name descname"><span class="pre">collect_param_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_geminal</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data.collect_param_grads" title="Link to this definition">#</a></dt>
<dd><p>Collect parameter gradients into a flat dict keyed by block name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grad_geminal</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, object]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.compute_orb_api">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_orb_api</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.compute_orb_api" title="Link to this definition">#</a></dt>
<dd><p>Function for computing AOs or MOs.</p>
<p>The api method to compute AOs or MOs corresponding to instances
stored in self.orb_data_up_spin and self.orb_data_dn_spin</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The api method to compute AOs or MOs.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong>  If the instances of orb_data_up_spin/orb_data_dn_spin are
    neither AOs_data/AOs_data nor MOs_data/MOs_data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.compute_orb_grad_api">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_orb_grad_api</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.compute_orb_grad_api" title="Link to this definition">#</a></dt>
<dd><p>Function for computing AOs or MOs grads.</p>
<p>The api method to compute AOs or MOs grads corresponding to instances
stored in self.orb_data_up_spin and self.orb_data_dn_spin.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The api method to compute AOs or MOs grads.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong>  If the instances of orb_data_up_spin/orb_data_dn_spin are
    neither AOs_data/AOs_data nor MOs_data/MOs_data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.compute_orb_laplacian_api">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_orb_laplacian_api</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.compute_orb_laplacian_api" title="Link to this definition">#</a></dt>
<dd><p>Function for computing AOs or MOs laplacians.</p>
<p>The api method to compute AOs or MOs laplacians corresponding to instances
stored in self.orb_data_up_spin and self.orb_data_dn_spin.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The api method to compute AOs or MOs laplacians.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong>  If the instances of orb_data_up_spin/orb_data_dn_spin are
    neither AOs_data/AOs_data nor MOs_data/MOs_data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.convert_from_MOs_to_AOs">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">convert_from_MOs_to_AOs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data.convert_from_MOs_to_AOs" title="Link to this definition">#</a></dt>
<dd><p>Convert MOs to AOs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>geminal_data</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.lambda_matrix">
<span class="sig-name descname"><span class="pre">lambda_matrix</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.lambda_matrix" title="Link to this definition">#</a></dt>
<dd><p>Geminal pairing matrix; see class notes for expected shape.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.num_electron_dn">
<span class="sig-name descname"><span class="pre">num_electron_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.num_electron_dn" title="Link to this definition">#</a></dt>
<dd><p>Number of spin-down electrons.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.num_electron_up">
<span class="sig-name descname"><span class="pre">num_electron_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.num_electron_up" title="Link to this definition">#</a></dt>
<dd><p>Number of spin-up electrons.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.orb_data_dn_spin">
<span class="sig-name descname"><span class="pre">orb_data_dn_spin</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><span class="pre">AOs_sphe_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><span class="pre">AOs_cart_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><span class="pre">MOs_data</span></a></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.orb_data_dn_spin" title="Link to this definition">#</a></dt>
<dd><p>Orbital data (AOs or MOs) for spin-down electrons.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.orb_data_up_spin">
<span class="sig-name descname"><span class="pre">orb_data_up_spin</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><span class="pre">AOs_sphe_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><span class="pre">AOs_cart_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><span class="pre">MOs_data</span></a></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.orb_data_up_spin" title="Link to this definition">#</a></dt>
<dd><p>Orbital data (AOs or MOs) for spin-up electrons.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.orb_num_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">orb_num_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.orb_num_dn" title="Link to this definition">#</a></dt>
<dd><p>orb_num_dn.</p>
<p>The number of atomic orbitals or molecular orbitals for down electrons,
depending on the instance stored in the attribute orb_data_up.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of atomic orbitals or molecular orbitals for down electrons.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong>  If the instance of orb_data_dn_spin is neither AOs_data nor MOs_data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.orb_num_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">orb_num_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.determinant.Geminal_data.orb_num_up" title="Link to this definition">#</a></dt>
<dd><p>orb_num_up.</p>
<p>The number of atomic orbitals or molecular orbitals for up electrons,
depending on the instance stored in the attribute orb_data_up.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of atomic orbitals or molecular orbitals for up electrons.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong>  If the instance of orb_data_up_spin is neither AOs_data nor MOs_data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.to_cartesian">
<span class="sig-name descname"><span class="pre">to_cartesian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data.to_cartesian" title="Link to this definition">#</a></dt>
<dd><p>Convert spherical orbitals to Cartesian and transform the lambda matrix.</p>
<p>If the underlying orbitals are MOs, defer to <code class="docutils literal notranslate"><span class="pre">MOs_data.to_cartesian</span></code>
(the lambda matrix is unchanged). For Cartesian inputs, return self.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.determinant.Geminal_data.to_spherical">
<span class="sig-name descname"><span class="pre">to_spherical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.Geminal_data.to_spherical" title="Link to this definition">#</a></dt>
<dd><p>Convert Cartesian orbitals to spherical and transform the lambda matrix.</p>
<p>If the underlying orbitals are MOs, defer to <code class="docutils literal notranslate"><span class="pre">MOs_data.to_spherical</span></code>
(the lambda matrix is unchanged). For spherical inputs, return self.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.determinant.compute_AS_regularization_factor">
<span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">compute_AS_regularization_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.compute_AS_regularization_factor" title="Link to this definition">#</a></dt>
<dd><p>Compute AttaccaliteSorella regularization from electron coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geminal_data</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)  Geminal parameters and orbital references.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-up electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-down electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar AS regularization factor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.determinant.compute_AS_regularization_factor_fast_update">
<span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">compute_AS_regularization_factor_fast_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geminal_inv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.compute_AS_regularization_factor_fast_update" title="Link to this definition">#</a></dt>
<dd><p>Compute AttaccaliteSorella regularization via fast update.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geminal</strong> (<em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>float64</em><em>]</em><em>]</em>)  Geminal matrix with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">N_up)</span></code>.</p></li>
<li><p><strong>geminal_inv</strong> (<em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>float64</em><em>]</em><em>]</em>)  Inverse geminal matrix with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">N_up)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar AS regularization factor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.determinant.compute_det_geminal_all_elements">
<span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">compute_det_geminal_all_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.compute_det_geminal_all_elements" title="Link to this definition">#</a></dt>
<dd><p>Compute $det G$ for the geminal matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geminal_data</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)  Geminal parameters and orbital references.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-up electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-down electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar determinant of the geminal matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.determinant.compute_geminal_all_elements">
<span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">compute_geminal_all_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.compute_geminal_all_elements" title="Link to this definition">#</a></dt>
<dd><p>Compute geminal matrix $G$ for all electron pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geminal_data</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)  Geminal parameters and orbital references.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-up electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-down electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Geminal matrix with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">N_up)</span></code> combining paired and unpaired blocks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.determinant.compute_geminal_dn_one_column_elements">
<span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">compute_geminal_dn_one_column_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_cart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.compute_geminal_dn_one_column_elements" title="Link to this definition">#</a></dt>
<dd><p>Single column of the geminal matrix for one spin-down electron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geminal_data</strong>  Geminal parameters and orbital references.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-up electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_cart</strong> (<em>Array</em>)  Cartesian coordinate for one spin-down electron with shape <code class="docutils literal notranslate"><span class="pre">(3,)</span></code> or <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Column vector for the paired block with shape <code class="docutils literal notranslate"><span class="pre">(N_up,)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.determinant.compute_geminal_up_one_row_elements">
<span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">compute_geminal_up_one_row_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.compute_geminal_up_one_row_elements" title="Link to this definition">#</a></dt>
<dd><p>Single row of the geminal matrix for one spin-up electron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geminal_data</strong>  Geminal parameters and orbital references.</p></li>
<li><p><strong>r_up_cart</strong> (<em>Array</em>)  Cartesian coordinate for one spin-up electron with shape <code class="docutils literal notranslate"><span class="pre">(3,)</span></code> or <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates for all spin-down electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Row vector with shape <code class="docutils literal notranslate"><span class="pre">(N_dn</span> <span class="pre">+</span> <span class="pre">N_unpaired,)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.determinant.compute_grads_and_laplacian_ln_Det">
<span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">compute_grads_and_laplacian_ln_Det</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.compute_grads_and_laplacian_ln_Det" title="Link to this definition">#</a></dt>
<dd><p>Gradients and Laplacians of $lndet G$ for each electron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geminal_data</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)  Geminal parameters and orbital references.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-up electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-down electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Gradients for spin-up electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p>Gradients for spin-down electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
<li><p>Laplacians for spin-up electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_up,)</span></code>.</p></li>
<li><p>Laplacians for spin-down electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,)</span></code>.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.determinant.compute_grads_and_laplacian_ln_Det_fast">
<span class="sig-prename descclassname"><span class="pre">jqmc.determinant.</span></span><span class="sig-name descname"><span class="pre">compute_grads_and_laplacian_ln_Det_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geminal_inverse</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.determinant.compute_grads_and_laplacian_ln_Det_fast" title="Link to this definition">#</a></dt>
<dd><p>Gradients and Laplacians of ln det G using a precomputed inverse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geminal_data</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)  Geminal parameters and orbital references.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-up electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of spin-down electrons with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>geminal_inverse</strong> (<em>Array</em>)  Precomputed inverse of the geminal matrix <code class="docutils literal notranslate"><span class="pre">G</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradients (up/down) and Laplacians (up/down) of ln det G per electron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[<em>Array</em>, <em>Array</em>, <em>Array</em>, <em>Array</em>]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.diff_mask">
<span id="jqmc-diff-mask-module"></span><h2>jqmc.diff_mask module<a class="headerlink" href="#module-jqmc.diff_mask" title="Link to this heading">#</a></h2>
<p>Utilities for masking PyTree leaves by derivative type.</p>
<p>This module centralizes the logic for selectively stopping gradients on
parameter- or coordinate-like leaves so we can reuse the same dataclasses
for all derivative modes (params, positions, or none) without proliferating
specialized subclasses.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.diff_mask.DiffMask">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.diff_mask.</span></span><span class="sig-name descname"><span class="pre">DiffMask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.diff_mask.DiffMask" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Simple mask controlling which leaf types remain differentiable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>bool</em>)</p></li>
<li><p><strong>coords</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.diff_mask.DiffMask.coords">
<span class="sig-name descname"><span class="pre">coords</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></span><a class="headerlink" href="#jqmc.diff_mask.DiffMask.coords" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.diff_mask.DiffMask.params">
<span class="sig-name descname"><span class="pre">params</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></span><a class="headerlink" href="#jqmc.diff_mask.DiffMask.params" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.diff_mask.DiffMask.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.diff_mask.DiffMask.update" title="Link to this definition">#</a></dt>
<dd><p>Return a new mask with any provided overrides applied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>bool</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>coords</strong> (<em>bool</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.diff_mask.DiffMask" title="jqmc.diff_mask.DiffMask"><em>DiffMask</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.diff_mask.apply_diff_mask">
<span class="sig-prename descclassname"><span class="pre">jqmc.diff_mask.</span></span><span class="sig-name descname"><span class="pre">apply_diff_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.diff_mask.apply_diff_mask" title="Link to this definition">#</a></dt>
<dd><p>Return a copy of <code class="docutils literal notranslate"><span class="pre">obj</span></code> with gradients stopped according to <code class="docutils literal notranslate"><span class="pre">mask</span></code>.</p>
<p>The function recurses through dataclass fields (including Flax <code class="docutils literal notranslate"><span class="pre">struct</span></code>
dataclasses), honoring optional <code class="docutils literal notranslate"><span class="pre">diff_tag</span></code> metadata on fields when
present. Otherwise, a small set of field-name heuristics is used to decide
whether a leaf should be treated as a parameter (param) or coordinate
(coord).  Lists/tuples are traversed elementwise; everything else is
returned unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<em>Any</em>)</p></li>
<li><p><strong>mask</strong> (<a class="reference internal" href="#jqmc.diff_mask.DiffMask" title="jqmc.diff_mask.DiffMask"><em>DiffMask</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Any</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.function_collections">
<span id="jqmc-function-collections-module"></span><h2>jqmc.function_collections module<a class="headerlink" href="#module-jqmc.function_collections" title="Link to this heading">#</a></h2>
<p>Collections of useful functions.</p>
</section>
<section id="module-jqmc.hamiltonians">
<span id="jqmc-hamiltonians-module"></span><h2>jqmc.hamiltonians module<a class="headerlink" href="#module-jqmc.hamiltonians" title="Link to this heading">#</a></h2>
<p>Hamiltonian module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.hamiltonians.</span></span><span class="sig-name descname"><span class="pre">Hamiltonian_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coulomb_potential_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Hamiltonian dataclass.</p>
<p>The class contains data for computing Kinetic and Potential energy terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Structure_data</span></code>)  an instance of Structure_data</p></li>
<li><p><strong>coulomb_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Coulomb_data</span></code>)  an instance of Coulomb_data</p></li>
<li><p><strong>wavefunction_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction_data</span></code>)  an instance of Wavefunction_data</p></li>
<li><p><strong>coulomb_potential_data</strong> (<a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><em>Coulomb_potential_data</em></a>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Heres are the differentiable arguments, i.e., pytree_node = True
This information is a little bit tricky in terms of a principle of the object-oriented programming,
Dont ask, but tell (i.e., the Hamiltonian_data knows the details of the other classes
too much), but there is no other choice to dynamically switch on and off pytree_nodes depending
on optimized variational parameters chosen by a user because &#64;dataclass is statistically generated.</p>
<dl class="simple">
<dt>WF parameters related:</dt><dd><ul class="simple">
<li><p>lambda in wavefunction_data.geminal_data (determinant.py)</p></li>
<li><p>jastrow_2b_param in wavefunction_data.jastrow_data.jastrow_two_body_data (jastrow_factor.py)</p></li>
<li><p>j_matrix in wavefunction_data.jastrow_data.jastrow_three_body_data (jastrow_factor.py)</p></li>
</ul>
</dd>
<dt>Atomic positions related:</dt><dd><ul class="simple">
<li><p>positions in hamiltonian_data.structure_data (this file)</p></li>
<li><p>positions in wavefunction_data.geminal_data.mos_data/aos_data.structure_data (molecular_orbital.py/atomic_orbital.py)</p></li>
<li><p>positions in wavefunction_data.jastrow_data.jastrow_three_body_data.mos_data/aos_data.structure_data (jastrow_factor.py)</p></li>
<li><p>positions in Coulomb_potential_data.structure_data (coulomb_potential.py)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data.accumulate_position_grad">
<span class="sig-name descname"><span class="pre">accumulate_position_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_hamiltonian</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data.accumulate_position_grad" title="Link to this definition">#</a></dt>
<dd><p>Aggregate position gradients from Hamiltonian components (structure + wavefunction).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grad_hamiltonian</strong> (<a class="reference internal" href="#jqmc.hamiltonians.Hamiltonian_data" title="jqmc.hamiltonians.Hamiltonian_data"><em>Hamiltonian_data</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data.coulomb_potential_data">
<span class="sig-name descname"><span class="pre">coulomb_potential_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.coulomb_potential.Coulomb_potential_data" title="jqmc.coulomb_potential.Coulomb_potential_data"><span class="pre">Coulomb_potential_data</span></a></span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data.coulomb_potential_data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data.load_from_hdf5">
<span class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">load_from_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jqmc.h5'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data.load_from_hdf5" title="Link to this definition">#</a></dt>
<dd><p>Load Hamiltonian data from an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <em>optional</em>)  file path</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of Hamiltonian_data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jqmc.hamiltonians.Hamiltonian_data" title="jqmc.hamiltonians.Hamiltonian_data">Hamiltonian_data</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data.save_to_hdf5">
<span class="sig-name descname"><span class="pre">save_to_hdf5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jqmc.h5'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data.save_to_hdf5" title="Link to this definition">#</a></dt>
<dd><p>Save Hamiltonian data to an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filepath</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <em>optional</em>)  file path</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data.structure_data">
<span class="sig-name descname"><span class="pre">structure_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><span class="pre">Structure_data</span></a></span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data.structure_data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.hamiltonians.Hamiltonian_data.wavefunction_data">
<span class="sig-name descname"><span class="pre">wavefunction_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><span class="pre">Wavefunction_data</span></a></span><a class="headerlink" href="#jqmc.hamiltonians.Hamiltonian_data.wavefunction_data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.hamiltonians.compute_local_energy">
<span class="sig-prename descclassname"><span class="pre">jqmc.hamiltonians.</span></span><span class="sig-name descname"><span class="pre">compute_local_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.hamiltonians.compute_local_energy" title="Link to this definition">#</a></dt>
<dd><p>Compute Local Energy.</p>
<p>The method is for computing the local energy at (r_up_carts, r_dn_carts).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian_data</strong> (<a class="reference internal" href="#jqmc.hamiltonians.Hamiltonian_data" title="jqmc.hamiltonians.Hamiltonian_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Hamiltonian_data</span></code></a>)  an instance of Hamiltonian_data</p></li>
<li><p><strong>r_up_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jnpt.ArrayLike</span></code>)  Cartesian coordinates of up-spin electrons (dim: N_e^{up}, 3)</p></li>
<li><p><strong>r_dn_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jnpt.ArrayLike</span></code>)  Cartesian coordinates of dn-spin electrons (dim: N_e^{dn}, 3)</p></li>
<li><p><strong>RT</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jnpt.ArrayLike</span></code>)  Rotation matrix. equiv R.T used for non-local part. It does not affect all-electron calculations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of local energy (e_L) with the given wavefunction (float)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.header_footer">
<span id="jqmc-header-footer-module"></span><h2>jqmc.header_footer module<a class="headerlink" href="#module-jqmc.header_footer" title="Link to this heading">#</a></h2>
<p>header and footer modules.</p>
</section>
<section id="module-jqmc.jastrow_factor">
<span id="jqmc-jastrow-factor-module"></span><h2>jqmc.jastrow_factor module<a class="headerlink" href="#module-jqmc.jastrow_factor" title="Link to this heading">#</a></h2>
<p>Jastrow module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">Jastrow_NN_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nn_def</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flat_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treedef</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rbf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_lookup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for NN-based Jastrow factor.</p>
<p>This dataclass stores both the neural network definition and its
parameters, together with helper functions that integrate the NN
Jastrow term into the variational-parameter block machinery.</p>
<p>The intended usage is:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nn_def</span></code> holds a Flax/SchNet-like module (e.g. NNJastrow).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code> holds the corresponding PyTree of parameters.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">flatten_fn</span></code> / <code class="docutils literal notranslate"><span class="pre">unflatten_fn</span></code> convert between the PyTree and a</dt><dd><p>1D parameter vector for SR/MCMC.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>If this dataclass is set to <code class="docutils literal notranslate"><span class="pre">None</span></code> inside <a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Jastrow_data</span></code></a>,</dt><dd><p>the NN contribution is simply turned off. If it is not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
its contribution is evaluated and added on top of the analytic
three-body Jastrow (if present).</p>
</dd>
</dl>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nn_def</strong> (<em>Any</em>)</p></li>
<li><p><strong>params</strong> (<em>Any</em>)</p></li>
<li><p><strong>flat_shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>num_params</strong> (<em>int</em>)</p></li>
<li><p><strong>treedef</strong> (<em>Any</em>)</p></li>
<li><p><strong>shapes</strong> (<em>list</em><em>[</em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>hidden_dim</strong> (<em>int</em>)</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>)</p></li>
<li><p><strong>num_rbf</strong> (<em>int</em>)</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>)</p></li>
<li><p><strong>num_species</strong> (<em>int</em>)</p></li>
<li><p><strong>species_lookup</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>species_values</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>structure_data</strong> (<a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><em>Structure_data</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.0</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.cutoff" title="Link to this definition">#</a></dt>
<dd><p>Radial cutoff for features.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.flat_shape">
<span class="sig-name descname"><span class="pre">flat_shape</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">()</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.flat_shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of flattened params.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.flatten_fn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">flatten_fn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.flatten_fn" title="Link to this definition">#</a></dt>
<dd><p>Return a flatten function built from <code class="docutils literal notranslate"><span class="pre">treedef</span></code>.</p>
<p>This is constructed on each access and is not part of the
serialized state (so it will not cause pickle errors).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.hidden_dim">
<span class="sig-name descname"><span class="pre">hidden_dim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">64</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.hidden_dim" title="Link to this definition">#</a></dt>
<dd><p>Hidden width used in NNJastrow.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.init_from_structure">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">init_from_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rbf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.init_from_structure" title="Link to this definition">#</a></dt>
<dd><p>Initialize NN Jastrow from structure information.</p>
<p>This creates a PauliNet-style NNJastrow module, initializes its
parameters with a dummy electron configuration, and prepares
flatten/unflatten utilities for SR/MCMC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_data</strong> (<a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><em>Structure_data</em></a>)</p></li>
<li><p><strong>hidden_dim</strong> (<em>int</em>)</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>)</p></li>
<li><p><strong>num_rbf</strong> (<em>int</em>)</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_NN_data" title="jqmc.jastrow_factor.Jastrow_NN_data"><em>Jastrow_NN_data</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.nn_def">
<span class="sig-name descname"><span class="pre">nn_def</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.nn_def" title="Link to this definition">#</a></dt>
<dd><p>Flax module definition (e.g., NNJastrow).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.num_layers">
<span class="sig-name descname"><span class="pre">num_layers</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_layers" title="Link to this definition">#</a></dt>
<dd><p>Number of PauliNet blocks.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.num_params">
<span class="sig-name descname"><span class="pre">num_params</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_params" title="Link to this definition">#</a></dt>
<dd><p>Total number of parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.num_rbf">
<span class="sig-name descname"><span class="pre">num_rbf</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">16</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_rbf" title="Link to this definition">#</a></dt>
<dd><p>PhysNet radial basis size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.num_species">
<span class="sig-name descname"><span class="pre">num_species</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_species" title="Link to this definition">#</a></dt>
<dd><p>Count of unique nuclear species.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.params">
<span class="sig-name descname"><span class="pre">params</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.params" title="Link to this definition">#</a></dt>
<dd><p>Parameter PyTree for <code class="docutils literal notranslate"><span class="pre">nn_def</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.shapes">
<span class="sig-name descname"><span class="pre">shapes</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.shapes" title="Link to this definition">#</a></dt>
<dd><p>Per-leaf shapes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.species_lookup">
<span class="sig-name descname"><span class="pre">species_lookup</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(0,)</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.species_lookup" title="Link to this definition">#</a></dt>
<dd><p>Lookup table mapping Z to species ids.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.species_values">
<span class="sig-name descname"><span class="pre">species_values</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.species_values" title="Link to this definition">#</a></dt>
<dd><p>Sorted unique atomic numbers used.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.structure_data">
<span class="sig-name descname"><span class="pre">structure_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><span class="pre">Structure_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.structure_data" title="Link to this definition">#</a></dt>
<dd><p>Structure info required for NN evaluation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.treedef">
<span class="sig-name descname"><span class="pre">treedef</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.treedef" title="Link to this definition">#</a></dt>
<dd><p>PyTree treedef for params.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_NN_data.unflatten_fn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">unflatten_fn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Array</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_NN_data.unflatten_fn" title="Link to this definition">#</a></dt>
<dd><p>Return an unflatten function built from <code class="docutils literal notranslate"><span class="pre">treedef</span></code> and <code class="docutils literal notranslate"><span class="pre">shapes</span></code>.</p>
<p>As with <a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_NN_data.flatten_fn" title="jqmc.jastrow_factor.Jastrow_NN_data.flatten_fn"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flatten_fn()</span></code></a>, this is constructed on each access and
not stored inside the pickled state.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">Jastrow_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_one_body_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jastrow_two_body_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jastrow_three_body_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jastrow_nn_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Jastrow dataclass.</p>
<p>The class contains data for evaluating a Jastrow function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_one_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_one_body_data" title="jqmc.jastrow_factor.Jastrow_one_body_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Jastrow_one_body_data</span></code></a>)  An instance of Jastrow_one_body_data. If None, the one-body Jastrow is turned off.</p></li>
<li><p><strong>jastrow_two_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_two_body_data" title="jqmc.jastrow_factor.Jastrow_two_body_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Jastrow_two_body_data</span></code></a>)  An instance of Jastrow_two_body_data. If None, the two-body Jastrow is turned off.</p></li>
<li><p><strong>jastrow_three_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_three_body_data" title="jqmc.jastrow_factor.Jastrow_three_body_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Jastrow_three_body_data</span></code></a>)  An instance of Jastrow_three_body_data. if None, the three-body Jastrow is turned off.</p></li>
<li><p><strong>jastrow_nn_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Jastrow_NN_data</span> <span class="pre">|</span> <span class="pre">None</span></code>)  Optional container for a NN-based three-body Jastrow term. If None,
the Jastrow NN contribution is turned off.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.accumulate_position_grad">
<span class="sig-name descname"><span class="pre">accumulate_position_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_jastrow</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.accumulate_position_grad" title="Link to this definition">#</a></dt>
<dd><p>Aggregate position gradients from all active Jastrow components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grad_jastrow</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><em>Jastrow_data</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.apply_block_update">
<span class="sig-name descname"><span class="pre">apply_block_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.apply_block_update" title="Link to this definition">#</a></dt>
<dd><p>Apply a single variational-parameter block update to this Jastrow object.</p>
<p>This method is the Jastrow-specific counterpart of
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Wavefunction_data.apply_block_updates()</span></code>.  It receives a generic
<code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalParameterBlock</span></code> whose <code class="docutils literal notranslate"><span class="pre">values</span></code> have already been
updated (typically by <code class="docutils literal notranslate"><span class="pre">block.apply_update</span></code> inside the SR/MCMC driver),
and interprets that block according to Jastrow semantics.</p>
<p>Responsibilities of this method are:</p>
<ul class="simple">
<li><p>Map the block name (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;j1_param&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;j2_param&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;j3_matrix&quot;</span></code>) to the corresponding internal Jastrow field(s).</p></li>
<li><p>Enforce Jastrow-specific structural constraints when copying the
block values into the internal arrays.  In particular, for the
three-body Jastrow term (J3) this includes:</p>
<ul>
<li><p>Handling the case where only the last column is variational and the
rest of the matrix is constrained.</p></li>
<li><p>Handling the fully square J3 matrix case.</p></li>
<li><p>Enforcing the required symmetry of the square J3 block.</p></li>
</ul>
</li>
</ul>
<p>By keeping all J1/J2/J3 interpretation and constraints in this method
(and in the surrounding <code class="docutils literal notranslate"><span class="pre">Jastrow_data</span></code> class), the optimizer and
<code class="xref py py-class docutils literal notranslate"><span class="pre">VariationalParameterBlock</span></code> remain completely structure-agnostic.
To introduce a new Jastrow parameter, extend the block construction
in <code class="docutils literal notranslate"><span class="pre">Wavefunction_data.get_variational_blocks</span></code> and add the
corresponding handling here, without touching the SR/MCMC driver.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>block</strong> (<a class="reference internal" href="#jqmc.wavefunction.VariationalParameterBlock" title="jqmc.wavefunction.VariationalParameterBlock"><em>VariationalParameterBlock</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data">Jastrow_data</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.collect_param_grads">
<span class="sig-name descname"><span class="pre">collect_param_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_jastrow</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.collect_param_grads" title="Link to this definition">#</a></dt>
<dd><p>Collect parameter gradients into a flat dict keyed by block name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grad_jastrow</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><em>Jastrow_data</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, object]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.jastrow_nn_data">
<span class="sig-name descname"><span class="pre">jastrow_nn_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_NN_data" title="jqmc.jastrow_factor.Jastrow_NN_data"><span class="pre">Jastrow_NN_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_nn_data" title="Link to this definition">#</a></dt>
<dd><p>Optional NN-based three-body Jastrow component.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.jastrow_one_body_data">
<span class="sig-name descname"><span class="pre">jastrow_one_body_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_one_body_data" title="jqmc.jastrow_factor.Jastrow_one_body_data"><span class="pre">Jastrow_one_body_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_one_body_data" title="Link to this definition">#</a></dt>
<dd><p>Optional one-body Jastrow component.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.jastrow_three_body_data">
<span class="sig-name descname"><span class="pre">jastrow_three_body_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_three_body_data" title="jqmc.jastrow_factor.Jastrow_three_body_data"><span class="pre">Jastrow_three_body_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_three_body_data" title="Link to this definition">#</a></dt>
<dd><p>Optional analytic three-body Jastrow component.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.jastrow_two_body_data">
<span class="sig-name descname"><span class="pre">jastrow_two_body_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_two_body_data" title="jqmc.jastrow_factor.Jastrow_two_body_data"><span class="pre">Jastrow_two_body_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_two_body_data" title="Link to this definition">#</a></dt>
<dd><p>Optional two-body Jastrow component.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.to_cartesian">
<span class="sig-name descname"><span class="pre">to_cartesian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.to_cartesian" title="Link to this definition">#</a></dt>
<dd><p>Return a copy with the three-body term converted to Cartesian AOs/MOs.</p>
<p>Only the analytic J3 block is transformed; one- and two-body parts are
unchanged. If no three-body data is present, the current instance is
returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><em>Jastrow_data</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_data.to_spherical">
<span class="sig-name descname"><span class="pre">to_spherical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_data.to_spherical" title="Link to this definition">#</a></dt>
<dd><p>Return a copy with the three-body term converted to spherical AOs/MOs.</p>
<p>Only the analytic J3 block is transformed; one- and two-body parts are
unchanged. If no three-body data is present, the current instance is
returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><em>Jastrow_data</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_one_body_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">Jastrow_one_body_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_1b_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_electrons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_one_body_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>One-body Jastrow parameters and structure metadata.</p>
<p>The one-body term models electronnucleus correlations using the
exponential form described in the original docstring. The numerical value
is returned without the <code class="docutils literal notranslate"><span class="pre">exp</span></code> wrapper; callers attach <code class="docutils literal notranslate"><span class="pre">exp(J)</span></code> to the
wavefunction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_1b_param</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)  Parameter controlling the one-body decay.</p></li>
<li><p><strong>structure_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Structure_data</span></code>)  Nuclear positions and charges.</p></li>
<li><p><strong>core_electrons</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[float]</span></code>)  Removed core electrons per nucleus (for ECPs).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_one_body_data.core_electrons">
<span class="sig-name descname"><span class="pre">core_electrons</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_one_body_data.core_electrons" title="Link to this definition">#</a></dt>
<dd><p>Effective core-electron counts aligned with <code class="docutils literal notranslate"><span class="pre">structure_data</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_one_body_data.init_jastrow_one_body_data">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">init_jastrow_one_body_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_1b_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_electrons</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_one_body_data.init_jastrow_one_body_data" title="Link to this definition">#</a></dt>
<dd><p>Initialization.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_one_body_data.jastrow_1b_param">
<span class="sig-name descname"><span class="pre">jastrow_1b_param</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_one_body_data.jastrow_1b_param" title="Link to this definition">#</a></dt>
<dd><p>One-body Jastrow exponent parameter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_one_body_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_one_body_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_one_body_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_one_body_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_one_body_data.structure_data">
<span class="sig-name descname"><span class="pre">structure_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><span class="pre">Structure_data</span></a></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_one_body_data.structure_data" title="Link to this definition">#</a></dt>
<dd><p>Nuclear structure data providing positions and atomic numbers.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">Jastrow_three_body_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Three-body Jastrow parameters and orbital references.</p>
<p>The three-body term uses the original matrix layout (square J3 block plus
last-column J1-like vector). Values are returned without exponentiation;
callers attach <code class="docutils literal notranslate"><span class="pre">exp(J)</span></code> to the wavefunction. All existing functional
details from the prior docstring are preserved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orb_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AOs_sphe_data</span> <span class="pre">|</span> <span class="pre">AOs_cart_data</span> <span class="pre">|</span> <span class="pre">MOs_data</span></code>)  Basis/orbital data used for both spins.</p></li>
<li><p><strong>j_matrix</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">npt.NDArray</span> <span class="pre">|</span> <span class="pre">jax.Array</span></code>)  J matrix with shape <code class="docutils literal notranslate"><span class="pre">(orb_num,</span> <span class="pre">orb_num</span> <span class="pre">+</span> <span class="pre">1)</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.compute_orb_api">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">compute_orb_api</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.compute_orb_api" title="Link to this definition">#</a></dt>
<dd><p>Function for computing AOs or MOs.</p>
<p>The api method to compute AOs or MOs corresponding to instances
stored in self.orb_data</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The api method to compute AOs or MOs.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Callable</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong>  If the instances of orb_data is neither AOs_data nor MOs_data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.init_jastrow_three_body_data">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">init_jastrow_three_body_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.init_jastrow_three_body_data" title="Link to this definition">#</a></dt>
<dd><p>Initialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orb_data</strong> (<a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><em>AOs_sphe_data</em></a><em> | </em><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><em>AOs_cart_data</em></a><em> | </em><a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><em>MOs_data</em></a>)  Orbital container (AOs or MOs) used to size the J-matrix.</p></li>
<li><p><strong>random_init</strong> (<em>bool</em>)  If True, initialize with small random values instead of zeros (for tests).</p></li>
<li><p><strong>random_scale</strong> (<em>float</em>)  Upper bound of uniform sampler when random_init is True (default 0.01).</p></li>
<li><p><strong>seed</strong> (<em>int</em><em> | </em><em>None</em>)  Optional seed for deterministic initialization when random_init is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.j_matrix">
<span class="sig-name descname"><span class="pre">j_matrix</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.j_matrix" title="Link to this definition">#</a></dt>
<dd><p>J3/J1 matrix; square block plus final column.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.orb_data">
<span class="sig-name descname"><span class="pre">orb_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><span class="pre">AOs_sphe_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><span class="pre">AOs_cart_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><span class="pre">MOs_data</span></a></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.orb_data" title="Link to this definition">#</a></dt>
<dd><p>Orbital basis (AOs or MOs) shared across spins.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.orb_num">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">orb_num</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.orb_num" title="Link to this definition">#</a></dt>
<dd><p>Get number of atomic orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>get number of atomic orbitals.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.to_cartesian">
<span class="sig-name descname"><span class="pre">to_cartesian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.to_cartesian" title="Link to this definition">#</a></dt>
<dd><p>Convert spherical orbitals to Cartesian and transform the J-matrix.</p>
<p>If the underlying orbitals are MOs, defer to <code class="docutils literal notranslate"><span class="pre">MOs_data.to_cartesian</span></code>
(the J-matrix size is unchanged). For Cartesian inputs, return self.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_three_body_data" title="jqmc.jastrow_factor.Jastrow_three_body_data"><em>Jastrow_three_body_data</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_three_body_data.to_spherical">
<span class="sig-name descname"><span class="pre">to_spherical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_three_body_data.to_spherical" title="Link to this definition">#</a></dt>
<dd><p>Convert Cartesian orbitals to spherical and transform the J-matrix.</p>
<p>If the underlying orbitals are MOs, defer to <code class="docutils literal notranslate"><span class="pre">MOs_data.to_spherical</span></code>
(the J-matrix size is unchanged). For spherical inputs, return self.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_three_body_data" title="jqmc.jastrow_factor.Jastrow_three_body_data"><em>Jastrow_three_body_data</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_two_body_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">Jastrow_two_body_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_2b_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_two_body_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Two-body Jastrow parameter container.</p>
<p>The two-body term uses the Pade functional form described in the existing
docstrings. Values are returned without exponentiation; callers use
<code class="docutils literal notranslate"><span class="pre">exp(J)</span></code> when constructing the wavefunction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>jastrow_2b_param</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)  Parameter for the two-body Jastrow part.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_two_body_data.init_jastrow_two_body_data">
<span class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">init_jastrow_two_body_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_2b_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_two_body_data.init_jastrow_two_body_data" title="Link to this definition">#</a></dt>
<dd><p>Initialization.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_two_body_data.jastrow_2b_param">
<span class="sig-name descname"><span class="pre">jastrow_2b_param</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_two_body_data.jastrow_2b_param" title="Link to this definition">#</a></dt>
<dd><p>Pade <code class="docutils literal notranslate"><span class="pre">a</span></code> parameter for J2.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_two_body_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_two_body_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.Jastrow_two_body_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.Jastrow_two_body_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">NNJastrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_rbf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_lookup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>PauliNet-inspired NN that outputs a three-body Jastrow correction.</p>
<p>The network implements the iteration rules described in the PauliNet
manuscript (Eq. 12). Electron embeddings <span class="math notranslate nohighlight">\(\mathbf{x}_i^{(n)}\)</span> are
iteratively refined by three message channels:</p>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">(+</span> <span class="pre">)</span></code>: same-spin electrons, enforcing antisymmetry indirectly by keeping</dt><dd><p>the messages exchange-equivariant.</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">(-</span> <span class="pre">)</span></code>: opposite-spin electrons, capturing pairing terms.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(n)</span></code>: nuclei, represented by fixed species embeddings.</p></li>
</ul>
<p>After <code class="docutils literal notranslate"><span class="pre">num_layers</span></code> iterations the final electron embeddings are summed and
fed through <span class="math notranslate nohighlight">\(\eta_\theta\)</span> to produce a symmetric correction that is
added on top of the analytic three-body Jastrow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_dim</strong> (<em>int</em>)</p></li>
<li><p><strong>num_layers</strong> (<em>int</em>)</p></li>
<li><p><strong>num_rbf</strong> (<em>int</em>)</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>)</p></li>
<li><p><strong>species_lookup</strong> (<em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>int32</em><em>]</em><em>] </em><em>| </em><em>Array</em><em> | </em><em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>num_species</strong> (<em>int</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>parent</strong> (<em>Module</em><em> | </em><em>Scope</em><em> | </em><em>_Sentinel</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PauliNetBlock">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">PauliNetBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Single PauliNet message-passing iteration following Eq. (1).</p>
<p>Each block mixes three message channels per electron: same-spin <code class="docutils literal notranslate"><span class="pre">(+</span> <span class="pre">)</span></code>,
opposite-spin <code class="docutils literal notranslate"><span class="pre">(-</span> <span class="pre">)</span></code>, and nucleus-electron <code class="docutils literal notranslate"><span class="pre">(n)</span></code>. The sender network
is shared across channels to match the PauliNet weight-tying scheme, while
separate weighting/receiver networks parameterize the contribution of every
channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_dim</strong> (<em>int</em>)</p></li>
<li><p><strong>parent</strong> (<em>Module</em><em> | </em><em>Scope</em><em> | </em><em>_Sentinel</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PauliNetBlock.hidden_dim">
<span class="sig-name descname"><span class="pre">hidden_dim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.hidden_dim" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PauliNetBlock.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.name" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PauliNetBlock.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.parent" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PauliNetBlock.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.scope" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PauliNetBlock.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.setup" title="Link to this definition">#</a></dt>
<dd><p>Instantiate the shared sender/receiver networks for this block.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">PhysNetRadialLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_rbf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Cuspless PhysNet-inspired radial features <span class="math notranslate nohighlight">\(e_k(r)\)</span>.</p>
<p>The basis follows Eq. (3) in the PauliNet supplement with a PhysNet-style
envelope that forces both the value and the derivative of each Gaussian
to vanish at the cutoff and the origin.  These features are reused across
all message channels, ensuring consistent geometric encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_rbf</strong> (<em>int</em>)</p></li>
<li><p><strong>cutoff</strong> (<em>float</em>)</p></li>
<li><p><strong>parent</strong> (<em>Module</em><em> | </em><em>Scope</em><em> | </em><em>_Sentinel</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.cutoff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.name" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.num_rbf">
<span class="sig-name descname"><span class="pre">num_rbf</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.num_rbf" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.parent" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.scope" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.TwoLayerMLP">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">TwoLayerMLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;flax.linen.module._Sentinel</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
<p>Utility MLP used for <span class="math notranslate nohighlight">\(w_\theta\)</span>, <span class="math notranslate nohighlight">\(h_\theta\)</span>, <span class="math notranslate nohighlight">\(g_\theta\)</span>, and <span class="math notranslate nohighlight">\(\eta_\theta\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> (<em>int</em>)</p></li>
<li><p><strong>out_dim</strong> (<em>int</em>)</p></li>
<li><p><strong>parent</strong> (<em>Module</em><em> | </em><em>Scope</em><em> | </em><em>_Sentinel</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>name</strong> (<em>str</em><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.name" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.out_dim">
<span class="sig-name descname"><span class="pre">out_dim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.out_dim" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.parent" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.scope" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.width">
<span class="sig-name descname"><span class="pre">width</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.width" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5.0</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.cutoff" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.hidden_dim">
<span class="sig-name descname"><span class="pre">hidden_dim</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">64</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.hidden_dim" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.name" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.num_layers">
<span class="sig-name descname"><span class="pre">num_layers</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.num_layers" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.num_rbf">
<span class="sig-name descname"><span class="pre">num_rbf</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">32</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.num_rbf" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.num_species">
<span class="sig-name descname"><span class="pre">num_species</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.num_species" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.parent">
<span class="sig-name descname"><span class="pre">parent</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Module</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_Sentinel</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.parent" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.scope">
<span class="sig-name descname"><span class="pre">scope</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Scope</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.scope" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.setup" title="Link to this definition">#</a></dt>
<dd><p>Instantiate PauliNet components and validate required metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If <code class="docutils literal notranslate"><span class="pre">species_lookup</span></code> or <code class="docutils literal notranslate"><span class="pre">num_species</span></code> were not provided via
    the host dataclass before module initialization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.NNJastrow.species_lookup">
<span class="sig-name descname"><span class="pre">species_lookup</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">int32</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#jqmc.jastrow_factor.NNJastrow.species_lookup" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.compute_Jastrow_one_body">
<span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">compute_Jastrow_one_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_one_body_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.compute_Jastrow_one_body" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the one-body Jastrow $J_1$ (without <code class="docutils literal notranslate"><span class="pre">exp</span></code>) for given coordinates.</p>
<p>The original exponential form and usage remain unchanged: this routine
returns the scalar <code class="docutils literal notranslate"><span class="pre">J</span></code> value; callers attach <code class="docutils literal notranslate"><span class="pre">exp(J)</span></code> to the wavefunction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_one_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_one_body_data" title="jqmc.jastrow_factor.Jastrow_one_body_data"><em>Jastrow_one_body_data</em></a>)  One-body Jastrow parameters and structure data.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Spin-up electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Spin-down electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One-body Jastrow value (before exponentiation).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.compute_Jastrow_part">
<span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">compute_Jastrow_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.compute_Jastrow_part" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the total Jastrow <code class="docutils literal notranslate"><span class="pre">J</span> <span class="pre">=</span> <span class="pre">J1</span> <span class="pre">+</span> <span class="pre">J2</span> <span class="pre">+</span> <span class="pre">J3</span></code> (without exponentiation).</p>
<p>This preserves the original behavior: the returned scalar <code class="docutils literal notranslate"><span class="pre">J</span></code> excludes
the <code class="docutils literal notranslate"><span class="pre">exp</span></code> factor; callers apply <code class="docutils literal notranslate"><span class="pre">exp(J)</span></code> to the wavefunction. Both the
analytic three-body and optional NN three-body contributions are included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><em>Jastrow_data</em></a>)  Collection of active Jastrow components (J1/J2/J3/NN).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Spin-up electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Spin-down electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total Jastrow value before exponentiation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.compute_Jastrow_three_body">
<span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">compute_Jastrow_three_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_three_body_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.compute_Jastrow_three_body" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the three-body Jastrow $J_3$ (analytic) without exponentiation.</p>
<p>This preserves the original functional form: the square J3 block couples
electron pairs and the last column acts as a J1-like vector. Returned value
is <code class="docutils literal notranslate"><span class="pre">J</span></code>; attach <code class="docutils literal notranslate"><span class="pre">exp(J)</span></code> externally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_three_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_three_body_data" title="jqmc.jastrow_factor.Jastrow_three_body_data"><em>Jastrow_three_body_data</em></a>)  Three-body Jastrow parameters and orbitals.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Spin-up electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Spin-down electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Three-body Jastrow value (before exponentiation).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.compute_Jastrow_two_body">
<span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">compute_Jastrow_two_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_two_body_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.compute_Jastrow_two_body" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the two-body Jastrow $J_2$ (Pade form) without exponentiation.</p>
<p>The functional form and usage remain identical to the original docstring;
this returns <code class="docutils literal notranslate"><span class="pre">J</span></code> and callers attach <code class="docutils literal notranslate"><span class="pre">exp(J)</span></code> to the wavefunction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_two_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_two_body_data" title="jqmc.jastrow_factor.Jastrow_two_body_data"><em>Jastrow_two_body_data</em></a>)  Two-body Jastrow parameter container.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Spin-up electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Spin-down electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Two-body Jastrow value (before exponentiation).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_one_body">
<span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">compute_grads_and_laplacian_Jastrow_one_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_one_body_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_one_body" title="Link to this definition">#</a></dt>
<dd><p>Analytic gradients and per-electron Laplacians for the one-body Jastrow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_one_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_one_body_data" title="jqmc.jastrow_factor.Jastrow_one_body_data"><em>Jastrow_one_body_data</em></a>)  One-body Jastrow parameters and structure data.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Spin-up electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Spin-down electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradients for up/down electrons with shapes <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>,
Laplacians for up/down electrons with shapes <code class="docutils literal notranslate"><span class="pre">(N_up,)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_part">
<span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">compute_grads_and_laplacian_Jastrow_part</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_part" title="Link to this definition">#</a></dt>
<dd><p>Per-electron gradients and Laplacians of the full Jastrow $J$.</p>
<p>Analytic paths are used for J1/J2/J3 when available; the NN three-body
term (if present) is handled via autodiff. Values are returned per electron
(not summed) to match downstream kinetic-energy estimators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><em>Jastrow_data</em></a>)  Active Jastrow components.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Spin-up electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Spin-down electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradients for up/down electrons with shapes <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>
and Laplacians for up/down electrons with shapes <code class="docutils literal notranslate"><span class="pre">(N_up,)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_three_body">
<span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">compute_grads_and_laplacian_Jastrow_three_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_three_body_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_three_body" title="Link to this definition">#</a></dt>
<dd><p>Analytic gradients and Laplacians for the three-body Jastrow.</p>
<p>The functional form is unchanged; this routine leverages analytic AO/MO
gradients and Laplacians. Per-electron derivatives are returned (not
summed), matching kinetic-energy estimator expectations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_three_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_three_body_data" title="jqmc.jastrow_factor.Jastrow_three_body_data"><em>Jastrow_three_body_data</em></a>)  Three-body Jastrow parameters and orbitals.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Spin-up electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Spin-down electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradients for up/down electrons with shapes <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>,
Laplacians for up/down electrons with shapes <code class="docutils literal notranslate"><span class="pre">(N_up,)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_two_body">
<span class="sig-prename descclassname"><span class="pre">jqmc.jastrow_factor.</span></span><span class="sig-name descname"><span class="pre">compute_grads_and_laplacian_Jastrow_two_body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_two_body_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_two_body" title="Link to this definition">#</a></dt>
<dd><p>Analytic gradients and Laplacians for the Pade two-body Jastrow.</p>
<p>Uses the unchanged functional form <code class="docutils literal notranslate"><span class="pre">J2(r)</span> <span class="pre">=</span> <span class="pre">r</span> <span class="pre">/</span> <span class="pre">(2</span> <span class="pre">*</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">a</span> <span class="pre">r))</span></code> with
<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">jastrow_2b_param</span></code>. Returns per-electron quantities (not summed).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_two_body_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_two_body_data" title="jqmc.jastrow_factor.Jastrow_two_body_data"><em>Jastrow_two_body_data</em></a>)  Two-body Jastrow parameter container.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Spin-up electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Spin-down electron coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradients for up/down electrons with shapes <code class="docutils literal notranslate"><span class="pre">(N_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,</span> <span class="pre">3)</span></code>,
Laplacians for up/down electrons with shapes <code class="docutils literal notranslate"><span class="pre">(N_up,)</span></code> and <code class="docutils literal notranslate"><span class="pre">(N_dn,)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[jax.Array, jax.Array, jax.Array, jax.Array]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.jqmc_cli">
<span id="jqmc-jqmc-cli-module"></span><h2>jqmc.jqmc_cli module<a class="headerlink" href="#module-jqmc.jqmc_cli" title="Link to this heading">#</a></h2>
<p>command-line module.</p>
</section>
<section id="module-jqmc.jqmc_gfmc">
<span id="jqmc-jqmc-gfmc-module"></span><h2>jqmc.jqmc_gfmc module<a class="headerlink" href="#module-jqmc.jqmc_gfmc" title="Link to this heading">#</a></h2>
<p>QMC module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_gfmc.</span></span><span class="sig-name descname"><span class="pre">GFMC_n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_walkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_per_measurement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfmc_collect_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcmc_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">34467</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_scf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_discretized_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_local_move</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmove'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comput_position_deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>GFMC class. Runing GFMC with multiple walkers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Hamiltonian_data</span></code>)  an instance of Hamiltonian_data</p></li>
<li><p><strong>num_walkers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of walkers</p></li>
<li><p><strong>mcmc_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  seed for the MCMC chain.</p></li>
<li><p><strong>E_scf</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)  Self-consistent E (Hartree)</p></li>
<li><p><strong>alat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)  discretized grid length (bohr)</p></li>
<li><p><strong>random_discretized_mesh</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>)  Flag for the random discretization mesh in the kinetic part and the non-local part of ECPs.
Valid both for all-electron and ECP calculations.</p></li>
<li><p><strong>non_local_move</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>)  treatment of the spin-flip term. tmove (Casulas T-move) or dtmove (Determinant Locality Approximation with Casulas T-move)
Valid only for ECP calculations. Do not specify this value for all-electron calculations.</p></li>
<li><p><strong>comput_position_deriv</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>)  if True, compute the derivatives of E wrt. atomic positions.</p></li>
<li><p><strong>num_mcmc_per_measurement</strong> (<em>int</em>)</p></li>
<li><p><strong>num_gfmc_collect_steps</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.alat">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">alat</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.alat" title="Link to this definition">#</a></dt>
<dd><p>Return alat.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.bare_w_L">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">bare_w_L</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.bare_w_L" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored weight array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.comput_position_deriv">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">comput_position_deriv</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.comput_position_deriv" title="Link to this definition">#</a></dt>
<dd><p>Return the flag for computing the derivatives of E wrt. atomic positions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.de_L_dR">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">de_L_dR</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dR" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored de_L/dR array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.de_L_dr_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">de_L_dr_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dr_dn" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1, num_electrons_dn, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored de_L/dr_dn array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.de_L_dr_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">de_L_dr_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dr_up" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1, num_electrons_up, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored de_L/dr_up array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dR">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">dln_Psi_dR</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dR" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1, num_atoms, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dln_Psi/dR array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dr_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">dln_Psi_dr_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dr_dn" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1, num_electrons_dn, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dln_Psi/dr_down array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dr_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">dln_Psi_dr_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dr_up" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1, num_electrons_up, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dln_Psi/dr_up array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.domega_dr_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">domega_dr_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.domega_dr_dn" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1, num_electons_dn, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dOmega/dr_dn array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.domega_dr_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">domega_dr_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.domega_dr_up" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1, num_electons_dn, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dOmega/dr_up array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.e_L">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">e_L</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.e_L" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored e_L array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.e_L2">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">e_L2</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.e_L2" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored e_L^2 array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.get_E">
<span class="sig-name descname"><span class="pre">get_E</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_bin_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.get_E" title="Link to this definition">#</a></dt>
<dd><p>Return the mean and std of the computed local energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mcmc_warmup_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of warmup steps.</p></li>
<li><p><strong>num_mcmc_bin_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of binning blocks</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean and std values of the totat energy and those of the variance
estimated by the Jackknife method with the Args. (E_mean, E_std, Var_mean, Var_std).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float, float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.get_aF">
<span class="sig-name descname"><span class="pre">get_aF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_bin_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.get_aF" title="Link to this definition">#</a></dt>
<dd><p>Return the mean and std of the computed atomic forces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mcmc_warmup_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of warmup steps.</p></li>
<li><p><strong>num_mcmc_bin_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of binning blocks</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean and std values of the computed atomic forces
estimated by the Jackknife method with the Args.
The dimention of the arrays is (N, 3).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[npt.NDArray, npt.NDArray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.hamiltonian_data">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">hamiltonian_data</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.hamiltonian_data" title="Link to this definition">#</a></dt>
<dd><p>Return hamiltonian_data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.mcmc_counter">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">mcmc_counter</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.mcmc_counter" title="Link to this definition">#</a></dt>
<dd><p>Return current MCMC counter.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.num_gfmc_collect_steps">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">num_gfmc_collect_steps</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.num_gfmc_collect_steps" title="Link to this definition">#</a></dt>
<dd><p>Return num_gfmc_collect_steps.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.num_walkers">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">num_walkers</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.num_walkers" title="Link to this definition">#</a></dt>
<dd><p>The number of walkers.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.omega_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">omega_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.omega_dn" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter,1, num_atoms, num_electons_dn).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored Omega (for down electrons) array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.omega_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">omega_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.omega_up" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1, num_atoms, num_electrons_up).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored Omega (for up electrons) array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">86400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.run" title="Link to this definition">#</a></dt>
<dd><p>Run LRDMC with multiple walkers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_branching</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  number of branching (reconfiguration of walkers).</p></li>
<li><p><strong>max_time</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  maximum time in sec.</p></li>
<li><p><strong>num_mcmc_steps</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_n.w_L">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">w_L</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_n.w_L" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored weight array. dim</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_gfmc.</span></span><span class="sig-name descname"><span class="pre">GFMC_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_walkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfmc_collect_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcmc_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">34467</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_discretized_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">non_local_move</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmove'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>GFMC class.</p>
<p>GFMC class. Runing GFMC.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Hamiltonian_data</span></code>)  an instance of Hamiltonian_data</p></li>
<li><p><strong>num_walkers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of walkers</p></li>
<li><p><strong>num_gfmc_collect_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of steps to collect the GFMC data</p></li>
<li><p><strong>mcmc_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  seed for the MCMC chain.</p></li>
<li><p><strong>tau</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)  projection time (bohr^-1)</p></li>
<li><p><strong>alat</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>)  discretized grid length (bohr)</p></li>
<li><p><strong>random_discretized_mesh</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>)  Flag for the random discretization mesh in the kinetic part and in the non-local part of ECPs.
Valid both for all-electron and ECP calculations.</p></li>
<li><p><strong>non_local_move</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>)  treatment of the spin-flip term. tmove (Casulas T-move) or dtmove (Determinant Locality Approximation with Casulas T-move)
Valid only for ECP calculations. All-electron calculations, do not specify this value.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.alat">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">alat</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.alat" title="Link to this definition">#</a></dt>
<dd><p>Return alat.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.bare_w_L">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">bare_w_L</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.bare_w_L" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored weight array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.e_L">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">e_L</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.e_L" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored e_L array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.e_L2">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">e_L2</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.e_L2" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored e_L2 array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.get_E">
<span class="sig-name descname"><span class="pre">get_E</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_bin_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.get_E" title="Link to this definition">#</a></dt>
<dd><p>Return the mean and std of the computed local energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mcmc_warmup_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of warmup steps.</p></li>
<li><p><strong>num_mcmc_bin_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  the number of binning blocks</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean and std values of the totat energy and those of the variance
estimated by the Jackknife method with the Args. (E_mean, E_std, Var_mean, Var_std).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float, float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.hamiltonian_data">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">hamiltonian_data</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.hamiltonian_data" title="Link to this definition">#</a></dt>
<dd><p>Return hamiltonian_data.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.mcmc_counter">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">mcmc_counter</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.mcmc_counter" title="Link to this definition">#</a></dt>
<dd><p>Return current MCMC counter.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.num_gfmc_collect_steps">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">num_gfmc_collect_steps</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.num_gfmc_collect_steps" title="Link to this definition">#</a></dt>
<dd><p>Return num_gfmc_collect_steps.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.num_walkers">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">num_walkers</span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.num_walkers" title="Link to this definition">#</a></dt>
<dd><p>The number of walkers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">86400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.run" title="Link to this definition">#</a></dt>
<dd><p>Run LRDMC with multiple walkers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_branching</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  number of branching (reconfiguration of walkers).</p></li>
<li><p><strong>max_time</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  maximum time in sec.</p></li>
<li><p><strong>num_mcmc_steps</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_gfmc.GFMC_t.w_L">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">w_L</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_gfmc.GFMC_t.w_L" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored weight array. dim</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-jqmc.jqmc_mcmc">
<span id="jqmc-jqmc-mcmc-module"></span><h2>jqmc.jqmc_mcmc module<a class="headerlink" href="#module-jqmc.jqmc_mcmc" title="Link to this heading">#</a></h2>
<p>QMC module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_mcmc.</span></span><span class="sig-name descname"><span class="pre">MCMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mcmc_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">34467</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_walkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_per_measurement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_AS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comput_param_deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comput_position_deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_discretized_mesh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Production VMC/MCMC driver with multiple walkers.</p>
<p>This class drives MetropolisHastings sampling for many independent walkers in parallel
(vectorized with <code class="docutils literal notranslate"><span class="pre">jax.vmap</span></code>) and stores all observables needed by downstream analysis
and optimization. All public methods are part of the supported API; private helpers are
internal and subject to change.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian_data</strong> (<a class="reference internal" href="#jqmc.hamiltonians.Hamiltonian_data" title="jqmc.hamiltonians.Hamiltonian_data"><em>Hamiltonian_data</em></a>)</p></li>
<li><p><strong>mcmc_seed</strong> (<em>int</em>)</p></li>
<li><p><strong>num_walkers</strong> (<em>int</em>)</p></li>
<li><p><strong>num_mcmc_per_measurement</strong> (<em>int</em>)</p></li>
<li><p><strong>Dt</strong> (<em>float</em>)</p></li>
<li><p><strong>epsilon_AS</strong> (<em>float</em>)</p></li>
<li><p><strong>comput_param_deriv</strong> (<em>bool</em>)</p></li>
<li><p><strong>comput_position_deriv</strong> (<em>bool</em>)</p></li>
<li><p><strong>random_discretized_mesh</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.comput_param_deriv">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">comput_param_deriv</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.comput_param_deriv" title="Link to this definition">#</a></dt>
<dd><p>Return the flag for computing the derivatives of E wrt. variational parameters.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.comput_position_deriv">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">comput_position_deriv</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.comput_position_deriv" title="Link to this definition">#</a></dt>
<dd><p>Return the flag for computing the derivatives of E wrt. atomic positions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.de_L_dR">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">de_L_dR</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.de_L_dR" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored de_L/dR array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.de_L_dr_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">de_L_dr_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.de_L_dr_dn" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_electrons_dn, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored de_L/dr_dn array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.de_L_dr_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">de_L_dr_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.de_L_dr_up" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_electrons_up, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored de_L/dr_up array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.dln_Psi_dR">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">dln_Psi_dR</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dR" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_atoms, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dln_Psi/dR array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.dln_Psi_dc">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">dln_Psi_dc</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dc" title="Link to this definition">#</a></dt>
<dd><p>Return stored parameter gradients keyed by block name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.dln_Psi_dr_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">dln_Psi_dr_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dr_dn" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_electrons_dn, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dln_Psi/dr_down array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.dln_Psi_dr_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">dln_Psi_dr_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dr_up" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_electrons_up, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dln_Psi/dr_up array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.domega_dr_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">domega_dr_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.domega_dr_dn" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_electons_dn, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dOmega/dr_dn array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.domega_dr_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">domega_dr_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.domega_dr_up" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_electons_dn, 3).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored dOmega/dr_up array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.e_L">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">e_L</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.e_L" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored e_L array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.e_L2">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">e_L2</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.e_L2" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored e_L^2 array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.get_E">
<span class="sig-name descname"><span class="pre">get_E</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_bin_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.get_E" title="Link to this definition">#</a></dt>
<dd><p>Estimate total energy and variance with jackknife error bars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mcmc_warmup_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Samples to discard as warmup. Defaults to 50.</p></li>
<li><p><strong>num_mcmc_bin_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Number of jackknife blocks. Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">(E_mean,</span> <span class="pre">E_std,</span> <span class="pre">Var_mean,</span> <span class="pre">Var_std)</span></code> aggregated across MPI ranks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[float, float, float, float]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong>  If there are insufficient post-warmup samples to form the requested blocks.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Warns when warmup or block counts fall below <code class="docutils literal notranslate"><span class="pre">MCMC_MIN_WARMUP_STEPS</span></code> / <code class="docutils literal notranslate"><span class="pre">MCMC_MIN_BIN_BLOCKS</span></code>. All reductions are MPI-aware.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.get_aF">
<span class="sig-name descname"><span class="pre">get_aF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_bin_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.get_aF" title="Link to this definition">#</a></dt>
<dd><p>Compute HellmannFeynman + Pulay forces with jackknife statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mcmc_warmup_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Samples to drop for warmup. Defaults to 50.</p></li>
<li><p><strong>num_mcmc_bin_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Number of jackknife blocks. Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">(force_mean,</span> <span class="pre">force_std)</span></code> shaped <code class="docutils literal notranslate"><span class="pre">(num_atoms,</span> <span class="pre">3)</span></code> in Hartree/bohr.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[npt.NDArray, npt.NDArray]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses stored per-walker weights, energies, wavefunction gradients, and SWCT terms accumulated during <a class="reference internal" href="#jqmc.jqmc_mcmc.MCMC.run" title="jqmc.jqmc_mcmc.MCMC.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a>; reductions are MPI-aware.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.get_dln_WF">
<span class="sig-name descname"><span class="pre">get_dln_WF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chosen_param_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.get_dln_WF" title="Link to this definition">#</a></dt>
<dd><p>Assemble per-sample derivatives of ln Psi w.r.t. variational parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[VariationalParameterBlock]</span></code>)  Ordered variational blocks used for concatenation.</p></li>
<li><p><strong>num_mcmc_warmup_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Samples to discard as warmup. Defaults to 50.</p></li>
<li><p><strong>chosen_param_index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span></code>, <em>optional</em>)  Optional subset of flattened indices; <code class="docutils literal notranslate"><span class="pre">None</span></code> keeps all. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">O_matrix</span></code> with shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">num_walkers,</span> <span class="pre">K)</span></code> after warmup, where <code class="docutils literal notranslate"><span class="pre">K</span></code> follows the provided blocks (or subset).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Validates the concatenated gradient size against block metadata and uses gradients stored during <a class="reference internal" href="#jqmc.jqmc_mcmc.MCMC.run" title="jqmc.jqmc_mcmc.MCMC.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.get_gF">
<span class="sig-name descname"><span class="pre">get_gF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_bin_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chosen_param_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.get_gF" title="Link to this definition">#</a></dt>
<dd><p>Evaluate generalized forces (dE/dc_k) with jackknife error bars.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mcmc_warmup_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Samples to discard as warmup. Defaults to 50.</p></li>
<li><p><strong>num_mcmc_bin_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Number of jackknife blocks. Defaults to 10.</p></li>
<li><p><strong>chosen_param_index</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span></code>, <em>optional</em>)  Optional subset of flattened indices. Defaults to None.</p></li>
<li><p><strong>blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span> <span class="pre">|</span> <span class="pre">None</span></code>, <em>optional</em>)  Variational blocks for parameter ordering; defaults to current wavefunction blocks.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">(generalized_force_mean,</span> <span class="pre">generalized_force_std)</span></code> as 1D vectors of length <code class="docutils literal notranslate"><span class="pre">L</span></code> after any filtering.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[npt.NDArray, npt.NDArray]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Reuses <a class="reference internal" href="#jqmc.jqmc_mcmc.MCMC.get_dln_WF" title="jqmc.jqmc_mcmc.MCMC.get_dln_WF"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_dln_WF()</span></code></a> after warmup and applies jackknife statistics across MPI ranks.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.hamiltonian_data">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">hamiltonian_data</span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.hamiltonian_data" title="Link to this definition">#</a></dt>
<dd><p>Access the mutable <code class="xref py py-class docutils literal notranslate"><span class="pre">Hamiltonian_data</span></code> backing this sampler.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.mcmc_counter">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">mcmc_counter</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.mcmc_counter" title="Link to this definition">#</a></dt>
<dd><p>Number of Metropolis steps accumulated (rows in stored observables).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.num_walkers">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">num_walkers</span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.num_walkers" title="Link to this definition">#</a></dt>
<dd><p>The number of walkers.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.omega_dn">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">omega_dn</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.omega_dn" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_atoms, num_electons_dn).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored Omega (for down electrons) array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.omega_up">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">omega_up</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.omega_up" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers, num_atoms, num_electrons_up).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored Omega (for up electrons) array. dim</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">86400</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.run" title="Link to this definition">#</a></dt>
<dd><p>Execute MetropolisHastings sampling for all walkers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mcmc_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Metropolis updates per walker; values &lt;= 0 are no-ops. Defaults to 0.</p></li>
<li><p><strong>max_time</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Wall-clock budget in seconds. Defaults to 86400.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Creates <code class="docutils literal notranslate"><span class="pre">external_control_mcmc.toml</span></code> to allow external stop requests.</p></li>
<li><p>Accumulates energies, weights, forces, and wavefunction gradients into public buffers (<code class="docutils literal notranslate"><span class="pre">w_L</span></code>, <code class="docutils literal notranslate"><span class="pre">e_L</span></code>, <code class="docutils literal notranslate"><span class="pre">dln_Psi_*</span></code> etc.).</p></li>
<li><p>Logs timing statistics and acceptance ratios at the end of the run.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.run_optimize">
<span class="sig-name descname"><span class="pre">run_optimize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mcmc_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_opt_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf_dump_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">86400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_bin_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_J1_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_J2_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_J3_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_JNN_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_lambda_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_param_opt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.run_optimize" title="Link to this definition">#</a></dt>
<dd><p>Optimize wavefunction parameters using SR or optax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mcmc_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  MCMC samples per walker per iteration. Defaults to 100.</p></li>
<li><p><strong>num_opt_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Number of optimization iterations. Defaults to 1.</p></li>
<li><p><strong>wf_dump_freq</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Dump frequency for <code class="docutils literal notranslate"><span class="pre">hamiltonian_data.chk</span></code>. Defaults to 10.</p></li>
<li><p><strong>max_time</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Per-iteration MCMC wall-clock budget (sec). Defaults to 86400.</p></li>
<li><p><strong>num_mcmc_warmup_steps</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Warmup samples discarded each iteration. Defaults to 0.</p></li>
<li><p><strong>num_mcmc_bin_blocks</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Jackknife bins for statistics. Defaults to 100.</p></li>
<li><p><strong>opt_J1_param</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>)  Optimize one-body Jastrow. Defaults to True.</p></li>
<li><p><strong>opt_J2_param</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>)  Optimize two-body Jastrow. Defaults to True.</p></li>
<li><p><strong>opt_J3_param</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>)  Optimize three-body Jastrow. Defaults to True.</p></li>
<li><p><strong>opt_JNN_param</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>)  Optimize NN Jastrow. Defaults to True.</p></li>
<li><p><strong>opt_lambda_param</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>)  Optimize determinant lambda matrix. Defaults to False.</p></li>
<li><p><strong>num_param_opt</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <em>optional</em>)  Limit parameters updated (ranked by <code class="docutils literal notranslate"><span class="pre">|f|/|std</span> <span class="pre">f|</span></code>); <code class="docutils literal notranslate"><span class="pre">0</span></code> means all. Defaults to 0.</p></li>
<li><p><strong>optimizer_kwargs</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span> <span class="pre">|</span> <span class="pre">None</span></code>, <em>optional</em>)  Optimizer configuration. <code class="docutils literal notranslate"><span class="pre">method='sr'</span></code> uses SR keys (<code class="docutils literal notranslate"><span class="pre">delta</span></code>, <code class="docutils literal notranslate"><span class="pre">epsilon</span></code>, <code class="docutils literal notranslate"><span class="pre">cg_flag</span></code>, <code class="docutils literal notranslate"><span class="pre">cg_max_iter</span></code>, <code class="docutils literal notranslate"><span class="pre">cg_tol</span></code>); other <code class="docutils literal notranslate"><span class="pre">method</span></code> names are optax constructors (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;adam&quot;</span></code>) and receive remaining keys.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Persists optax optimizer state across calls when method and hyperparameters match.</p></li>
<li><p>Writes <code class="docutils literal notranslate"><span class="pre">external_control_opt.toml</span></code> to allow external stop requests.</p></li>
<li><p>Updates <code class="xref py py-class docutils literal notranslate"><span class="pre">Hamiltonian_data</span></code> in-place and increments the optimization counter.</p></li>
</ul>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.jqmc_mcmc.MCMC.w_L">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">w_L</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.jqmc_mcmc.MCMC.w_L" title="Link to this definition">#</a></dt>
<dd><p>(mcmc_counter, num_walkers).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the stored weight array. dim</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-jqmc.jqmc_miscs">
<span id="jqmc-jqmc-miscs-module"></span><h2>jqmc.jqmc_miscs module<a class="headerlink" href="#module-jqmc.jqmc_miscs" title="Link to this heading">#</a></h2>
<p>jQMC miscs.</p>
</section>
<section id="module-jqmc.jqmc_tool">
<span id="jqmc-jqmc-tool-module"></span><h2>jqmc.jqmc_tool module<a class="headerlink" href="#module-jqmc.jqmc_tool" title="Link to this heading">#</a></h2>
<p>jQMC tools.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.ansatz_type">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">ansatz_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.ansatz_type" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Orbital type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.ansatz_type.jagp">
<span class="sig-name descname"><span class="pre">jagp</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'jagp'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.ansatz_type.jagp" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.ansatz_type.jsd">
<span class="sig-name descname"><span class="pre">jsd</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'jsd'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.ansatz_type.jsd" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.hamiltonian_convert_wavefunction">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">hamiltonian_convert_wavefunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian_data_org_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_to</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian_data_conv_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.hamiltonian_convert_wavefunction" title="Link to this definition">#</a></dt>
<dd><p>Convert wavefunction data in the Hamiltonian data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian_data_org_file</strong> (<em>str</em>)</p></li>
<li><p><strong>convert_to</strong> (<a class="reference internal" href="#jqmc.jqmc_tool.ansatz_type" title="jqmc.jqmc_tool.ansatz_type"><em>ansatz_type</em></a>)</p></li>
<li><p><strong>hamiltonian_data_conv_file</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.hamiltonian_show_info">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">hamiltonian_show_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.hamiltonian_show_info" title="Link to this definition">#</a></dt>
<dd><p>Show information stored in the Hamiltonian data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>hamiltonian_data</strong> (<em>str</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.hamiltonian_to_xyz">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">hamiltonian_to_xyz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamiltonian_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.hamiltonian_to_xyz" title="Link to this definition">#</a></dt>
<dd><p>Show information stored in the Hamiltonian data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamiltonian_data</strong> (<em>str</em>)</p></li>
<li><p><strong>xyz_file</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.lrdmc_compute_energy">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">lrdmc_compute_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restart_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfmc_bin_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfmc_collect_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.lrdmc_compute_energy" title="Link to this definition">#</a></dt>
<dd><p>LRDMC energy calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>restart_chk</strong> (<em>str</em>)</p></li>
<li><p><strong>num_gfmc_bin_block</strong> (<em>int</em>)</p></li>
<li><p><strong>num_gfmc_warmup_steps</strong> (<em>int</em>)</p></li>
<li><p><strong>num_gfmc_collect_steps</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.lrdmc_extrapolate_energy">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">lrdmc_extrapolate_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restart_chks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polynomial_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfmc_bin_block</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_gfmc_collect_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.lrdmc_extrapolate_energy" title="Link to this definition">#</a></dt>
<dd><p>LRDMC energy calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>restart_chks</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>polynomial_order</strong> (<em>int</em>)</p></li>
<li><p><strong>plot_graph</strong> (<em>bool</em>)</p></li>
<li><p><strong>save_graph</strong> (<em>str</em>)</p></li>
<li><p><strong>num_gfmc_bin_block</strong> (<em>int</em>)</p></li>
<li><p><strong>num_gfmc_warmup_steps</strong> (<em>int</em>)</p></li>
<li><p><strong>num_gfmc_collect_steps</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.lrdmc_generate_input">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">lrdmc_generate_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.lrdmc_generate_input" title="Link to this definition">#</a></dt>
<dd><p>Generate an input file for LRDMC calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flag</strong> (<em>bool</em>)</p></li>
<li><p><strong>filename</strong> (<em>str</em>)</p></li>
<li><p><strong>exclude_comment</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.mcmc_compute_energy">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">mcmc_compute_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restart_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_bin_blocks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_mcmc_warmup_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.mcmc_compute_energy" title="Link to this definition">#</a></dt>
<dd><p>VMC energy calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>restart_chk</strong> (<em>str</em>)</p></li>
<li><p><strong>num_mcmc_bin_blocks</strong> (<em>int</em>)</p></li>
<li><p><strong>num_mcmc_warmup_steps</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.mcmc_generate_input">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">mcmc_generate_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.mcmc_generate_input" title="Link to this definition">#</a></dt>
<dd><p>Generate an input file for VMC calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flag</strong> (<em>bool</em>)</p></li>
<li><p><strong>filename</strong> (<em>str</em>)</p></li>
<li><p><strong>exclude_comment</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.orbital_type">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">orbital_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.orbital_type" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<p>Orbital type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.orbital_type.ao">
<span class="sig-name descname"><span class="pre">ao</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ao'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.orbital_type.ao" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.orbital_type.ao_full">
<span class="sig-name descname"><span class="pre">ao_full</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ao-full'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.orbital_type.ao_full" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.orbital_type.ao_large">
<span class="sig-name descname"><span class="pre">ao_large</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ao-large'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.orbital_type.ao_large" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.orbital_type.ao_medium">
<span class="sig-name descname"><span class="pre">ao_medium</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ao-medium'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.orbital_type.ao_medium" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.orbital_type.ao_small">
<span class="sig-name descname"><span class="pre">ao_small</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ao-small'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.orbital_type.ao_small" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.orbital_type.mo">
<span class="sig-name descname"><span class="pre">mo</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'mo'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.orbital_type.mo" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.orbital_type.none">
<span class="sig-name descname"><span class="pre">none</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'none'</span></span><a class="headerlink" href="#jqmc.jqmc_tool.orbital_type.none" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.trexio_convert_to">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">trexio_convert_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trexio_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamiltonian_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j1_parmeter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j2_parmeter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j3_basis_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_nn_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j_nn_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.trexio_convert_to" title="Link to this definition">#</a></dt>
<dd><p>Convert a TREXIO file to hamiltonian_data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trexio_file</strong> (<em>str</em>)</p></li>
<li><p><strong>hamiltonian_file</strong> (<em>str</em>)</p></li>
<li><p><strong>j1_parmeter</strong> (<em>float</em>)</p></li>
<li><p><strong>j2_parmeter</strong> (<em>float</em>)</p></li>
<li><p><strong>j3_basis_type</strong> (<a class="reference internal" href="#jqmc.jqmc_tool.orbital_type" title="jqmc.jqmc_tool.orbital_type"><em>orbital_type</em></a>)</p></li>
<li><p><strong>j_nn_type</strong> (<em>str</em>)</p></li>
<li><p><strong>j_nn_params</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.trexio_show_detail">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">trexio_show_detail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.trexio_show_detail" title="Link to this definition">#</a></dt>
<dd><p>Show information stored in the TREXIO file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.trexio_show_info">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">trexio_show_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.trexio_show_info" title="Link to this definition">#</a></dt>
<dd><p>Show information stored in the TREXIO file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.vmc_analyze_output">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">vmc_analyze_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filenames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.vmc_analyze_output" title="Link to this definition">#</a></dt>
<dd><p>Analyze the output files of vmc optimizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filenames</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>plot_graph</strong> (<em>bool</em>)</p></li>
<li><p><strong>save_graph</strong> (<em>str</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.vmc_chk_fix">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">vmc_chk_fix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restart_chk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.vmc_chk_fix" title="Link to this definition">#</a></dt>
<dd><p>VMCopt chk file fix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>restart_chk</strong> (<em>str</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.jqmc_tool.vmc_generate_input">
<span class="sig-prename descclassname"><span class="pre">jqmc.jqmc_tool.</span></span><span class="sig-name descname"><span class="pre">vmc_generate_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;typer.models.OptionInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.jqmc_tool.vmc_generate_input" title="Link to this definition">#</a></dt>
<dd><p>Generate an input file for VMCopt calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flag</strong> (<em>bool</em>)</p></li>
<li><p><strong>filename</strong> (<em>str</em>)</p></li>
<li><p><strong>exclude_comment</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.jqmc_utility">
<span id="jqmc-jqmc-utility-module"></span><h2>jqmc.jqmc_utility module<a class="headerlink" href="#module-jqmc.jqmc_utility" title="Link to this heading">#</a></h2>
<p>utility module.</p>
</section>
<section id="module-jqmc.molecular_orbital">
<span id="jqmc-molecular-orbital-module"></span><h2>jqmc.molecular_orbital module<a class="headerlink" href="#module-jqmc.molecular_orbital" title="Link to this heading">#</a></h2>
<p>Molecular Orbital module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.molecular_orbital.</span></span><span class="sig-name descname"><span class="pre">MOs_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_mo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aos_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mo_coefficients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Molecular orbital (MO) coefficients and metadata.</p>
<p>Holds the contraction matrix that maps atomic orbitals (AOs) to molecular orbitals (MOs).
MO values are obtained as <code class="docutils literal notranslate"><span class="pre">mo_coefficients</span> <span class="pre">&#64;</span> <span class="pre">AO_values</span></code> in float64 (<code class="docutils literal notranslate"><span class="pre">jax_enable_x64=True</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_mo</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>)  Number of molecular orbitals.</p></li>
<li><p><strong>aos_data</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">AOs_sphe_data</span> <span class="pre">|</span> <span class="pre">AOs_cart_data</span></code>)  AO definition supplying centers, exponents/coefficients,
angular data, and contraction mapping.</p></li>
<li><p><strong>mo_coefficients</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">npt.NDArray</span> <span class="pre">|</span> <span class="pre">jax.Array</span></code>)  Coefficient matrix of shape <code class="docutils literal notranslate"><span class="pre">(num_mo,</span> <span class="pre">num_ao)</span></code>. Rows
correspond to MOs; columns correspond to contracted AOs.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_mo</strong> (<em>int</em>)</p></li>
<li><p><strong>aos_data</strong> (<a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><em>AOs_sphe_data</em></a><em> | </em><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><em>AOs_cart_data</em></a>)</p></li>
<li><p><strong>mo_coefficients</strong> (<em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>_ScalarT</em><em>]</em><em>] </em><em>| </em><em>Array</em><em> | </em><em>ndarray</em><em> | </em><em>bool</em><em> | </em><em>number</em><em> | </em><em>bool</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>complex</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Minimal runnable setup (2 AOs -&gt; 1 MO):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Structure_data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.atomic_orbital</span><span class="w"> </span><span class="kn">import</span> <span class="n">AOs_sphe_data</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.molecular_orbital</span><span class="w"> </span><span class="kn">import</span> <span class="n">MOs_data</span>

<span class="n">structure</span> <span class="o">=</span> <span class="n">Structure_data</span><span class="p">(</span>
    <span class="n">positions</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.70</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">]],</span>
    <span class="n">pbc_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">atomic_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">element_symbols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">],</span>
    <span class="n">atomic_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H1&quot;</span><span class="p">,</span> <span class="s2">&quot;H2&quot;</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">aos</span> <span class="o">=</span> <span class="n">AOs_sphe_data</span><span class="p">(</span>
    <span class="n">structure_data</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span>
    <span class="n">nucleus_index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">num_ao</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">num_ao_prim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">orbital_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">exponents</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">],</span>
    <span class="n">coefficients</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span>
    <span class="n">angular_momentums</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="n">magnetic_quantum_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">aos</span><span class="o">.</span><span class="n">sanity_check</span><span class="p">()</span>

<span class="n">mo_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>  <span class="c1"># shape (1, 2)</span>
<span class="n">mos</span> <span class="o">=</span> <span class="n">MOs_data</span><span class="p">(</span><span class="n">num_mo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">aos_data</span><span class="o">=</span><span class="n">aos</span><span class="p">,</span> <span class="n">mo_coefficients</span><span class="o">=</span><span class="n">mo_coeffs</span><span class="p">)</span>
<span class="n">mos</span><span class="o">.</span><span class="n">sanity_check</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data.aos_data">
<span class="sig-name descname"><span class="pre">aos_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.atomic_orbital.AOs_sphe_data" title="jqmc.atomic_orbital.AOs_sphe_data"><span class="pre">AOs_sphe_data</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.atomic_orbital.AOs_cart_data" title="jqmc.atomic_orbital.AOs_cart_data"><span class="pre">AOs_cart_data</span></a></span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data.aos_data" title="Link to this definition">#</a></dt>
<dd><p>AO definition supplying centers, exponents/coefficients, angular data, and contraction mapping.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data.mo_coefficients">
<span class="sig-name descname"><span class="pre">mo_coefficients</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span></span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data.mo_coefficients" title="Link to this definition">#</a></dt>
<dd><p>MO coefficient matrix, shape <code class="docutils literal notranslate"><span class="pre">(num_mo,</span> <span class="pre">num_ao)</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data.num_mo">
<span class="sig-name descname"><span class="pre">num_mo</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data.num_mo" title="Link to this definition">#</a></dt>
<dd><p>Number of molecular orbitals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Validate internal consistency.</p>
<p>Ensures <code class="docutils literal notranslate"><span class="pre">mo_coefficients</span></code> matches <code class="docutils literal notranslate"><span class="pre">(num_mo,</span> <span class="pre">aos_data.num_ao)</span></code>, verifies <code class="docutils literal notranslate"><span class="pre">num_mo</span></code> is an int,
and delegates AO validation to <code class="docutils literal notranslate"><span class="pre">aos_data.sanity_check()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If coefficient shape or <code class="docutils literal notranslate"><span class="pre">num_mo</span></code> type is invalid, or if <code class="docutils literal notranslate"><span class="pre">aos_data</span></code> fails its check.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data.structure_data">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">structure_data</span></span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data.structure_data" title="Link to this definition">#</a></dt>
<dd><p>Return structure_data of the aos_data instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data.to_cartesian">
<span class="sig-name descname"><span class="pre">to_cartesian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data.to_cartesian" title="Link to this definition">#</a></dt>
<dd><p>Convert spherical AOs to Cartesian AOs and transform MO coefficients.</p>
<p>Returns a new <code class="docutils literal notranslate"><span class="pre">MOs_data</span></code> whose <code class="docutils literal notranslate"><span class="pre">aos_data</span></code> is <code class="docutils literal notranslate"><span class="pre">AOs_cart_data</span></code>. The molecular
orbital functions are preserved by applying an analytic (radial-independent)
transformation per angular momentum shell. Only <code class="docutils literal notranslate"><span class="pre">AOs_sphe_data</span></code> inputs are supported;
for Cartesian inputs the instance is returned unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If the underlying AOs are not spherical or the shell completeness
    check (<code class="docutils literal notranslate"><span class="pre">2l+1</span></code> functions per shell) fails.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><em>MOs_data</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.MOs_data.to_spherical">
<span class="sig-name descname"><span class="pre">to_spherical</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.molecular_orbital.MOs_data.to_spherical" title="Link to this definition">#</a></dt>
<dd><p>Convert Cartesian AOs to spherical AOs and transform MO coefficients.</p>
<p>Returns a new <code class="docutils literal notranslate"><span class="pre">MOs_data</span></code> whose <code class="docutils literal notranslate"><span class="pre">aos_data</span></code> is <code class="docutils literal notranslate"><span class="pre">AOs_sphe_data</span></code>. The molecular
orbital functions are preserved by applying the analytic Cartesianspherical
transformation per angular momentum shell. Only <code class="docutils literal notranslate"><span class="pre">AOs_cart_data</span></code> inputs are supported;
for spherical inputs the instance is returned unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If the underlying AOs are not Cartesian or the shell completeness
    check (<code class="docutils literal notranslate"><span class="pre">(l+1)(l+2)/2</span></code> functions per shell with matching exps/coefs/orders)
    fails.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><em>MOs_data</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.compute_MOs">
<span class="sig-prename descclassname"><span class="pre">jqmc.molecular_orbital.</span></span><span class="sig-name descname"><span class="pre">compute_MOs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mos_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.molecular_orbital.compute_MOs" title="Link to this definition">#</a></dt>
<dd><p>Evaluate molecular orbitals at electron coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mos_data</strong> (<a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">MOs_data</span></code></a>)  MO/AO definition and coefficient matrix.</p></li>
<li><p><strong>r_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Electron Cartesian coordinates, shape <code class="docutils literal notranslate"><span class="pre">(N_e,</span> <span class="pre">3)</span></code> in float64 (same convention as
AO evaluators).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MO values with shape <code class="docutils literal notranslate"><span class="pre">(num_mo,</span> <span class="pre">N_e)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.compute_MOs_grad">
<span class="sig-prename descclassname"><span class="pre">jqmc.molecular_orbital.</span></span><span class="sig-name descname"><span class="pre">compute_MOs_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mos_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.molecular_orbital.compute_MOs_grad" title="Link to this definition">#</a></dt>
<dd><p>Compute MO gradients (x, y, z components) at electron coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mos_data</strong> (<a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">MOs_data</span></code></a>)  MO/AO definition and coefficient matrix.</p></li>
<li><p><strong>r_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Electron Cartesian coordinates, shape <code class="docutils literal notranslate"><span class="pre">(N_e,</span> <span class="pre">3)</span></code> in float64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gradients per component
<code class="docutils literal notranslate"><span class="pre">(grad_x,</span> <span class="pre">grad_y,</span> <span class="pre">grad_z)</span></code>, each of shape <code class="docutils literal notranslate"><span class="pre">(num_mo,</span> <span class="pre">N_e)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[npt.NDArray[np.float64], npt.NDArray[np.float64], npt.NDArray[np.float64]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.molecular_orbital.compute_MOs_laplacian">
<span class="sig-prename descclassname"><span class="pre">jqmc.molecular_orbital.</span></span><span class="sig-name descname"><span class="pre">compute_MOs_laplacian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mos_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.molecular_orbital.compute_MOs_laplacian" title="Link to this definition">#</a></dt>
<dd><p>Compute MO laplacians at electron coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mos_data</strong> (<a class="reference internal" href="#jqmc.molecular_orbital.MOs_data" title="jqmc.molecular_orbital.MOs_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">MOs_data</span></code></a>)  MO/AO definition and coefficient matrix.</p></li>
<li><p><strong>r_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Electron Cartesian coordinates, shape <code class="docutils literal notranslate"><span class="pre">(N_e,</span> <span class="pre">3)</span></code> in float64.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Laplacians of each MO, shape <code class="docutils literal notranslate"><span class="pre">(num_mo,</span> <span class="pre">N_e)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.setting">
<span id="jqmc-setting-module"></span><h2>jqmc.setting module<a class="headerlink" href="#module-jqmc.setting" title="Link to this heading">#</a></h2>
<p>setting.</p>
</section>
<section id="module-jqmc.structure">
<span id="jqmc-structure-module"></span><h2>jqmc.structure module<a class="headerlink" href="#module-jqmc.structure" title="Link to this heading">#</a></h2>
<p>Structure module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.structure.</span></span><span class="sig-name descname"><span class="pre">Structure_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec_c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_numbers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.structure.Structure_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Atomic structure and cell metadata.</p>
<p>Stores Cartesian coordinates (Bohr), optional lattice vectors for PBC, and basic
element metadata used by AOs/MOs, Coulomb, and Hamiltonian builders.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">npt.NDArray</span> <span class="pre">|</span> <span class="pre">jax.Array</span></code>)  Atomic Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">3)</span></code> in Bohr.</p></li>
<li><p><strong>pbc_flag</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>)  Whether periodic boundary conditions are active. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, lattice
vectors <code class="docutils literal notranslate"><span class="pre">vec_a|b|c</span></code> must be provided; otherwise they must be empty.</p></li>
<li><p><strong>vec_a</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Lattice vector <strong>a</strong> (Bohr) when <code class="docutils literal notranslate"><span class="pre">pbc_flag=True</span></code>.</p></li>
<li><p><strong>vec_b</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Lattice vector <strong>b</strong> (Bohr) when <code class="docutils literal notranslate"><span class="pre">pbc_flag=True</span></code>.</p></li>
<li><p><strong>vec_c</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[float]</span> <span class="pre">|</span> <span class="pre">tuple[float]</span></code>)  Lattice vector <strong>c</strong> (Bohr) when <code class="docutils literal notranslate"><span class="pre">pbc_flag=True</span></code>.</p></li>
<li><p><strong>atomic_numbers</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[int]</span> <span class="pre">|</span> <span class="pre">tuple[int]</span></code>)  Atomic numbers <code class="docutils literal notranslate"><span class="pre">Z</span></code> for each site (len <code class="docutils literal notranslate"><span class="pre">N</span></code>).</p></li>
<li><p><strong>element_symbols</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span> <span class="pre">|</span> <span class="pre">tuple[str]</span></code>)  Element symbols for each site (len <code class="docutils literal notranslate"><span class="pre">N</span></code>).</p></li>
<li><p><strong>atomic_labels</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list[str]</span> <span class="pre">|</span> <span class="pre">tuple[str]</span></code>)  Human-readable labels for each site (len <code class="docutils literal notranslate"><span class="pre">N</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>positions</strong> (<em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>_ScalarT</em><em>]</em><em>] </em><em>| </em><em>Array</em><em> | </em><em>ndarray</em><em> | </em><em>bool</em><em> | </em><em>number</em><em> | </em><em>bool</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>complex</em>)</p></li>
<li><p><strong>pbc_flag</strong> (<em>bool</em>)</p></li>
<li><p><strong>vec_a</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>float</em><em>]</em>)</p></li>
<li><p><strong>vec_b</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>float</em><em>]</em>)</p></li>
<li><p><strong>vec_c</strong> (<em>list</em><em>[</em><em>float</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>float</em><em>]</em>)</p></li>
<li><p><strong>atomic_numbers</strong> (<em>list</em><em>[</em><em>int</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>int</em><em>]</em>)</p></li>
<li><p><strong>element_symbols</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>]</em>)</p></li>
<li><p><strong>atomic_labels</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>tuple</em><em>[</em><em>str</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Minimal H2 setup (Bohr):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.structure</span><span class="w"> </span><span class="kn">import</span> <span class="n">Structure_data</span>

<span class="n">structure</span> <span class="o">=</span> <span class="n">Structure_data</span><span class="p">(</span>
    <span class="n">positions</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.70</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">]]),</span>
    <span class="n">pbc_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">atomic_numbers</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">element_symbols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">],</span>
    <span class="n">atomic_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H1&quot;</span><span class="p">,</span> <span class="s2">&quot;H2&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">structure</span><span class="o">.</span><span class="n">sanity_check</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.atomic_labels">
<span class="sig-name descname"><span class="pre">atomic_labels</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.structure.Structure_data.atomic_labels" title="Link to this definition">#</a></dt>
<dd><p>Human-readable labels per site (len <code class="docutils literal notranslate"><span class="pre">N</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.atomic_numbers">
<span class="sig-name descname"><span class="pre">atomic_numbers</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.structure.Structure_data.atomic_numbers" title="Link to this definition">#</a></dt>
<dd><p>Atomic numbers <code class="docutils literal notranslate"><span class="pre">Z</span></code> per site (len <code class="docutils literal notranslate"><span class="pre">N</span></code>).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.cell">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">cell</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.structure.Structure_data.cell" title="Link to this definition">#</a></dt>
<dd><p>Lattice vectors as a <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code> matrix in Bohr (<code class="docutils literal notranslate"><span class="pre">[a,</span> <span class="pre">b,</span> <span class="pre">c]</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.element_symbols">
<span class="sig-name descname"><span class="pre">element_symbols</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.structure.Structure_data.element_symbols" title="Link to this definition">#</a></dt>
<dd><p>Element symbols per site (len <code class="docutils literal notranslate"><span class="pre">N</span></code>).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.lattice_vec_a">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">lattice_vec_a</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.lattice_vec_a" title="Link to this definition">#</a></dt>
<dd><p>Return lattice vector A (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the lattice vector A (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.lattice_vec_b">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">lattice_vec_b</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.lattice_vec_b" title="Link to this definition">#</a></dt>
<dd><p>Return lattice vector B (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the lattice vector B (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.lattice_vec_c">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">lattice_vec_c</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.lattice_vec_c" title="Link to this definition">#</a></dt>
<dd><p>Return lattice vector C (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the lattice vector C (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.natom">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">natom</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.natom" title="Link to this definition">#</a></dt>
<dd><p>The number of atoms in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of atoms in the system.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.norm_vec_a">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">norm_vec_a</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.norm_vec_a" title="Link to this definition">#</a></dt>
<dd><p>Return the norm of the lattice vector A (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the norm of the lattice vector A (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.float64</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.norm_vec_b">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">norm_vec_b</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.norm_vec_b" title="Link to this definition">#</a></dt>
<dd><p>Return the norm of the lattice vector B (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the norm of the lattice vector C (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.float64</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.norm_vec_c">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">norm_vec_c</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.norm_vec_c" title="Link to this definition">#</a></dt>
<dd><p>Return the norm of the lattice vector C (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the norm of the lattice vector C (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.float64</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.ntyp">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">ntyp</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.ntyp" title="Link to this definition">#</a></dt>
<dd><p>The number of element types in the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of element types in the system.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.pbc_flag">
<span class="sig-name descname"><span class="pre">pbc_flag</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.pbc_flag" title="Link to this definition">#</a></dt>
<dd><p>Whether periodic boundary conditions are active.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.positions">
<span class="sig-name descname"><span class="pre">positions</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">_ScalarT</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.positions" title="Link to this definition">#</a></dt>
<dd><p>Atomic Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N,</span> <span class="pre">3)</span></code> in Bohr.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.recip_cell">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">recip_cell</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">float64</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.structure.Structure_data.recip_cell" title="Link to this definition">#</a></dt>
<dd><p>Reciprocal lattice vectors <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code> in Bohr^{-1}.</p>
<p>Uses the standard definition</p>
<div class="math notranslate nohighlight">
\[G_a = 2\pi \frac{T_b \times T_c}{T_a \cdot (T_b \times T_c)},
\quad G_b = 2\pi \frac{T_c \times T_a}{T_b \cdot (T_c \times T_a)},
\quad G_c = 2\pi \frac{T_a \times T_b}{T_c \cdot (T_a \times T_b)},\]</div>
<p>and asserts the orthonormality condition <span class="math notranslate nohighlight">\(T_i \cdot G_j = 2\pi\,\delta_{ij}\)</span>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.recip_vec_a">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">recip_vec_a</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.recip_vec_a" title="Link to this definition">#</a></dt>
<dd><p>Return reciprocal lattice vector A (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the reciprocal lattice vector A (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.recip_vec_b">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">recip_vec_b</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.recip_vec_b" title="Link to this definition">#</a></dt>
<dd><p>Return reciprocal lattice vector B (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the reciprocal lattice vector B (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.recip_vec_c">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">recip_vec_c</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span></span><a class="headerlink" href="#jqmc.structure.Structure_data.recip_vec_c" title="Link to this definition">#</a></dt>
<dd><p>Return reciprocal lattice vector C (in Bohr).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the reciprocal lattice vector C (in Bohr).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[np.float64]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.structure.Structure_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.structure.Structure_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Validate consistency of positions, labels, and lattice metadata.</p>
<p>Ensures all per-atom arrays share length <code class="docutils literal notranslate"><span class="pre">N</span></code>, lattice vectors are either all
present (length 3 each) when <code class="docutils literal notranslate"><span class="pre">pbc_flag=True</span></code> or all empty when <code class="docutils literal notranslate"><span class="pre">pbc_flag=False</span></code>,
and basic types are as expected.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If list lengths mismatch, lattice vectors are inconsistent with
    <code class="docutils literal notranslate"><span class="pre">pbc_flag</span></code>, or field types are incorrect.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.vec_a">
<span class="sig-name descname"><span class="pre">vec_a</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.structure.Structure_data.vec_a" title="Link to this definition">#</a></dt>
<dd><p>Lattice vector <strong>a</strong> in Bohr (requires <code class="docutils literal notranslate"><span class="pre">pbc_flag=True</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.vec_b">
<span class="sig-name descname"><span class="pre">vec_b</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.structure.Structure_data.vec_b" title="Link to this definition">#</a></dt>
<dd><p>Lattice vector <strong>b</strong> in Bohr (requires <code class="docutils literal notranslate"><span class="pre">pbc_flag=True</span></code>).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.structure.Structure_data.vec_c">
<span class="sig-name descname"><span class="pre">vec_c</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.structure.Structure_data.vec_c" title="Link to this definition">#</a></dt>
<dd><p>Lattice vector <strong>c</strong> in Bohr (requires <code class="docutils literal notranslate"><span class="pre">pbc_flag=True</span></code>).</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-jqmc.swct">
<span id="jqmc-swct-module"></span><h2>jqmc.swct module<a class="headerlink" href="#module-jqmc.swct" title="Link to this heading">#</a></h2>
<p>SWCT module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.swct.SWCT_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.swct.</span></span><span class="sig-name descname"><span class="pre">SWCT_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.swct.SWCT_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Space-warp coordinate transformation metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Structure_data</span></code>)  Nuclear geometry used to build SWCT weights.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="jqmc.swct.SWCT_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.swct.SWCT_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.swct.SWCT_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.swct.SWCT_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.swct.SWCT_data.structure">
<span class="sig-name descname"><span class="pre">structure</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.structure.Structure_data" title="jqmc.structure.Structure_data"><span class="pre">Structure_data</span></a></span><a class="headerlink" href="#jqmc.swct.SWCT_data.structure" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.swct.evaluate_swct_domega">
<span class="sig-prename descclassname"><span class="pre">jqmc.swct.</span></span><span class="sig-name descname"><span class="pre">evaluate_swct_domega</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swct_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.swct.evaluate_swct_domega" title="Link to this definition">#</a></dt>
<dd><p>Evaluate <span class="math notranslate nohighlight">\(\sum_i \nabla_{r_i} \omega_{\alpha i}\)</span> for each atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swct_data</strong> (<a class="reference internal" href="#jqmc.swct.SWCT_data" title="jqmc.swct.SWCT_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">SWCT_data</span></code></a>)  Structure and cached geometry information.</p></li>
<li><p><strong>r_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_e,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sum of gradients per atom with shape <code class="docutils literal notranslate"><span class="pre">(N_a,</span> <span class="pre">3)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.swct.evaluate_swct_omega">
<span class="sig-prename descclassname"><span class="pre">jqmc.swct.</span></span><span class="sig-name descname"><span class="pre">evaluate_swct_omega</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">swct_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.swct.evaluate_swct_omega" title="Link to this definition">#</a></dt>
<dd><p>Compute SWCT weights <span class="math notranslate nohighlight">\(\omega_{\alpha i}\)</span> for each atom/electron pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>swct_data</strong> (<a class="reference internal" href="#jqmc.swct.SWCT_data" title="jqmc.swct.SWCT_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">SWCT_data</span></code></a>)  Structure and cached geometry information.</p></li>
<li><p><strong>r_carts</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code>)  Electron Cartesian coordinates with shape <code class="docutils literal notranslate"><span class="pre">(N_e,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">float64</span></code> dtype.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized weights with shape <code class="docutils literal notranslate"><span class="pre">(N_a,</span> <span class="pre">N_e)</span></code>, summing to 1 over atoms for each electron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>jax.Array</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc.trexio_wrapper">
<span id="jqmc-trexio-wrapper-module"></span><h2>jqmc.trexio_wrapper module<a class="headerlink" href="#module-jqmc.trexio_wrapper" title="Link to this heading">#</a></h2>
<p>TREXIO wrapper modules.</p>
<dl class="py function">
<dt class="sig sig-object py" id="jqmc.trexio_wrapper.read_trexio_file">
<span class="sig-prename descclassname"><span class="pre">jqmc.trexio_wrapper.</span></span><span class="sig-name descname"><span class="pre">read_trexio_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trexio_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_tuple</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.trexio_wrapper.read_trexio_file" title="Link to this definition">#</a></dt>
<dd><p>Load a TREXIO HDF5 file into jqmc data containers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trexio_file</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>)  Path to the TREXIO file to read (HDF5 backend expected).</p></li>
<li><p><strong>store_tuple</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <em>optional</em>)  Store list-like fields as tuples for immutability
(useful in tests with JAX/Flax), at the cost of slower production runs.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="docutils literal notranslate"><span class="pre">(structure_data,</span> <span class="pre">aos_data,</span> <span class="pre">mos_data_up,</span> <span class="pre">mos_data_dn,</span> <span class="pre">geminal_data,</span> <span class="pre">coulomb_potential_data)</span></code>
where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">structure_data</span></code> is a <cite>Structure_data</cite> describing atoms and geometry.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aos_data</span></code> is either <cite>AOs_cart_data</cite> or <cite>AOs_sphe_data</cite> depending on the basis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mos_data_up</span></code> and <code class="docutils literal notranslate"><span class="pre">mos_data_dn</span></code> are <cite>MOs_data</cite> for spin-up/down orbitals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">geminal_data</span></code> is a <cite>Geminal_data</cite> assembled from the MO block.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coulomb_potential_data</span></code> is a <cite>Coulomb_potential_data</cite> describing (E)CPs.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>NotImplementedError</strong>  If periodic cells (PBC) or complex molecular orbitals are encountered.</p></li>
<li><p><strong>ValueError</strong>  If atomic labels are unsupported or AO counts are inconsistent.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Periodic boundary conditions are parsed but not supported yet.</p></li>
<li><p>Molecular orbitals are assumed real-valued; complex coefficients are rejected.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">jqmc.trexio_wrapper</span><span class="w"> </span><span class="kn">import</span> <span class="n">read_trexio_file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure_data</span><span class="p">,</span> <span class="n">aos_data</span><span class="p">,</span> <span class="n">mos_up</span><span class="p">,</span> <span class="n">mos_dn</span><span class="p">,</span> <span class="n">geminal_data</span><span class="p">,</span> <span class="n">coulomb_data</span> <span class="o">=</span> <span class="n">read_trexio_file</span><span class="p">(</span><span class="s2">&quot;molecule.h5&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure_data</span><span class="o">.</span><span class="n">atomic_labels</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">[&#39;O&#39;, &#39;H&#39;, &#39;H&#39;]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-jqmc.wavefunction">
<span id="jqmc-wavefunction-module"></span><h2>jqmc.wavefunction module<a class="headerlink" href="#module-jqmc.wavefunction" title="Link to this heading">#</a></h2>
<p>Wavefunction module.</p>
<dl class="py class">
<dt class="sig sig-object py" id="jqmc.wavefunction.VariationalParameterBlock">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">VariationalParameterBlock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.VariationalParameterBlock" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A block of variational parameters (e.g., J1, J2, J3, lambda).</p>
<section id="design-overview">
<h3>Design overview<a class="headerlink" href="#design-overview" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>A <em>block</em> is the smallest unit that the optimizer (MCMC + SR) sees.
Each block corresponds to a contiguous slice in the global
variational parameter vector and carries enough metadata to
reconstruct its original shape (name, values, shape, size).</p></li>
<li><p>This class is intentionally <strong>structure-agnostic</strong>: it does not
know anything about Jastrow vs Geminal, matrix symmetry, or how a
block maps to concrete fields in <code class="xref py py-class docutils literal notranslate"><span class="pre">Jastrow_data</span></code> or
<code class="xref py py-class docutils literal notranslate"><span class="pre">Geminal_data</span></code>.</p></li>
<li><p>All physics- and structure-specific semantics are owned by the
corresponding data classes via their <code class="docutils literal notranslate"><span class="pre">get_variational_blocks</span></code> and
<code class="docutils literal notranslate"><span class="pre">apply_block_update</span></code> methods.</p></li>
</ul>
<p>The goal is that adding or modifying a variational parameter only
requires changes on the wavefunction side (Jastrow/Geminal data),
while the MCMC/SR driver remains completely agnostic and operates
purely on a list of blocks.</p>
<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.VariationalParameterBlock.apply_update">
<span class="sig-name descname"><span class="pre">apply_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_flat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.VariationalParameterBlock.apply_update" title="Link to this definition">#</a></dt>
<dd><p>Return a new block with values updated by a generic additive rule.</p>
<p>This method is intentionally <em>structure-agnostic</em> and only performs a
simple additive update:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_new</span> <span class="o">=</span> <span class="n">X_old</span> <span class="o">+</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="n">delta</span>
</pre></div>
</div>
<p>Any parameter-specific constraints (e.g., symmetry of J3 or
<code class="docutils literal notranslate"><span class="pre">lambda_matrix</span></code>) must be enforced by the owner of the parameter
(<code class="docutils literal notranslate"><span class="pre">jastrow_data</span></code>, <code class="docutils literal notranslate"><span class="pre">geminal_data</span></code>, etc.) inside their
<code class="docutils literal notranslate"><span class="pre">apply_block_update</span></code> implementations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta_flat</strong> (<em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>_ScalarT</em><em>]</em><em>]</em>)  Flattened update vector with length equal to <code class="docutils literal notranslate"><span class="pre">size</span></code>.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>)  Scaling factor for the update.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.wavefunction.VariationalParameterBlock" title="jqmc.wavefunction.VariationalParameterBlock"><em>VariationalParameterBlock</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.wavefunction.VariationalParameterBlock.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></span><a class="headerlink" href="#jqmc.wavefunction.VariationalParameterBlock.name" title="Link to this definition">#</a></dt>
<dd><p>Identifier for this block (for example <code class="docutils literal notranslate"><span class="pre">&quot;j1_param&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;lambda_matrix&quot;</span></code>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.VariationalParameterBlock.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.VariationalParameterBlock.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.wavefunction.VariationalParameterBlock.shape">
<span class="sig-name descname"><span class="pre">shape</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#jqmc.wavefunction.VariationalParameterBlock.shape" title="Link to this definition">#</a></dt>
<dd><p>Original shape of <code class="docutils literal notranslate"><span class="pre">values</span></code> for unflattening updates.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.wavefunction.VariationalParameterBlock.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></span><a class="headerlink" href="#jqmc.wavefunction.VariationalParameterBlock.size" title="Link to this definition">#</a></dt>
<dd><p>Flattened size of <code class="docutils literal notranslate"><span class="pre">values</span></code> used when slicing the global vector.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.wavefunction.VariationalParameterBlock.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">number</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span></span><a class="headerlink" href="#jqmc.wavefunction.VariationalParameterBlock.values" title="Link to this definition">#</a></dt>
<dd><p>Parameter payload (keeps PyTree structure if present).</p>
</dd></dl>

</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>)</p></li>
<li><p><strong>values</strong> (<em>Array</em><em> | </em><em>ndarray</em><em> | </em><em>bool</em><em> | </em><em>number</em><em> | </em><em>bool</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>complex</em>)</p></li>
<li><p><strong>shape</strong> (<em>tuple</em><em>[</em><em>int</em><em>, </em><em>...</em><em>]</em>)</p></li>
<li><p><strong>size</strong> (<em>int</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">Wavefunction_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jastrow_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geminal_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container for Jastrow and Geminal parts used to evaluate a wavefunction.</p>
<p>The class owns only the data needed to construct the wavefunction. All
computations are delegated to the functions in this module and the
underlying Jastrow/Geminal helpers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>jastrow_data</strong> (<a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><em>Jastrow_data</em></a>)  Optional Jastrow parameters. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the Jastrow part is omitted.</p></li>
<li><p><strong>geminal_data</strong> (<a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><em>Geminal_data</em></a>)  Optional Geminal parameters. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the determinant part is omitted.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.accumulate_position_grad">
<span class="sig-name descname"><span class="pre">accumulate_position_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_wavefunction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.accumulate_position_grad" title="Link to this definition">#</a></dt>
<dd><p>Aggregate position gradients from geminal and Jastrow parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grad_wavefunction</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.apply_block_updates">
<span class="sig-name descname"><span class="pre">apply_block_updates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thetas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.apply_block_updates" title="Link to this definition">#</a></dt>
<dd><p>Return a new <a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Wavefunction_data</span></code></a> with variational blocks updated.</p>
<section id="design-notes">
<h3>Design notes<a class="headerlink" href="#design-notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">blocks</span></code> defines the ordering and shapes of all variational
parameters; <code class="docutils literal notranslate"><span class="pre">thetas</span></code> is a single flattened update vector in
the same order.</p></li>
<li><p>This method is responsible for slicing <code class="docutils literal notranslate"><span class="pre">thetas</span></code> into
per-block pieces and performing a generic additive update via
<a class="reference internal" href="#jqmc.wavefunction.VariationalParameterBlock.apply_update" title="jqmc.wavefunction.VariationalParameterBlock.apply_update"><code class="xref py py-meth docutils literal notranslate"><span class="pre">VariationalParameterBlock.apply_update()</span></code></a>.</p></li>
<li><p>The <em>interpretation</em> of each block (this is J1, this is the
J3 matrix, this is lambda) and any structural constraints
(symmetry, rectangular layout, etc.) are delegated to
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Jastrow_data.apply_block_update()</span></code> and
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Geminal_data.apply_block_update()</span></code>.</p></li>
</ul>
<p>Because of this separation of concerns, the MCMC/SR driver only
needs to work with the flattened <code class="docutils literal notranslate"><span class="pre">thetas</span></code> vector and the list of
blocks; it never touches Jastrow/Geminal internals directly. To
add a new parameter to the optimization, one only needs to
(1) expose it in <a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data.get_variational_blocks" title="jqmc.wavefunction.Wavefunction_data.get_variational_blocks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_variational_blocks()</span></code></a>, and
(2) handle it in the corresponding <code class="docutils literal notranslate"><span class="pre">apply_block_update</span></code> method.</p>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks</strong> (<em>list</em><em>[</em><a class="reference internal" href="#jqmc.wavefunction.VariationalParameterBlock" title="jqmc.wavefunction.VariationalParameterBlock"><em>VariationalParameterBlock</em></a><em>]</em>)</p></li>
<li><p><strong>thetas</strong> (<em>ndarray</em><em>[</em><em>tuple</em><em>[</em><em>Any</em><em>, </em><em>...</em><em>]</em><em>, </em><em>dtype</em><em>[</em><em>_ScalarT</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.collect_param_grads">
<span class="sig-name descname"><span class="pre">collect_param_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grad_wavefunction</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.collect_param_grads" title="Link to this definition">#</a></dt>
<dd><p>Collect parameter gradients from Jastrow and Geminal into a flat dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>grad_wavefunction</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, object]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.flatten_param_grads">
<span class="sig-name descname"><span class="pre">flatten_param_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">param_grads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_walkers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.flatten_param_grads" title="Link to this definition">#</a></dt>
<dd><p>Return parameter gradients as numpy arrays ready for storage.</p>
<p>The caller does not need to know the internal block structure (e.g., NN trees);
any necessary flattening is handled here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_grads</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>object</em><em>]</em>)</p></li>
<li><p><strong>num_walkers</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict[str, <em>ndarray</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.geminal_data">
<span class="sig-name descname"><span class="pre">geminal_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.determinant.Geminal_data" title="jqmc.determinant.Geminal_data"><span class="pre">Geminal_data</span></a></span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.geminal_data" title="Link to this definition">#</a></dt>
<dd><p>Variational Geminal/determinant parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.get_variational_blocks">
<span class="sig-name descname"><span class="pre">get_variational_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_J1_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_J2_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_J3_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_JNN_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_lambda_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.get_variational_blocks" title="Link to this definition">#</a></dt>
<dd><p>Collect variational parameter blocks from Jastrow and Geminal parts.</p>
<p>Each block corresponds to a contiguous group of variational parameters
(e.g., J1, J2, J3 matrix, NN Jastrow, lambda matrix). This method only exposes the
parameter arrays; the corresponding gradients are handled on the MCMC side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opt_J1_param</strong> (<em>bool</em>)</p></li>
<li><p><strong>opt_J2_param</strong> (<em>bool</em>)</p></li>
<li><p><strong>opt_J3_param</strong> (<em>bool</em>)</p></li>
<li><p><strong>opt_JNN_param</strong> (<em>bool</em>)</p></li>
<li><p><strong>opt_lambda_param</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[<a class="reference internal" href="#jqmc.wavefunction.VariationalParameterBlock" title="jqmc.wavefunction.VariationalParameterBlock"><em>VariationalParameterBlock</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.jastrow_data">
<span class="sig-name descname"><span class="pre">jastrow_data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#jqmc.jastrow_factor.Jastrow_data" title="jqmc.jastrow_factor.Jastrow_data"><span class="pre">Jastrow_data</span></a></span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.jastrow_data" title="Link to this definition">#</a></dt>
<dd><p>Variational Jastrow parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">updates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.replace" title="Link to this definition">#</a></dt>
<dd><p>Returns a new object replacing the specified fields with new values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.sanity_check">
<span class="sig-name descname"><span class="pre">sanity_check</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.sanity_check" title="Link to this definition">#</a></dt>
<dd><p>Check attributes of the class.</p>
<p>This function checks the consistencies among the arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong>  If there is an inconsistency in a dimension of a given argument.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.with_diff_mask">
<span class="sig-name descname"><span class="pre">with_diff_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.with_diff_mask" title="Link to this definition">#</a></dt>
<dd><p>Return a copy with gradients masked according to the provided flags.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>bool</em>)</p></li>
<li><p><strong>coords</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jqmc.wavefunction.Wavefunction_data.with_param_grad_mask">
<span class="sig-name descname"><span class="pre">with_param_grad_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_J1_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_J2_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_J3_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_JNN_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_lambda_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.Wavefunction_data.with_param_grad_mask" title="Link to this definition">#</a></dt>
<dd><p>Return a copy where disabled parameter blocks stop propagating gradients.</p>
<section id="developer-note">
<h3>Developer note<a class="headerlink" href="#developer-note" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>The per-block flags (<code class="docutils literal notranslate"><span class="pre">opt_J1_param</span></code> etc.) decide which high-level blocks are</dt><dd><p>masked. Disabled blocks are wrapped with <code class="docutils literal notranslate"><span class="pre">DiffMask(params=False,</span> <span class="pre">coords=True)</span></code>,
meaning parameter gradients are stopped while coordinate gradients still flow.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Within each disabled block, <code class="docutils literal notranslate"><span class="pre">apply_diff_mask</span></code> uses field-name heuristics</dt><dd><p>(see <code class="docutils literal notranslate"><span class="pre">diff_mask._PARAM_FIELD_NAMES</span></code>) to tag parameter leaves such as
<code class="docutils literal notranslate"><span class="pre">lambda_matrix</span></code>, <code class="docutils literal notranslate"><span class="pre">j_matrix</span></code>, <code class="docutils literal notranslate"><span class="pre">jastrow_1b_param</span></code>, <code class="docutils literal notranslate"><span class="pre">jastrow_2b_param</span></code>,
<code class="docutils literal notranslate"><span class="pre">jastrow_3b_param</span></code>, and <code class="docutils literal notranslate"><span class="pre">params</span></code>. Those tagged leaves receive
<code class="docutils literal notranslate"><span class="pre">jax.lax.stop_gradient</span></code>, so their backpropagated gradients become zero.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Example: if <code class="docutils literal notranslate"><span class="pre">opt_J1_param=False</span></code> and others are True, only the J1 block is</dt><dd><p>masked; its parameter leaves are stopped, while J2/J3/NN/lambda continue to
propagate gradients normally.</p>
</dd>
</dl>
</li>
</ul>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opt_J1_param</strong> (<em>bool</em>)</p></li>
<li><p><strong>opt_J2_param</strong> (<em>bool</em>)</p></li>
<li><p><strong>opt_J3_param</strong> (<em>bool</em>)</p></li>
<li><p><strong>opt_JNN_param</strong> (<em>bool</em>)</p></li>
<li><p><strong>opt_lambda_param</strong> (<em>bool</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.compute_discretized_kinetic_energy">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">compute_discretized_kinetic_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.compute_discretized_kinetic_energy" title="Link to this definition">#</a></dt>
<dd><p>Compute discretized kinetic mesh points and energies for a given lattice spacing <code class="docutils literal notranslate"><span class="pre">alat</span></code>.</p>
<p>Function for computing discretized kinetic grid points and their energies with a
given lattice space (alat). This keeps the original semantics used by the LRDMC
path: ratios are computed as <code class="docutils literal notranslate"><span class="pre">exp(J_xp</span> <span class="pre">-</span> <span class="pre">J_x)</span> <span class="pre">*</span> <span class="pre">det_xp</span> <span class="pre">/</span> <span class="pre">det_x</span></code>. Inputs are
coerced to float64 <code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> before evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alat</strong> (<em>float</em>)  Hamiltonian discretization (bohr), which will be replaced with <code class="docutils literal notranslate"><span class="pre">LRDMC_data</span></code>.</p></li>
<li><p><strong>wavefunction_data</strong>  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Up-electron positions with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Down-electron positions with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>RT</strong> (<em>Array</em>)  Rotation matrix (<span class="math notranslate nohighlight">\(R^T\)</span>) with shape <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple <code class="docutils literal notranslate"><span class="pre">(r_up_carts_combined,</span> <span class="pre">r_dn_carts_combined,</span> <span class="pre">elements_kinetic_part)</span></code> where the
combined coordinate arrays have shapes <code class="docutils literal notranslate"><span class="pre">(n_grid,</span> <span class="pre">n_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">(n_grid,</span> <span class="pre">n_dn,</span> <span class="pre">3)</span></code>
and <code class="docutils literal notranslate"><span class="pre">elements_kinetic_part</span></code> contains the kinetic prefactor-scaled ratios.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[list[tuple[<em>ndarray</em>[tuple[<em>Any</em>, ], <em>dtype</em>[<em>_ScalarT</em>]], <em>ndarray</em>[tuple[<em>Any</em>, ], <em>dtype</em>[<em>_ScalarT</em>]]]], list[<em>ndarray</em>[tuple[<em>Any</em>, ], <em>dtype</em>[<em>_ScalarT</em>]]], <em>Array</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.compute_discretized_kinetic_energy_fast_update">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">compute_discretized_kinetic_energy_fast_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">A_old_inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.compute_discretized_kinetic_energy_fast_update" title="Link to this definition">#</a></dt>
<dd><p>Fast-update version of discretized kinetic mesh and ratios.</p>
<p>Function for computing discretized kinetic grid points and their energies with
a given lattice space (alat). Uses precomputed <code class="docutils literal notranslate"><span class="pre">A_old_inv</span></code> to evaluate
determinant ratios efficiently. Inputs are converted to float64 <code class="docutils literal notranslate"><span class="pre">jax.Array</span></code>
before use.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alat</strong> (<em>float</em>)  Hamiltonian discretization (bohr), which will be replaced with <code class="docutils literal notranslate"><span class="pre">LRDMC_data</span></code>.</p></li>
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>A_old_inv</strong> (<em>Array</em>)  Inverse of the geminal matrix evaluated at <code class="docutils literal notranslate"><span class="pre">(r_up_carts,</span> <span class="pre">r_dn_carts)</span></code>.</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Up-electron positions with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Down-electron positions with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>RT</strong> (<em>Array</em>)  Rotation matrix (<span class="math notranslate nohighlight">\(R^T\)</span>) with shape <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="docutils literal notranslate"><span class="pre">(r_up_carts_combined,</span> <span class="pre">r_dn_carts_combined,</span> <span class="pre">elements_kinetic_part)</span></code> with combined
coordinate arrays of shapes <code class="docutils literal notranslate"><span class="pre">(n_grid,</span> <span class="pre">n_up,</span> <span class="pre">3)</span></code> and <code class="docutils literal notranslate"><span class="pre">(n_grid,</span> <span class="pre">n_dn,</span> <span class="pre">3)</span></code>, and kinetic
prefactor-scaled ratios <code class="docutils literal notranslate"><span class="pre">elements_kinetic_part</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[<em>Array</em>, <em>Array</em>, <em>Array</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.compute_kinetic_energy">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">compute_kinetic_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.compute_kinetic_energy" title="Link to this definition">#</a></dt>
<dd><p>Compute kinetic energy using analytic gradients and Laplacians.</p>
<p>The method is for computing kinetic energy of the given WF at
<code class="docutils literal notranslate"><span class="pre">(r_up_carts,</span> <span class="pre">r_dn_carts)</span></code> and fully exploits the JAX library for the
kinetic energy calculation. Inputs are converted to float64 <code class="docutils literal notranslate"><span class="pre">jax.Array</span></code>
for consistency with other compute utilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of up-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of down-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Kinetic energy evaluated for the supplied configuration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float | complex</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.compute_kinetic_energy_all_elements">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">compute_kinetic_energy_all_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.compute_kinetic_energy_all_elements" title="Link to this definition">#</a></dt>
<dd><p>Analytic-derivative kinetic energy per electron (matches auto output shape).</p>
<p>Returns the per-electron kinetic energy using analytic gradients/Laplacians of
both Jastrow and determinant parts. Shapes align with
<code class="docutils literal notranslate"><span class="pre">_compute_kinetic_energy_all_elements_auto</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of up-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of down-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of two <code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> objects containing per-electron kinetic energies
for spin-up and spin-down electrons, respectively.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Array</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.compute_kinetic_energy_all_elements_fast_update">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">compute_kinetic_energy_all_elements_fast_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geminal_inverse</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.compute_kinetic_energy_all_elements_fast_update" title="Link to this definition">#</a></dt>
<dd><p>Kinetic energy per electron using a precomputed geminal inverse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)</p></li>
<li><p><strong>geminal_inverse</strong> (<em>Array</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Array</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.compute_quantum_force">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">compute_quantum_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.compute_quantum_force" title="Link to this definition">#</a></dt>
<dd><p>Compute quantum forces <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">grad</span> <span class="pre">ln</span> <span class="pre">|Psi|</span></code> at the given coordinates.</p>
<p>The method is for computing quantum forces at <code class="docutils literal notranslate"><span class="pre">(r_up_carts,</span> <span class="pre">r_dn_carts)</span></code>.
Gradients from the Jastrow part are currently set to zero (as in the original
implementation); determinant gradients are included via
<code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_ln_Det</span></code>. Inputs are coerced to float64
<code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> for consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of up-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of down-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple <code class="docutils literal notranslate"><span class="pre">(force_up,</span> <span class="pre">force_dn)</span></code> with shapes matching the input coordinate arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple[<em>Array</em>, <em>Array</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.evaluate_determinant">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">evaluate_determinant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.evaluate_determinant" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the determinant (Geminal) part of the wavefunction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of up-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of down-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Determinant value evaluated at the supplied coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.evaluate_jastrow">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">evaluate_jastrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.evaluate_jastrow" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the Jastrow factor <span class="math notranslate nohighlight">\(\exp(J)\)</span> at the given coordinates.</p>
<p>The method is for evaluate the Jastrow part of the wavefunction (Psi) at
<code class="docutils literal notranslate"><span class="pre">(r_up_carts,</span> <span class="pre">r_dn_carts)</span></code>. The returned value already includes the
exponential, i.e., <code class="docutils literal notranslate"><span class="pre">exp(J)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of up-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of down-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Real Jastrow factor <code class="docutils literal notranslate"><span class="pre">exp(J)</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.evaluate_ln_wavefunction">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">evaluate_ln_wavefunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.evaluate_ln_wavefunction" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the logarithm of <code class="docutils literal notranslate"><span class="pre">|wavefunction|</span></code> (<span class="math notranslate nohighlight">\(\ln |\Psi|\)</span>).</p>
<p>This follows the original behavior: compute the Jastrow part, multiply the
determinant part, and then take <code class="docutils literal notranslate"><span class="pre">log(abs(det))</span></code> while keeping the full
Jastrow contribution. The inputs are converted to float64 <code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> for
downstream consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of up-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of down-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar log-value of the wavefunction magnitude.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="jqmc.wavefunction.evaluate_wavefunction">
<span class="sig-prename descclassname"><span class="pre">jqmc.wavefunction.</span></span><span class="sig-name descname"><span class="pre">evaluate_wavefunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wavefunction_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_up_carts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_dn_carts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jqmc.wavefunction.evaluate_wavefunction" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the wavefunction <code class="docutils literal notranslate"><span class="pre">Psi</span></code> at given electron coordinates.</p>
<p>The method is for evaluate wavefunction (Psi) at <code class="docutils literal notranslate"><span class="pre">(r_up_carts,</span> <span class="pre">r_dn_carts)</span></code> and
returns <code class="docutils literal notranslate"><span class="pre">exp(Jastrow)</span> <span class="pre">*</span> <span class="pre">Determinant</span></code>. Inputs are coerced to float64
<code class="docutils literal notranslate"><span class="pre">jax.Array</span></code> to match other compute utilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavefunction_data</strong> (<a class="reference internal" href="#jqmc.wavefunction.Wavefunction_data" title="jqmc.wavefunction.Wavefunction_data"><em>Wavefunction_data</em></a>)  Wavefunction parameters (Jastrow + Geminal).</p></li>
<li><p><strong>r_up_carts</strong> (<em>Array</em>)  Cartesian coordinates of up-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_up,</span> <span class="pre">3)</span></code>.</p></li>
<li><p><strong>r_dn_carts</strong> (<em>Array</em>)  Cartesian coordinates of down-spin electrons with shape <code class="docutils literal notranslate"><span class="pre">(n_dn,</span> <span class="pre">3)</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Complex or real wavefunction value.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float | complex</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-jqmc">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-jqmc" title="Link to this heading">#</a></h2>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="modules.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">API reference for modules</p>
      </div>
    </a>
    <a class="right-next"
       href="../citation.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to cite jQMC</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.atomic_orbital">jqmc.atomic_orbital module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.angular_momentums"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.angular_momentums</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.coefficients"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.coefficients</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.exponents"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.exponents</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.nucleus_index"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.nucleus_index</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.num_ao"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.num_ao</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.num_ao_prim"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.num_ao_prim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.orbital_indices"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.orbital_indices</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_x"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.polynominal_order_x</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_y"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.polynominal_order_y</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.polynominal_order_z"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.polynominal_order_z</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.replace"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_cart_data.structure_data"><code class="docutils literal notranslate"><span class="pre">AOs_cart_data.structure_data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.angular_momentums"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.angular_momentums</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.coefficients"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.coefficients</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.exponents"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.exponents</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.magnetic_quantum_numbers"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.magnetic_quantum_numbers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.nucleus_index"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.nucleus_index</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.num_ao"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.num_ao</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.num_ao_prim"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.num_ao_prim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.orbital_indices"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.orbital_indices</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.replace"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.AOs_sphe_data.structure_data"><code class="docutils literal notranslate"><span class="pre">AOs_sphe_data.structure_data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.compute_AOs"><code class="docutils literal notranslate"><span class="pre">compute_AOs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.compute_AOs_grad"><code class="docutils literal notranslate"><span class="pre">compute_AOs_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.atomic_orbital.compute_AOs_laplacian"><code class="docutils literal notranslate"><span class="pre">compute_AOs_laplacian()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.coulomb_potential">jqmc.coulomb_potential module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.ang_moms"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.ang_moms</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.coefficients"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.coefficients</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.ecp_flag"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.ecp_flag</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.exponents"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.exponents</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.max_ang_mom_plus_1"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.max_ang_mom_plus_1</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.nucleus_index"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.nucleus_index</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.num_ecps"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.num_ecps</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.powers"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.powers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.replace"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.structure_data"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.structure_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.Coulomb_potential_data.z_cores"><code class="docutils literal notranslate"><span class="pre">Coulomb_potential_data.z_cores</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_el"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential_el_el()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_ion"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential_el_ion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_el_ion_element_wise"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential_el_ion_element_wise()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_bare_coulomb_potential_ion_ion"><code class="docutils literal notranslate"><span class="pre">compute_bare_coulomb_potential_ion_ion()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_coulomb_potential"><code class="docutils literal notranslate"><span class="pre">compute_coulomb_potential()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_discretized_bare_coulomb_potential_el_ion_element_wise"><code class="docutils literal notranslate"><span class="pre">compute_discretized_bare_coulomb_potential_el_ion_element_wise()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_coulomb_potential"><code class="docutils literal notranslate"><span class="pre">compute_ecp_coulomb_potential()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_local_parts_all_pairs"><code class="docutils literal notranslate"><span class="pre">compute_ecp_local_parts_all_pairs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_non_local_part_all_pairs_jax_weights_grid_points"><code class="docutils literal notranslate"><span class="pre">compute_ecp_non_local_part_all_pairs_jax_weights_grid_points()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_all_pairs"><code class="docutils literal notranslate"><span class="pre">compute_ecp_non_local_parts_all_pairs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_nearest_neighbors"><code class="docutils literal notranslate"><span class="pre">compute_ecp_non_local_parts_nearest_neighbors()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.coulomb_potential.compute_ecp_non_local_parts_nearest_neighbors_fast_update"><code class="docutils literal notranslate"><span class="pre">compute_ecp_non_local_parts_nearest_neighbors_fast_update()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.determinant">jqmc.determinant module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data"><code class="docutils literal notranslate"><span class="pre">Geminal_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.accumulate_position_grad"><code class="docutils literal notranslate"><span class="pre">Geminal_data.accumulate_position_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.apply_block_update"><code class="docutils literal notranslate"><span class="pre">Geminal_data.apply_block_update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.collect_param_grads"><code class="docutils literal notranslate"><span class="pre">Geminal_data.collect_param_grads()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.compute_orb_api"><code class="docutils literal notranslate"><span class="pre">Geminal_data.compute_orb_api</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.compute_orb_grad_api"><code class="docutils literal notranslate"><span class="pre">Geminal_data.compute_orb_grad_api</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.compute_orb_laplacian_api"><code class="docutils literal notranslate"><span class="pre">Geminal_data.compute_orb_laplacian_api</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.convert_from_MOs_to_AOs"><code class="docutils literal notranslate"><span class="pre">Geminal_data.convert_from_MOs_to_AOs()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.lambda_matrix"><code class="docutils literal notranslate"><span class="pre">Geminal_data.lambda_matrix</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.num_electron_dn"><code class="docutils literal notranslate"><span class="pre">Geminal_data.num_electron_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.num_electron_up"><code class="docutils literal notranslate"><span class="pre">Geminal_data.num_electron_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.orb_data_dn_spin"><code class="docutils literal notranslate"><span class="pre">Geminal_data.orb_data_dn_spin</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.orb_data_up_spin"><code class="docutils literal notranslate"><span class="pre">Geminal_data.orb_data_up_spin</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.orb_num_dn"><code class="docutils literal notranslate"><span class="pre">Geminal_data.orb_num_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.orb_num_up"><code class="docutils literal notranslate"><span class="pre">Geminal_data.orb_num_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.replace"><code class="docutils literal notranslate"><span class="pre">Geminal_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Geminal_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.to_cartesian"><code class="docutils literal notranslate"><span class="pre">Geminal_data.to_cartesian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.Geminal_data.to_spherical"><code class="docutils literal notranslate"><span class="pre">Geminal_data.to_spherical()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_AS_regularization_factor"><code class="docutils literal notranslate"><span class="pre">compute_AS_regularization_factor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_AS_regularization_factor_fast_update"><code class="docutils literal notranslate"><span class="pre">compute_AS_regularization_factor_fast_update()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_det_geminal_all_elements"><code class="docutils literal notranslate"><span class="pre">compute_det_geminal_all_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_geminal_all_elements"><code class="docutils literal notranslate"><span class="pre">compute_geminal_all_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_geminal_dn_one_column_elements"><code class="docutils literal notranslate"><span class="pre">compute_geminal_dn_one_column_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_geminal_up_one_row_elements"><code class="docutils literal notranslate"><span class="pre">compute_geminal_up_one_row_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_grads_and_laplacian_ln_Det"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_ln_Det()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.determinant.compute_grads_and_laplacian_ln_Det_fast"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_ln_Det_fast()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.diff_mask">jqmc.diff_mask module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.DiffMask"><code class="docutils literal notranslate"><span class="pre">DiffMask</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.DiffMask.coords"><code class="docutils literal notranslate"><span class="pre">DiffMask.coords</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.DiffMask.params"><code class="docutils literal notranslate"><span class="pre">DiffMask.params</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.DiffMask.update"><code class="docutils literal notranslate"><span class="pre">DiffMask.update()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.diff_mask.apply_diff_mask"><code class="docutils literal notranslate"><span class="pre">apply_diff_mask()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.function_collections">jqmc.function_collections module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.hamiltonians">jqmc.hamiltonians module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.accumulate_position_grad"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.accumulate_position_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.coulomb_potential_data"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.coulomb_potential_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.load_from_hdf5"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.load_from_hdf5()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.replace"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.save_to_hdf5"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.save_to_hdf5()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.structure_data"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.structure_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.Hamiltonian_data.wavefunction_data"><code class="docutils literal notranslate"><span class="pre">Hamiltonian_data.wavefunction_data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.hamiltonians.compute_local_energy"><code class="docutils literal notranslate"><span class="pre">compute_local_energy()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.header_footer">jqmc.header_footer module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jastrow_factor">jqmc.jastrow_factor module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.cutoff"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.cutoff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.flat_shape"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.flat_shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.flatten_fn"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.flatten_fn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.hidden_dim"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.hidden_dim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.init_from_structure"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.init_from_structure()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.nn_def"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.nn_def</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_layers"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.num_layers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_params"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.num_params</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_rbf"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.num_rbf</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.num_species"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.num_species</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.params"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.params</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.shapes"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.shapes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.species_lookup"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.species_lookup</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.species_values"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.species_values</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.structure_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.structure_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.treedef"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.treedef</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_NN_data.unflatten_fn"><code class="docutils literal notranslate"><span class="pre">Jastrow_NN_data.unflatten_fn</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.accumulate_position_grad"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.accumulate_position_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.apply_block_update"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.apply_block_update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.collect_param_grads"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.collect_param_grads()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_nn_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.jastrow_nn_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_one_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.jastrow_one_body_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_three_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.jastrow_three_body_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.jastrow_two_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.jastrow_two_body_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.to_cartesian"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.to_cartesian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_data.to_spherical"><code class="docutils literal notranslate"><span class="pre">Jastrow_data.to_spherical()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.core_electrons"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.core_electrons</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.init_jastrow_one_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.init_jastrow_one_body_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.jastrow_1b_param"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.jastrow_1b_param</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_one_body_data.structure_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_one_body_data.structure_data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.compute_orb_api"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.compute_orb_api</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.init_jastrow_three_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.init_jastrow_three_body_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.j_matrix"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.j_matrix</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.orb_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.orb_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.orb_num"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.orb_num</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.to_cartesian"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.to_cartesian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_three_body_data.to_spherical"><code class="docutils literal notranslate"><span class="pre">Jastrow_three_body_data.to_spherical()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data.init_jastrow_two_body_data"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data.init_jastrow_two_body_data()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data.jastrow_2b_param"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data.jastrow_2b_param</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data.replace"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.Jastrow_two_body_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Jastrow_two_body_data.sanity_check()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow"><code class="docutils literal notranslate"><span class="pre">NNJastrow</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.hidden_dim"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.hidden_dim</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.name"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.name</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.parent"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.parent</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.scope"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.scope</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PauliNetBlock.setup"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PauliNetBlock.setup()</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.cutoff"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.cutoff</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.name"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.name</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.num_rbf"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.num_rbf</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.parent"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.parent</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.PhysNetRadialLayer.scope"><code class="docutils literal notranslate"><span class="pre">NNJastrow.PhysNetRadialLayer.scope</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.name"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.name</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.out_dim"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.out_dim</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.parent"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.parent</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.scope"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.scope</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.TwoLayerMLP.width"><code class="docutils literal notranslate"><span class="pre">NNJastrow.TwoLayerMLP.width</span></code></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.cutoff"><code class="docutils literal notranslate"><span class="pre">NNJastrow.cutoff</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.hidden_dim"><code class="docutils literal notranslate"><span class="pre">NNJastrow.hidden_dim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.name"><code class="docutils literal notranslate"><span class="pre">NNJastrow.name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.num_layers"><code class="docutils literal notranslate"><span class="pre">NNJastrow.num_layers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.num_rbf"><code class="docutils literal notranslate"><span class="pre">NNJastrow.num_rbf</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.num_species"><code class="docutils literal notranslate"><span class="pre">NNJastrow.num_species</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.parent"><code class="docutils literal notranslate"><span class="pre">NNJastrow.parent</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.scope"><code class="docutils literal notranslate"><span class="pre">NNJastrow.scope</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.setup"><code class="docutils literal notranslate"><span class="pre">NNJastrow.setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.NNJastrow.species_lookup"><code class="docutils literal notranslate"><span class="pre">NNJastrow.species_lookup</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_Jastrow_one_body"><code class="docutils literal notranslate"><span class="pre">compute_Jastrow_one_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_Jastrow_part"><code class="docutils literal notranslate"><span class="pre">compute_Jastrow_part()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_Jastrow_three_body"><code class="docutils literal notranslate"><span class="pre">compute_Jastrow_three_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_Jastrow_two_body"><code class="docutils literal notranslate"><span class="pre">compute_Jastrow_two_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_one_body"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_Jastrow_one_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_part"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_Jastrow_part()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_three_body"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_Jastrow_three_body()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jastrow_factor.compute_grads_and_laplacian_Jastrow_two_body"><code class="docutils literal notranslate"><span class="pre">compute_grads_and_laplacian_Jastrow_two_body()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_cli">jqmc.jqmc_cli module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_gfmc">jqmc.jqmc_gfmc module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n"><code class="docutils literal notranslate"><span class="pre">GFMC_n</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.alat"><code class="docutils literal notranslate"><span class="pre">GFMC_n.alat</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.bare_w_L"><code class="docutils literal notranslate"><span class="pre">GFMC_n.bare_w_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.comput_position_deriv"><code class="docutils literal notranslate"><span class="pre">GFMC_n.comput_position_deriv</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dR"><code class="docutils literal notranslate"><span class="pre">GFMC_n.de_L_dR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dr_dn"><code class="docutils literal notranslate"><span class="pre">GFMC_n.de_L_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.de_L_dr_up"><code class="docutils literal notranslate"><span class="pre">GFMC_n.de_L_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dR"><code class="docutils literal notranslate"><span class="pre">GFMC_n.dln_Psi_dR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dr_dn"><code class="docutils literal notranslate"><span class="pre">GFMC_n.dln_Psi_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.dln_Psi_dr_up"><code class="docutils literal notranslate"><span class="pre">GFMC_n.dln_Psi_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.domega_dr_dn"><code class="docutils literal notranslate"><span class="pre">GFMC_n.domega_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.domega_dr_up"><code class="docutils literal notranslate"><span class="pre">GFMC_n.domega_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.e_L"><code class="docutils literal notranslate"><span class="pre">GFMC_n.e_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.e_L2"><code class="docutils literal notranslate"><span class="pre">GFMC_n.e_L2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.get_E"><code class="docutils literal notranslate"><span class="pre">GFMC_n.get_E()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.get_aF"><code class="docutils literal notranslate"><span class="pre">GFMC_n.get_aF()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.hamiltonian_data"><code class="docutils literal notranslate"><span class="pre">GFMC_n.hamiltonian_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.mcmc_counter"><code class="docutils literal notranslate"><span class="pre">GFMC_n.mcmc_counter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.num_gfmc_collect_steps"><code class="docutils literal notranslate"><span class="pre">GFMC_n.num_gfmc_collect_steps</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.num_walkers"><code class="docutils literal notranslate"><span class="pre">GFMC_n.num_walkers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.omega_dn"><code class="docutils literal notranslate"><span class="pre">GFMC_n.omega_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.omega_up"><code class="docutils literal notranslate"><span class="pre">GFMC_n.omega_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.run"><code class="docutils literal notranslate"><span class="pre">GFMC_n.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_n.w_L"><code class="docutils literal notranslate"><span class="pre">GFMC_n.w_L</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t"><code class="docutils literal notranslate"><span class="pre">GFMC_t</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.alat"><code class="docutils literal notranslate"><span class="pre">GFMC_t.alat</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.bare_w_L"><code class="docutils literal notranslate"><span class="pre">GFMC_t.bare_w_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.e_L"><code class="docutils literal notranslate"><span class="pre">GFMC_t.e_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.e_L2"><code class="docutils literal notranslate"><span class="pre">GFMC_t.e_L2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.get_E"><code class="docutils literal notranslate"><span class="pre">GFMC_t.get_E()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.hamiltonian_data"><code class="docutils literal notranslate"><span class="pre">GFMC_t.hamiltonian_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.mcmc_counter"><code class="docutils literal notranslate"><span class="pre">GFMC_t.mcmc_counter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.num_gfmc_collect_steps"><code class="docutils literal notranslate"><span class="pre">GFMC_t.num_gfmc_collect_steps</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.num_walkers"><code class="docutils literal notranslate"><span class="pre">GFMC_t.num_walkers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.run"><code class="docutils literal notranslate"><span class="pre">GFMC_t.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_gfmc.GFMC_t.w_L"><code class="docutils literal notranslate"><span class="pre">GFMC_t.w_L</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_mcmc">jqmc.jqmc_mcmc module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC"><code class="docutils literal notranslate"><span class="pre">MCMC</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.comput_param_deriv"><code class="docutils literal notranslate"><span class="pre">MCMC.comput_param_deriv</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.comput_position_deriv"><code class="docutils literal notranslate"><span class="pre">MCMC.comput_position_deriv</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.de_L_dR"><code class="docutils literal notranslate"><span class="pre">MCMC.de_L_dR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.de_L_dr_dn"><code class="docutils literal notranslate"><span class="pre">MCMC.de_L_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.de_L_dr_up"><code class="docutils literal notranslate"><span class="pre">MCMC.de_L_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dR"><code class="docutils literal notranslate"><span class="pre">MCMC.dln_Psi_dR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dc"><code class="docutils literal notranslate"><span class="pre">MCMC.dln_Psi_dc</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dr_dn"><code class="docutils literal notranslate"><span class="pre">MCMC.dln_Psi_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.dln_Psi_dr_up"><code class="docutils literal notranslate"><span class="pre">MCMC.dln_Psi_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.domega_dr_dn"><code class="docutils literal notranslate"><span class="pre">MCMC.domega_dr_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.domega_dr_up"><code class="docutils literal notranslate"><span class="pre">MCMC.domega_dr_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.e_L"><code class="docutils literal notranslate"><span class="pre">MCMC.e_L</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.e_L2"><code class="docutils literal notranslate"><span class="pre">MCMC.e_L2</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.get_E"><code class="docutils literal notranslate"><span class="pre">MCMC.get_E()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.get_aF"><code class="docutils literal notranslate"><span class="pre">MCMC.get_aF()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.get_dln_WF"><code class="docutils literal notranslate"><span class="pre">MCMC.get_dln_WF()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.get_gF"><code class="docutils literal notranslate"><span class="pre">MCMC.get_gF()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.hamiltonian_data"><code class="docutils literal notranslate"><span class="pre">MCMC.hamiltonian_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.mcmc_counter"><code class="docutils literal notranslate"><span class="pre">MCMC.mcmc_counter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.num_walkers"><code class="docutils literal notranslate"><span class="pre">MCMC.num_walkers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.omega_dn"><code class="docutils literal notranslate"><span class="pre">MCMC.omega_dn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.omega_up"><code class="docutils literal notranslate"><span class="pre">MCMC.omega_up</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.run"><code class="docutils literal notranslate"><span class="pre">MCMC.run()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.run_optimize"><code class="docutils literal notranslate"><span class="pre">MCMC.run_optimize()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_mcmc.MCMC.w_L"><code class="docutils literal notranslate"><span class="pre">MCMC.w_L</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_miscs">jqmc.jqmc_miscs module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_tool">jqmc.jqmc_tool module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.ansatz_type"><code class="docutils literal notranslate"><span class="pre">ansatz_type</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.ansatz_type.jagp"><code class="docutils literal notranslate"><span class="pre">ansatz_type.jagp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.ansatz_type.jsd"><code class="docutils literal notranslate"><span class="pre">ansatz_type.jsd</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.hamiltonian_convert_wavefunction"><code class="docutils literal notranslate"><span class="pre">hamiltonian_convert_wavefunction()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.hamiltonian_show_info"><code class="docutils literal notranslate"><span class="pre">hamiltonian_show_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.hamiltonian_to_xyz"><code class="docutils literal notranslate"><span class="pre">hamiltonian_to_xyz()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.lrdmc_compute_energy"><code class="docutils literal notranslate"><span class="pre">lrdmc_compute_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.lrdmc_extrapolate_energy"><code class="docutils literal notranslate"><span class="pre">lrdmc_extrapolate_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.lrdmc_generate_input"><code class="docutils literal notranslate"><span class="pre">lrdmc_generate_input()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.mcmc_compute_energy"><code class="docutils literal notranslate"><span class="pre">mcmc_compute_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.mcmc_generate_input"><code class="docutils literal notranslate"><span class="pre">mcmc_generate_input()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type"><code class="docutils literal notranslate"><span class="pre">orbital_type</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao_full"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao_full</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao_large"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao_large</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao_medium"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao_medium</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.ao_small"><code class="docutils literal notranslate"><span class="pre">orbital_type.ao_small</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.mo"><code class="docutils literal notranslate"><span class="pre">orbital_type.mo</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.orbital_type.none"><code class="docutils literal notranslate"><span class="pre">orbital_type.none</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.trexio_convert_to"><code class="docutils literal notranslate"><span class="pre">trexio_convert_to()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.trexio_show_detail"><code class="docutils literal notranslate"><span class="pre">trexio_show_detail()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.trexio_show_info"><code class="docutils literal notranslate"><span class="pre">trexio_show_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.vmc_analyze_output"><code class="docutils literal notranslate"><span class="pre">vmc_analyze_output()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.vmc_chk_fix"><code class="docutils literal notranslate"><span class="pre">vmc_chk_fix()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.jqmc_tool.vmc_generate_input"><code class="docutils literal notranslate"><span class="pre">vmc_generate_input()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.jqmc_utility">jqmc.jqmc_utility module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.molecular_orbital">jqmc.molecular_orbital module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data"><code class="docutils literal notranslate"><span class="pre">MOs_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.aos_data"><code class="docutils literal notranslate"><span class="pre">MOs_data.aos_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.mo_coefficients"><code class="docutils literal notranslate"><span class="pre">MOs_data.mo_coefficients</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.num_mo"><code class="docutils literal notranslate"><span class="pre">MOs_data.num_mo</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.replace"><code class="docutils literal notranslate"><span class="pre">MOs_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">MOs_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.structure_data"><code class="docutils literal notranslate"><span class="pre">MOs_data.structure_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.to_cartesian"><code class="docutils literal notranslate"><span class="pre">MOs_data.to_cartesian()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.MOs_data.to_spherical"><code class="docutils literal notranslate"><span class="pre">MOs_data.to_spherical()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.compute_MOs"><code class="docutils literal notranslate"><span class="pre">compute_MOs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.compute_MOs_grad"><code class="docutils literal notranslate"><span class="pre">compute_MOs_grad()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.molecular_orbital.compute_MOs_laplacian"><code class="docutils literal notranslate"><span class="pre">compute_MOs_laplacian()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.setting">jqmc.setting module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.structure">jqmc.structure module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data"><code class="docutils literal notranslate"><span class="pre">Structure_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.atomic_labels"><code class="docutils literal notranslate"><span class="pre">Structure_data.atomic_labels</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.atomic_numbers"><code class="docutils literal notranslate"><span class="pre">Structure_data.atomic_numbers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.cell"><code class="docutils literal notranslate"><span class="pre">Structure_data.cell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.element_symbols"><code class="docutils literal notranslate"><span class="pre">Structure_data.element_symbols</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.lattice_vec_a"><code class="docutils literal notranslate"><span class="pre">Structure_data.lattice_vec_a</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.lattice_vec_b"><code class="docutils literal notranslate"><span class="pre">Structure_data.lattice_vec_b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.lattice_vec_c"><code class="docutils literal notranslate"><span class="pre">Structure_data.lattice_vec_c</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.natom"><code class="docutils literal notranslate"><span class="pre">Structure_data.natom</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.norm_vec_a"><code class="docutils literal notranslate"><span class="pre">Structure_data.norm_vec_a</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.norm_vec_b"><code class="docutils literal notranslate"><span class="pre">Structure_data.norm_vec_b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.norm_vec_c"><code class="docutils literal notranslate"><span class="pre">Structure_data.norm_vec_c</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.ntyp"><code class="docutils literal notranslate"><span class="pre">Structure_data.ntyp</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.pbc_flag"><code class="docutils literal notranslate"><span class="pre">Structure_data.pbc_flag</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.positions"><code class="docutils literal notranslate"><span class="pre">Structure_data.positions</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.recip_cell"><code class="docutils literal notranslate"><span class="pre">Structure_data.recip_cell</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.recip_vec_a"><code class="docutils literal notranslate"><span class="pre">Structure_data.recip_vec_a</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.recip_vec_b"><code class="docutils literal notranslate"><span class="pre">Structure_data.recip_vec_b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.recip_vec_c"><code class="docutils literal notranslate"><span class="pre">Structure_data.recip_vec_c</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.replace"><code class="docutils literal notranslate"><span class="pre">Structure_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Structure_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.vec_a"><code class="docutils literal notranslate"><span class="pre">Structure_data.vec_a</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.vec_b"><code class="docutils literal notranslate"><span class="pre">Structure_data.vec_b</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.structure.Structure_data.vec_c"><code class="docutils literal notranslate"><span class="pre">Structure_data.vec_c</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.swct">jqmc.swct module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.SWCT_data"><code class="docutils literal notranslate"><span class="pre">SWCT_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.SWCT_data.replace"><code class="docutils literal notranslate"><span class="pre">SWCT_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.SWCT_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">SWCT_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.SWCT_data.structure"><code class="docutils literal notranslate"><span class="pre">SWCT_data.structure</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.evaluate_swct_domega"><code class="docutils literal notranslate"><span class="pre">evaluate_swct_domega()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.swct.evaluate_swct_omega"><code class="docutils literal notranslate"><span class="pre">evaluate_swct_omega()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.trexio_wrapper">jqmc.trexio_wrapper module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.trexio_wrapper.read_trexio_file"><code class="docutils literal notranslate"><span class="pre">read_trexio_file()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc.wavefunction">jqmc.wavefunction module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.apply_update"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.apply_update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.name"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.name</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.replace"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.shape"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.shape</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.size"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.VariationalParameterBlock.values"><code class="docutils literal notranslate"><span class="pre">VariationalParameterBlock.values</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.accumulate_position_grad"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.accumulate_position_grad()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.apply_block_updates"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.apply_block_updates()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.collect_param_grads"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.collect_param_grads()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.flatten_param_grads"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.flatten_param_grads()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.geminal_data"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.geminal_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.get_variational_blocks"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.get_variational_blocks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.jastrow_data"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.jastrow_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.replace"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.replace()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.sanity_check"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.sanity_check()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.with_diff_mask"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.with_diff_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.Wavefunction_data.with_param_grad_mask"><code class="docutils literal notranslate"><span class="pre">Wavefunction_data.with_param_grad_mask()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_discretized_kinetic_energy"><code class="docutils literal notranslate"><span class="pre">compute_discretized_kinetic_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_discretized_kinetic_energy_fast_update"><code class="docutils literal notranslate"><span class="pre">compute_discretized_kinetic_energy_fast_update()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_kinetic_energy"><code class="docutils literal notranslate"><span class="pre">compute_kinetic_energy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_kinetic_energy_all_elements"><code class="docutils literal notranslate"><span class="pre">compute_kinetic_energy_all_elements()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_kinetic_energy_all_elements_fast_update"><code class="docutils literal notranslate"><span class="pre">compute_kinetic_energy_all_elements_fast_update()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.compute_quantum_force"><code class="docutils literal notranslate"><span class="pre">compute_quantum_force()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.evaluate_determinant"><code class="docutils literal notranslate"><span class="pre">evaluate_determinant()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.evaluate_jastrow"><code class="docutils literal notranslate"><span class="pre">evaluate_jastrow()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.evaluate_ln_wavefunction"><code class="docutils literal notranslate"><span class="pre">evaluate_ln_wavefunction()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#jqmc.wavefunction.evaluate_wavefunction"><code class="docutils literal notranslate"><span class="pre">evaluate_wavefunction()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-jqmc">Module contents</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kosuke Nakano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2026, Kosuke Nakano.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>